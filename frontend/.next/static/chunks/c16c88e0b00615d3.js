(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,204360,e=>{"use strict";e.s(["audioManager",()=>s,"playCorrectSound",()=>i,"playFlipSound",()=>r,"playIncorrectSound",()=>n]);var t=e.i(299749);class a{static getInstance(){return a.instance||(a.instance=new a),a.instance}updateSettings(e){this.settings=e}getSoundEffectsVolume(){return this.settings?this.settings.muteSounds?0:this.settings.soundVolume/100:0}getPronunciationVolume(){return this.settings?this.settings.soundVolume/100:.75}async loadAudio(e){var t,a;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.audioCache.has(e))return this.audioCache.get(e);let i=new Audio(e);i.volume=null!=(t=s.volume)?t:.75,i.loop=null!=(a=s.loop)&&a,i.preload=s.preload?"auto":"metadata";try{return await new Promise((e,t)=>{i.oncanplaythrough=e,i.onerror=t,i.load()}),this.audioCache.set(e,i),i}catch(t){throw console.error("Failed to load audio: ".concat(e),t),t}}async playSoundEffect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getSoundEffectsVolume();if(0!==a)try{var s;let i=await this.loadAudio(e,t);i.volume=null!=(s=t.volume)?s:a,i.currentTime=0,await i.play()}catch(t){console.error("Failed to play sound effect: ".concat(e),t)}}async playPronunciation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getPronunciationVolume();try{var s;let i=await this.loadAudio(e,t);i.volume=null!=(s=t.volume)?s:a,i.currentTime=0,await i.play()}catch(t){console.error("Failed to play pronunciation: ".concat(e),t)}}stopAllSounds(){this.audioCache.forEach(e=>{e.pause(),e.currentTime=0})}updateVolume(){this.audioCache.forEach((e,t)=>{t.includes("/tts/")||t.includes("/pronunciation/")?e.volume=this.getPronunciationVolume():e.volume=this.getSoundEffectsVolume()})}clearCache(){this.stopAllSounds(),this.audioCache.clear()}constructor(){(0,t._)(this,"audioCache",new Map),(0,t._)(this,"settings",null)}}(0,t._)(a,"instance",void 0);let s=a.getInstance(),i=()=>s.playSoundEffect("/sounds/correct.mp3"),n=()=>s.playSoundEffect("/sounds/incorrect.wav"),r=()=>s.playSoundEffect("/sounds/flip.mp3")},220849,e=>{"use strict";e.s(["useDisplaySettings",()=>R],220849);var t,a,s,i,n,r,o=e.i(266027),l=e.i(271645),c=e.i(739946),d=e.i(470292),u=e.i(62351),h=e.i(337696),m=e.i(788245),g=e.i(114272),p=e.i(540143),y=e.i(915823),f=e.i(619273),v=(t=new WeakMap,a=new WeakMap,s=new WeakMap,i=new WeakMap,n=new WeakSet,r=new WeakSet,class extends y.Subscribable{bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var a;let i=this.options;this.options=(0,c._)(this,t).defaultMutationOptions(e),(0,f.shallowEqualObjects)(this.options,i)||(0,c._)(this,t).getMutationCache().notify({type:"observerOptionsUpdated",mutation:(0,c._)(this,s),observer:this}),(null==i?void 0:i.mutationKey)&&this.options.mutationKey&&(0,f.hashKey)(i.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():(null==(a=(0,c._)(this,s))?void 0:a.state.status)==="pending"&&(0,c._)(this,s).setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var e;null==(e=(0,c._)(this,s))||e.removeObserver(this)}}onMutationUpdate(e){(0,h._)(this,n,x).call(this),(0,h._)(this,r,w).call(this,e)}getCurrentResult(){return(0,c._)(this,a)}reset(){var e;null==(e=(0,c._)(this,s))||e.removeObserver(this),(0,u._)(this,s,void 0),(0,h._)(this,n,x).call(this),(0,h._)(this,r,w).call(this)}mutate(e,a){var n;return(0,u._)(this,i,a),null==(n=(0,c._)(this,s))||n.removeObserver(this),(0,u._)(this,s,(0,c._)(this,t).getMutationCache().build((0,c._)(this,t),this.options)),(0,c._)(this,s).addObserver(this),(0,c._)(this,s).execute(e)}constructor(e,o){super(),(0,m._)(this,n),(0,m._)(this,r),(0,d._)(this,t,{writable:!0,value:void 0}),(0,d._)(this,a,{writable:!0,value:void 0}),(0,d._)(this,s,{writable:!0,value:void 0}),(0,d._)(this,i,{writable:!0,value:void 0}),(0,u._)(this,t,e),this.setOptions(o),this.bindMethods(),(0,h._)(this,n,x).call(this)}});function x(){var e,t;let i=null!=(t=null==(e=(0,c._)(this,s))?void 0:e.state)?t:(0,g.getDefaultState)();(0,u._)(this,a,{...i,isPending:"pending"===i.status,isSuccess:"success"===i.status,isError:"error"===i.status,isIdle:"idle"===i.status,mutate:this.mutate,reset:this.reset})}function w(e){p.notifyManager.batch(()=>{if((0,c._)(this,i)&&this.hasListeners()){var s,n,r,o,l,d,u,h;let m=(0,c._)(this,a).variables,g=(0,c._)(this,a).context,p={client:(0,c._)(this,t),meta:this.options.meta,mutationKey:this.options.mutationKey};(null==e?void 0:e.type)==="success"?(null==(s=(n=(0,c._)(this,i)).onSuccess)||s.call(n,e.data,m,g,p),null==(r=(o=(0,c._)(this,i)).onSettled)||r.call(o,e.data,null,m,g,p)):(null==e?void 0:e.type)==="error"&&(null==(l=(d=(0,c._)(this,i)).onError)||l.call(d,e.error,m,g,p),null==(u=(h=(0,c._)(this,i)).onSettled)||u.call(h,void 0,e.error,m,g,p))}this.listeners.forEach(e=>{e((0,c._)(this,a))})})}var b=e.i(912598),S=e.i(846696),_=e.i(859016);let j={display:{flashcardAnimationSpeed:"normal",muteSounds:!1,soundVolume:75,reviewTimeSeconds:4,language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",keyboardNavigation:!0,focusIndicators:!0},notifications:{email:{dailyReminders:!1,weeklyProgress:!1,achievements:!1,questUpdates:!1,marketingEmails:!1},push:{studyReminders:!1,streakReminders:!1,achievements:!1,questUpdates:!1,flashcardReviews:!1},inApp:{sounds:!0,popups:!0,achievements:!0,levelUps:!0},studyReminders:{enabled:!1,dailyGoal:!1,weeklyGoal:!1,streakMaintenance:!1}},privacy:{dataCollection:!0,analyticsTracking:!0,crashReporting:!0,marketingCommunications:!1,sessionTimeout:"30",passwordChangeNotifications:!0}};function N(e){try{return{display:e.display||j.display,notifications:e.notifications||j.notifications,privacy:e.privacy||j.privacy}}catch(e){return j}}let C={all:["user-settings"],detail:e=>[...C.all,"detail",e],category:(e,t)=>[...C.all,t,e]},M=async()=>{let{data:{user:e},error:t}=await _.supabase.auth.getUser();if(t||!e)throw Error("User not authenticated");return e.id},T=async()=>{let e=await M(),{data:t,error:a}=await _.supabase.from("user_settings").select("settings").eq("user_id",e).single();if(a){if("PGRST116"===a.code)return j;throw Error("Failed to fetch user settings: ".concat(a.message))}let s=function(e){try{let t="string"==typeof e?JSON.parse(e):e,a=N(t);return{success:!0,data:a}}catch(e){return{success:!1,error:e instanceof Error?e:Error("Failed to parse settings")}}}(t.settings);return s.success?s.data:(console.warn("Invalid settings from database, using defaults:",s.error),j)},k=async e=>{let t=await M(),a=N(e),{error:s}=await _.supabase.from("user_settings").upsert({user_id:t,settings:a,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(s)throw Error("Failed to save user settings: ".concat(s.message))},P=(e,t)=>JSON.stringify(e)===JSON.stringify(t),F={slow:750,normal:500,fast:250},E={min:2,max:8,default:4},A={min:0,max:100,default:75,step:5},R=()=>{let{settings:e,savedSettings:t,updateDisplaySetting:a,updateDisplaySettings:s,saveSettings:i,discardChanges:n,resetToDefaults:r,hasUnsavedChanges:c,isSaving:d}=(()=>{let{settings:e,savedSettings:t,updateDraftCategory:a,updateDraftSetting:s,saveSettings:i,discardChanges:n,resetToDefaults:r,hasUnsavedChanges:c,isSaving:d}=(()=>{var e;let t=(0,b.useQueryClient)(),[a,s]=(0,l.useState)(null),i=(0,o.useQuery)({queryKey:C.all,queryFn:T,staleTime:3e5,gcTime:6e5,retry:(e,t)=>!t.message.includes("not authenticated")&&e<3}),n=null!=(e=i.data)?e:j,r=null!=a?a:n,c=null!==a&&!P(a,n);(0,l.useEffect)(()=>{i.data&&a&&P(a,i.data)&&s(null)},[i.data,a]);let d=function(e,t){let a=(0,b.useQueryClient)(void 0),[s]=l.useState(()=>new v(a,e));l.useEffect(()=>{s.setOptions(e)},[s,e]);let i=l.useSyncExternalStore(l.useCallback(e=>s.subscribe(p.notifyManager.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),n=l.useCallback((e,t)=>{s.mutate(e,t).catch(f.noop)},[s]);if(i.error&&(0,f.shouldThrowError)(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:n,mutateAsync:i.mutate}}({mutationFn:k,onMutate:async e=>{await t.cancelQueries({queryKey:C.all});let a=t.getQueryData(C.all);return t.setQueryData(C.all,e),{previousSettings:a}},onError:(e,a,s)=>{(null==s?void 0:s.previousSettings)&&t.setQueryData(C.all,s.previousSettings),S.toast.error("Failed to save settings"),console.error("Settings save error:",e)},onSuccess:()=>{s(null),S.toast.success("Settings saved successfully")},onSettled:()=>{t.invalidateQueries({queryKey:C.all})}}),u=(0,l.useCallback)((e,t,i)=>{let r=null!=a?a:n;s({...r,[e]:{...r[e],[t]:i}})},[a,n]),h=(0,l.useCallback)((e,t)=>{s({...null!=a?a:n,[e]:t})},[a,n]),m=(0,l.useCallback)(e=>{let t=null!=e?e:r;return new Promise((e,a)=>{d.mutate(t,{onSuccess:()=>{e()},onError:e=>{a(e)}})})},[r,d]),g=(0,l.useCallback)(()=>{s(null)},[]),y=(0,l.useCallback)(()=>{s(j)},[]);return{settings:r,savedSettings:n,isLoading:i.isLoading,isError:i.isError,error:i.error,hasUnsavedChanges:c,draftSettings:a,saveSettings:m,updateDraftSetting:u,updateDraftCategory:h,discardChanges:g,resetToDefaults:y,isSaving:d.isPending}})();return{settings:e.display,savedSettings:t.display,updateDisplaySettings:e=>a("display",e),updateDisplaySetting:(e,t)=>s("display",e,t),saveSettings:()=>i(),discardChanges:n,resetToDefaults:r,hasUnsavedChanges:c,isSaving:d}})(),u=(e,t)=>{a(e,t)},h=()=>{let{min:t,max:a}=A;return Math.max(t,Math.min(a,e.soundVolume))};return{settings:e,savedSettings:t,updateSetting:u,updateMultipleSettings:t=>{s({...e,...t})},resetSettings:()=>{r()},saveSettings:()=>{i()},discardSettings:()=>{n()},hasUnsavedChanges:c,isLoaded:!0,isSaving:d,getAnimationDuration:()=>F[e.flashcardAnimationSpeed],getReviewTimeSeconds:()=>{let{min:t,max:a}=E;return Math.max(t,Math.min(a,e.reviewTimeSeconds))},updateReviewTime:e=>{let{min:t,max:a}=E;u("reviewTimeSeconds",Math.max(t,Math.min(a,e)))},getSoundVolume:h,updateSoundVolume:e=>{let{min:t,max:a}=A;u("soundVolume",Math.max(t,Math.min(a,e)))},areSoundEffectsDisabled:()=>e.muteSounds||0===e.soundVolume,getEffectiveVolume:()=>e.muteSounds?0:h(),getPronunciationVolume:()=>h(),toggleMute:()=>{u("muteSounds",!e.muteSounds)}}}},896296,726714,435019,e=>{"use strict";e.s(["FlashcardFront",()=>u],896296);var t=e.i(843476),a=e.i(271645),s=e.i(382373),i=e.i(571930);e.s(["BookmarkCheck",()=>n],726714);let n=(0,e.i(475254).default)("bookmark-check",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);var r=e.i(497058),o=e.i(859951),l=e.i(166778),c=e.i(589121),d=e.i(204360);function u(e){var u;let{data:h,saved:m,onSave:g}=e,[p,y]=(0,a.useState)(!1),[f,v]=(0,a.useState)(!1),x=async()=>{if(!f){v(!0);try{h.audio_url&&"APP"===h.flashcard_type?(console.log("Playing APP flashcard audio:",h.audio_url),await d.audioManager.playPronunciation(h.audio_url)):"CUSTOM"===h.flashcard_type?(console.log("Playing CUSTOM flashcard audio for:",h.vietnamese),await playCustomFlashcardAudio(h.id,h.vietnamese)):h.audio_url?(console.log("Playing fallback audio:",h.audio_url),await d.audioManager.playPronunciation(h.audio_url)):console.log("No audio available for:",h.vietnamese)}catch(e){console.error("Failed to play audio:",e)}finally{v(!1)}}};return Array.isArray(h.english)?h.english[0]:h.english,(0,t.jsxs)("div",{className:"w-full max-w-2xl mx-auto bg-white rounded-3xl p-8 shadow-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),console.log("Save button clicked for card:",h.id);try{g(h.id)}catch(e){console.error("Error saving flashcard:",e)}},className:"p-2 hover:bg-gray-100",children:m?(0,t.jsx)(n,{className:"h-5 w-5 text-blue-600"}):(0,t.jsx)(i.Bookmark,{className:"h-5 w-5 text-gray-500"})})}),(0,t.jsxs)("div",{className:"flex gap-8 h-full",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:h.image_url?(0,t.jsx)("img",{src:h.image_url,alt:h.vietnamese,className:"w-48 h-48 object-cover rounded-xl border-2 border-gray-200",loading:"lazy",onError:e=>{e.target.src="/placeholder.svg"}}):(0,t.jsx)("div",{className:"w-48 h-48 bg-gray-100 rounded-xl border-2 border-gray-200 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center text-gray-400",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ“š"}),(0,t.jsx)("div",{className:"text-sm",children:"No image"})]})})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col justify-center space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-gray-800",children:h.vietnamese}),h.pronunciation&&(0,t.jsxs)("p",{className:"text-lg text-gray-500 mt-1 font-mono",children:["/",h.pronunciation,"/"]})]}),(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),x()},className:"p-3 hover:bg-gray-100 rounded-full ".concat(f?"animate-pulse bg-blue-100":""),disabled:f,title:f?"Playing audio...":"Play pronunciation",children:(0,t.jsx)(s.Volume2,{className:"h-6 w-6 ".concat(f?"text-blue-700":"text-blue-600")})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Badge,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:Array.isArray(u=h.type)?u.join(", "):u}),h.is_multimeaning&&(0,t.jsx)(l.Badge,{variant:"outline",className:"text-purple-600 border-purple-300",children:"Multi-meaning"})]}),h.vietnamese_sentence?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Example sentence:"}),(0,t.jsxs)("p",{className:"text-md md:text-lg text-gray-700 italic",children:[(0,t.jsx)("span",{className:"text-gray-400",children:'"'}),((e,a)=>{let s;if(!e||!a)return e;let i=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");try{s=RegExp("(?<!\\p{L})(".concat(i,")(?!\\p{L})"),"giu")}catch(e){s=RegExp("(".concat(i,")"),"gi")}let n=[],r=0;for(let a of e.matchAll(s)){var o;let s=null!=(o=a.index)?o:0,i=s+a[0].length;s>r&&n.push(e.slice(r,s)),n.push((0,t.jsx)("mark",{className:"rounded-md px-1 bg-amber-200/70 text-gray-900 ring-1 ring-amber-300 underline decoration-amber-500/50 decoration-2 underline-offset-2",children:a[0]},"hl-".concat(s))),r=i}return 0===r?e:(r<e.length&&n.push(e.slice(r)),n)})(h.vietnamese_sentence,h.vietnamese),(0,t.jsx)("span",{className:"text-gray-400",children:'"'})]}),h.english_sentence&&(0,t.jsx)("div",{className:"flex items-center gap-1 mt-1",children:(0,t.jsx)(c.TooltipProvider,{children:(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(o.Button,{variant:"ghost",size:"icon",className:"p-1 h-auto text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-full","aria-label":"Xem dá»‹ch cÃ¢u vÃ­ dá»¥",children:(0,t.jsx)(r.TbMessageLanguage,{className:"h-4 w-4"})})}),(0,t.jsx)(c.TooltipContent,{side:"bottom",align:"start",children:(0,t.jsxs)("p",{className:"text-sm text-gray-700 italic",children:['"',h.english_sentence,'"']})})]})})})]}):(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Example sentence:"}),(0,t.jsx)("p",{className:"text-md md:text-lg text-gray-400 italic",children:"No example sentence available"})]})]})]})]})}e.s(["FlashcardBack",()=>m],435019);var h=e.i(69578);function m(e){let{data:a,saved:s,onSave:r}=e,l=a.english?a.english.filter(e=>e!==a.common_meaning):[];return(0,t.jsxs)("div",{className:"w-full h-full bg-white rounded-3xl p-6 shadow-lg border border-gray-200 flex flex-col",children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),console.log("Save button clicked for card:",a.id);try{r(a.id)}catch(e){console.error("Error saving flashcard:",e)}},className:"p-2 hover:bg-gray-100",children:s?(0,t.jsx)(n,{className:"h-5 w-5 text-green-600"}):(0,t.jsx)(i.Bookmark,{className:"h-5 w-5 text-gray-500"})})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col space-y-6 min-h-0",children:[(0,t.jsxs)("div",{className:"flex-shrink-0",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Primary Meaning"}),(0,t.jsx)("p",{className:"text-2xl font-medium text-green-700 bg-green-50 rounded-lg p-4 border border-green-200",children:a.common_meaning||(a.english&&a.english.length>0?a.english[0]:"No translation available")}),"CUSTOM"===a.flashcard_type&&a.ipa_pronunciation&&(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600 italic",children:["IPA: ",(0,t.jsx)("span",{className:"font-mono text-blue-600",children:a.ipa_pronunciation})]})})]}),l&&l.length>0&&(0,t.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,t.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 mb-3 flex-shrink-0",children:["Other Meanings (",l.length,")"]}),(0,t.jsx)(h.ScrollArea,{className:"flex-1 max-h-48 rounded-lg border border-gray-200 bg-gray-50 p-3",children:(0,t.jsx)("div",{className:"space-y-3",children:l.map((e,a)=>(0,t.jsxs)("p",{className:"text-base text-gray-700 bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:["â€¢ ",e]},a))})})]})]})]})}},399220,e=>{"use strict";e.s(["FlashcardComponent",()=>h]);var t=e.i(843476),a=e.i(271645),s=e.i(846932),i=e.i(887652),n=e.i(895420),r=e.i(88653),o=e.i(896296),l=e.i(435019),c=e.i(220849),d=e.i(204360);function u(e){let{data:r,saved:c,onSave:u,onFlip:h,isFlipped:m,frontCard:g,index:p,setIndex:y,drag:f,animationDuration:v=500}=e,[x,w]=(0,a.useState)(0),b=(0,i.useMotionValue)(0),S=(0,n.useTransform)(b,[-150,0,150],[.5,1,.5]),_=(0,n.useTransform)(b,[-150,0,150],[-45,0,45],{clamp:!1}),j=v/1e3;return(0,t.jsx)(s.motion.div,{style:{width:"100%",height:400,position:"absolute",top:0,x:b,rotate:_,cursor:"grab",pointerEvents:"auto"},whileTap:{cursor:"grabbing"},drag:f,dragConstraints:{top:0,right:0,bottom:0,left:0},onDragEnd:(e,t)=>{t.offset.x<-100&&(w(-250),y&&"number"==typeof p&&y(p+1)),t.offset.x>100&&(w(250),y&&"number"==typeof p&&y(p-1))},variants:g?{animate:{scale:1,y:0,opacity:1},exit:e=>({x:e,opacity:0,scale:.5,transition:{duration:.2}})}:{initial:{scale:0,y:105,opacity:0},animate:{scale:.75,y:30,opacity:.5}},initial:"initial",animate:"animate",exit:"exit",custom:x,transition:g?{type:"spring",stiffness:300,damping:20}:{scale:{duration:.2},opacity:{duration:.4}},onClick:e=>{!e.target.closest("button")&&5>Math.abs(b.get())&&h&&(e.preventDefault(),(0,d.playFlipSound)(),h())},children:(0,t.jsx)(s.motion.div,{style:{width:"100%",height:"100%",scale:S,perspective:"1000px"},children:(0,t.jsxs)("div",{className:"relative w-full h-full transform-style-preserve-3d ".concat(m?"rotate-y-180":""),style:{transformStyle:"preserve-3d",transform:m?"rotateY(180deg)":"rotateY(0deg)",transition:"transform ".concat(j,"s ease-in-out")},children:[(0,t.jsx)("div",{className:"w-full h-full backface-hidden ".concat(m?"opacity-0 pointer-events-none":"opacity-100"),style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transition:"opacity ".concat(j,"s ease-in-out")},children:(0,t.jsx)(o.FlashcardFront,{data:r,saved:c,onSave:u})}),(0,t.jsx)("div",{className:"absolute inset-0 w-full h-full backface-hidden ".concat(m?"opacity-100":"opacity-0 pointer-events-none"),style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transform:"rotateY(180deg)",transition:"opacity ".concat(j,"s ease-in-out")},children:(0,t.jsx)(l.FlashcardBack,{data:r,saved:c,onSave:u})})]})})})}function h(e){let{data:i,saved:n,onSave:o,onSwipe:l,onFlip:h,isFlipped:m=!1,animationDuration:g=500}=e,[p,y]=(0,a.useState)(0),{settings:f}=(0,c.useDisplaySettings)();return(0,a.useEffect)(()=>{f&&d.audioManager.updateSettings(f)},[f]),(0,t.jsx)("div",{className:"w-full max-w-2xl mx-auto mb-8",children:(0,t.jsx)(s.motion.div,{style:{width:"100%",height:400,position:"relative",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",pointerEvents:"auto"},children:(0,t.jsxs)(r.AnimatePresence,{initial:!1,children:[(0,t.jsx)(u,{data:i,saved:n,onSave:o,onFlip:h,isFlipped:m,frontCard:!1,animationDuration:g},p+1),(0,t.jsx)(u,{data:i,saved:n,onSave:o,onFlip:h,isFlipped:m,frontCard:!0,index:p,setIndex:e=>{e>p&&l?l("left"):e<p&&l&&l("right"),y(e)},drag:"x",animationDuration:g},p)]})})})}},788510,115518,e=>{"use strict";e.s(["default",()=>n],788510);var t=e.i(843476),a=e.i(271645),s=e.i(657688);let i=()=>{let[e,i]=(0,a.useState)(""),[n,r]=(0,a.useState)(""),o=["/images/loading/banh-mi.webp","/images/loading/cafe.webp","/images/loading/lotus.webp","/images/loading/non-la.webp","/images/loading/pho.webp"],l=["Connecting you to Vietnam...","Bringing you the best of Vietnamese...","Loading your learning experience..."];return((0,a.useEffect)(()=>{let e=Math.floor(Math.random()*o.length);i(o[e]);let t=Math.floor(Math.random()*l.length);r(l[t])},[]),e)?(0,t.jsx)("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(s.default,{src:e,alt:"Loading",width:120,height:120,className:"animate-sway drop-shadow-lg",priority:!0})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:n}),(0,t.jsxs)("div",{className:"flex space-x-1 justify-center",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce"}),(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})]})}):null},n=e=>{let{children:a,isLoading:s}=e;return(0,t.jsxs)(t.Fragment,{children:[s&&(0,t.jsx)(i,{}),a]})};e.s(["useLoading",()=>r],115518);let r=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],[t,s]=(0,a.useState)(e),i=(0,a.useRef)(null),n=(0,a.useCallback)(()=>{s(!0),i.current=setTimeout(()=>{console.warn("Loading timeout reached, forcing stop"),s(!1)},1e4)},[]),r=(0,a.useCallback)(()=>{s(!1),i.current&&(clearTimeout(i.current),i.current=null)},[]),o=(0,a.useCallback)(async e=>{try{return n(),await e()}finally{r()}},[n,r]),l=(0,a.useCallback)(async function(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;for(let s=0;s<=a;s++)try{return 0===s&&n(),await e()}catch(e){if(t=e,console.warn("Attempt ".concat(s+1," failed:"),e),s===a)throw t;await new Promise(e=>setTimeout(e,1e3*Math.pow(2,s)))}finally{s===a&&r()}throw t},[n,r]);return{isLoading:t,startLoading:n,stopLoading:r,withLoading:o,withLoadingAndRetry:l}}},532671,e=>{"use strict";e.s(["flashcardAPI",()=>r,"getAllFlashcards",()=>o,"getAllTopics",()=>l,"getAllWordTypes",()=>c,"getFlashcardsByCategoryWithPagination",()=>h,"getFlashcardsByTopic",()=>d,"getFlashcardsByTopicWithPagination",()=>u],532671),e.i(247167);var t=e.i(299749);class a extends Error{constructor(e,a){super(a),(0,t._)(this,"status",void 0),this.status=e,this.name="APIError"}}async function s(e,t){let s="".concat("https://vietnamesenext.onrender.com").concat("/api/v1").concat(e);try{let e=await fetch(s,{headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},cache:"no-store",...t});if(!e.ok)throw new a(e.status,"API request failed: ".concat(e.statusText));return await e.json()}catch(e){if(e instanceof a)throw e;throw new a(0,"Network error: ".concat(e instanceof Error?e.message:"Unknown error"))}}function i(e){return{id:e.id,vietnamese:e.vietnamese,english:e.english,type:e.type,is_multiword:e.is_multiword,is_multimeaning:e.is_multimeaning,common_meaning:e.common_meaning,vietnamese_sentence:e.vietnamese_sentence,english_sentence:e.english_sentence,topic:e.topic,is_common:"common"===e.common_class,image_url:e.image_url,audio_url:e.audio_url,pronunciation:e.pronunciation,saved_id:e.saved_id,saved_at:e.saved_at,flashcard_type:e.flashcard_type,tags:e.tags,review_count:e.review_count,last_reviewed:e.last_reviewed,notes:e.notes,is_favorite:e.is_favorite,ipa_pronunciation:e.ipa_pronunciation}}function n(e){return{id:e.id,title:e.title,description:e.description,count:e.count,imageUrl:e.imageUrl||"/placeholder.svg?height=200&width=400"}}let r={async getAllFlashcards(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(await s("/flashcards?skip=".concat(e,"&limit=").concat(t))).map(i)},async getRandomFlashcards(){let{count:e=20,commonWordsOnly:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new URLSearchParams({count:String(e),common_words_only:String(t)});return(await s("/flashcards/random?".concat(a.toString()))).map(i)},async searchFlashcards(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return(await s("/flashcards/search?q=".concat(encodeURIComponent(e),"&limit=").concat(t))).map(i)},async getAllTopics(e){let t=e?"/flashcards/topics?complexity=".concat(encodeURIComponent(e)):"/flashcards/topics";return(await s(t)).map(n)},async getFlashcardsByTopic(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,r=(await this.getAllTopics()).find(t=>t.id===e);if(!r)return console.warn("Topic not found for ID: ".concat(e)),{flashcards:[],total:0,hasMore:!1};let o=new URLSearchParams({skip:a.toString(),limit:n.toString()});t&&o.append("complexity",t);let l="/flashcards/by-topic/".concat(encodeURIComponent(r.title),"?").concat(o.toString()),c=await s(l);return{flashcards:c.flashcards.map(i),total:c.total,hasMore:c.has_more}},async getFlashcardsByTopicLegacy(e,t){return(await this.getFlashcardsByTopic(e,t,0,1e3)).flashcards},async getFlashcardsByType(e,t){let a=t?"/flashcards/by-type/".concat(encodeURIComponent(e),"?complexity=").concat(encodeURIComponent(t)):"/flashcards/by-type/".concat(encodeURIComponent(e));return(await s(a)).map(i)},async getMultiwordFlashcards(e){let t=e?"/flashcards/multiword?complexity=".concat(encodeURIComponent(e)):"/flashcards/multiword";return(await s(t)).map(i)},async getMultimeaningFlashcards(e){let t=e?"/flashcards/multimeaning?complexity=".concat(encodeURIComponent(e)):"/flashcards/multimeaning";return(await s(t)).map(i)},async getFlashcardsByComplexity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(await s("/flashcards/by-complexity/".concat(encodeURIComponent(e),"?skip=").concat(t,"&limit=").concat(a))).map(i)},getComplexityCounts:async()=>await s("/flashcards/complexity-counts"),getFlashcardById:async e=>i(await s("/flashcards/".concat(e))),getFlashcardAudio:async e=>await s("/flashcards/".concat(e,"/audio")),healthCheck:async()=>await s("/flashcards/health"),async getAllWordTypes(e){let t=e?"/flashcards/word-types?complexity=".concat(encodeURIComponent(e)):"/flashcards/word-types";return await s(t)},async getOthersCounts(e){let t=e?"/flashcards/others-counts?complexity=".concat(encodeURIComponent(e)):"/flashcards/others-counts";return await s(t)},async getFlashcardsByTypeWithPagination(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,r=new URLSearchParams({skip:a.toString(),limit:n.toString()});t&&r.append("complexity",t);let o=await s("/flashcards/by-type/".concat(encodeURIComponent(e),"?").concat(r));return{flashcards:o.flashcards.map(i),total:o.total,hasMore:o.has_more}},async getMultiwordFlashcardsWithPagination(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,n=new URLSearchParams({skip:t.toString(),limit:a.toString()});e&&n.append("complexity",e);let r=await s("/flashcards/multiword?".concat(n));return{flashcards:r.flashcards.map(i),total:r.total,hasMore:r.has_more}},async getMultimeaningFlashcardsWithPagination(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,n=new URLSearchParams({skip:t.toString(),limit:a.toString()});e&&n.append("complexity",e);let r=await s("/flashcards/multimeaning?".concat(n));return{flashcards:r.flashcards.map(i),total:r.total,hasMore:r.has_more}},async getSavedFlashcards(e){let t=await s("/flashcards/saved/".concat(e));return{flashcards:t.flashcards.map(i),total:t.total}},getSavedFlashcardsCount:async e=>await s("/flashcards/saved/".concat(e,"/count")),getFlashcardsByIds:async e=>(await s("/flashcards/by-ids",{method:"POST",body:JSON.stringify(e)})).map(i)};async function o(){return r.getAllFlashcards()}async function l(){return r.getAllTopics()}async function c(){return r.getAllWordTypes()}async function d(e,t){let a=["multi-meaning","multi-word"];try{let s=await r.getAllWordTypes();if(s.map(e=>e.id).includes(e.toLowerCase())){let a=s.find(t=>t.id===e.toLowerCase());if(a)return{flashcards:await r.getFlashcardsByType(a.name,t),title:a.title}}if(a.includes(e.toLowerCase())){let a,s;return"multi-meaning"===e.toLowerCase()?(a=await r.getMultimeaningFlashcards(t),s="Multi-meaning Words"):"multi-word"===e.toLowerCase()?(a=await r.getMultiwordFlashcards(t),s="Multi-word Expressions"):(a=[],s=e),{flashcards:a,title:s}}}catch(a){if(console.error("Error loading word types:",a),["verb","noun","adj","adv","prep","conj","intj","pron","num","det","part"].includes(e.toLowerCase())){let a=e.toUpperCase();return{flashcards:await r.getFlashcardsByType(a,t),title:({VERB:"Verbs",NOUN:"Nouns",ADJ:"Adjectives",ADV:"Adverbs",PREP:"Prepositions",CONJ:"Conjunctions",INTJ:"Interjections",PRON:"Pronouns",NUM:"Numbers",DET:"Determiners",PART:"Particles"})[a]||a}}}if(a.includes(e.toLowerCase())){let a,s;return"multi-meaning"===e.toLowerCase()?(a=await r.getMultimeaningFlashcards(t),s="Multi-meaning Words"):"multi-word"===e.toLowerCase()?(a=await r.getMultiwordFlashcards(t),s="Multi-word Expressions"):(a=[],s=e),{flashcards:a,title:s}}let s=await r.getFlashcardsByTopicLegacy(e,t),i=(await r.getAllTopics()).find(t=>t.id===e);return{flashcards:s,title:(null==i?void 0:i.title)||"Topic: ".concat(e)}}async function u(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;try{let i=await r.getFlashcardsByTopic(e,t,a,s),n=(await r.getAllTopics()).find(t=>t.id===e);return{flashcards:i.flashcards,title:(null==n?void 0:n.title)||"Topic: ".concat(e),total:i.total,hasMore:i.hasMore}}catch(e){throw console.error("Error fetching flashcards by topic with pagination:",e),e}}async function h(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;try{try{let i=await r.getAllWordTypes();if(i.map(e=>e.id).includes(e.toLowerCase())){let n=i.find(t=>t.id===e.toLowerCase());if(n){let e=await r.getFlashcardsByTypeWithPagination(n.name,t,a,s);return{flashcards:e.flashcards,title:n.title,total:e.total,hasMore:e.hasMore}}}}catch(i){if(console.error("Error loading word types, falling back to hardcoded list:",i),["verb","noun","adj","adv","prep","conj","intj","pron","num","det","part"].includes(e.toLowerCase())){let i=e.toUpperCase(),n=await r.getFlashcardsByTypeWithPagination(i,t,a,s);return{flashcards:n.flashcards,title:({VERB:"Verbs",NOUN:"Nouns",ADJ:"Adjectives",ADV:"Adverbs",PREP:"Prepositions",CONJ:"Conjunctions",INTJ:"Interjections",PRON:"Pronouns",NUM:"Numbers",DET:"Determiners",PART:"Particles"})[i]||i,total:n.total,hasMore:n.hasMore}}}if(["multi-meaning","multi-word"].includes(e.toLowerCase())){let i,n;return"multi-meaning"===e.toLowerCase()?(i=await r.getMultimeaningFlashcardsWithPagination(t,a,s),n="Multi-meaning Words"):"multi-word"===e.toLowerCase()?(i=await r.getMultiwordFlashcardsWithPagination(t,a,s),n="Multi-word Expressions"):(i={flashcards:[],total:0,hasMore:!1},n=e),{flashcards:i.flashcards,title:n,total:i.total,hasMore:i.hasMore}}let i=await r.getFlashcardsByTopic(e,t,a,s),n=(await r.getAllTopics()).find(t=>t.id===e);return{flashcards:i.flashcards,title:(null==n?void 0:n.title)||"Topic: ".concat(e),total:i.total,hasMore:i.hasMore}}catch(e){throw console.error("Error fetching flashcards by category with pagination:",e),e}}}]);