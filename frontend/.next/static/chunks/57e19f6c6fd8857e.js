(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,243970,e=>{"use strict";e.s(["Progress",()=>y],243970);var s=e.i(843476),r=e.i(271645),t=e.i(30030),i=e.i(248425),o="Progress",[n,a]=(0,t.createContextScope)(o),[l,c]=n(o),u=r.forwardRef((e,r)=>{var t,o,n,a;let{__scopeProgress:c,value:u=null,max:d,getValueLabel:p=m,...h}=e;(d||0===d)&&!g(d)&&console.error((t="".concat(d),o="Progress","Invalid prop `max` of value `".concat(t,"` supplied to `").concat(o,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let y=g(d)?d:100;null===u||v(u,y)||console.error((n="".concat(u),a="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(a,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let b=v(u,y)?u:null,j=f(b)?p(b,y):void 0;return(0,s.jsx)(l,{scope:c,value:b,max:y,children:(0,s.jsx)(i.Primitive.div,{"aria-valuemax":y,"aria-valuemin":0,"aria-valuenow":f(b)?b:void 0,"aria-valuetext":j,role:"progressbar","data-state":x(b,y),"data-value":null!=b?b:void 0,"data-max":y,...h,ref:r})})});u.displayName=o;var d="ProgressIndicator",p=r.forwardRef((e,r)=>{var t;let{__scopeProgress:o,...n}=e,a=c(d,o);return(0,s.jsx)(i.Primitive.div,{"data-state":x(a.value,a.max),"data-value":null!=(t=a.value)?t:void 0,"data-max":a.max,...n,ref:r})});function m(e,s){return"".concat(Math.round(e/s*100),"%")}function x(e,s){return null==e?"indeterminate":e===s?"complete":"loading"}function f(e){return"number"==typeof e}function g(e){return f(e)&&!isNaN(e)&&e>0}function v(e,s){return f(e)&&!isNaN(e)&&e<=s&&e>=0}p.displayName=d;var h=e.i(605458);function y(e){let{className:r,value:t,...i}=e;return(0,s.jsx)(u,{"data-slot":"progress",className:(0,h.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",r),...i,children:(0,s.jsx)(p,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}},584647,e=>{"use strict";e.s(["useExerciseSession",()=>r]);var s=e.i(271645);function r(){let e=(0,s.useRef)(!1),r=(0,s.useRef)(!1),t=(0,s.useCallback)(async s=>{if(e.current)return console.warn("[useExerciseSession] Start already in progress"),null;e.current=!0;try{console.log("[useExerciseSession] Starting exercise:",s);let e=await fetch("/api/exercise/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceSetId:s})}),r=await e.json();if(!e.ok||!r.success)return console.error("[useExerciseSession] Failed to start exercise:",{status:e.status,statusText:e.statusText,error:r.error,data:r}),null;return console.log("[useExerciseSession] Exercise started:",{practiceResultId:r.practiceResultId,attemptNo:r.attemptNo,resumed:r.resumed}),{practiceResultId:r.practiceResultId,attemptNo:r.attemptNo}}catch(e){return console.error("[useExerciseSession] Error starting exercise:",e),null}finally{e.current=!1}},[]);return{startExercise:t,submitExercise:(0,s.useCallback)(async e=>{if(r.current)return console.warn("[useExerciseSession] Submit already in progress"),{success:!1,error:"Submit already in progress"};r.current=!0;try{console.log("[useExerciseSession] Submitting exercise:",{practiceResultId:e.practiceResultId,scorePercent:e.scorePercent,passed:e.passed});let s=await fetch("/api/exercise/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();if(!s.ok||!r.success)return console.error("[useExerciseSession] Failed to submit exercise:",r.error),{success:!1,error:r.error};return console.log("[useExerciseSession] Exercise submitted successfully:",{isFirstPass:r.isFirstPass,coinsEarned:r.coinsEarned,xpEarned:r.xpEarned}),r}catch(e){return console.error("[useExerciseSession] Error submitting exercise:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}finally{r.current=!1}},[]),checkForResume:(0,s.useCallback)(async e=>{try{console.log("[useExerciseSession] Checking for in_progress session:",e);let s=await fetch("/api/exercise/resume?practiceSetId=".concat(e)),r=await s.json();if(!s.ok||!r.success)return console.error("[useExerciseSession] Failed to check resume:",r.error),null;if(r.practiceResult)return console.log("[useExerciseSession] Found in_progress session:",r.practiceResult.id),{practiceResultId:r.practiceResult.id,attemptNo:r.practiceResult.attemptNo};return console.log("[useExerciseSession] No in_progress session found"),null}catch(e){return console.error("[useExerciseSession] Error checking resume:",e),null}},[])}}},842009,e=>{"use strict";e.s(["Award",()=>s],842009);let s=(0,e.i(475254).default)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},162566,736860,414637,242273,e=>{"use strict";e.s([],162566),e.i(584647),e.i(271645);var s=e.i(859016);e.s(["useTopicProgress",()=>a,"useZoneCompletion",()=>l],736860);var r=e.i(266027),t=e.i(545208);async function i(e,r){let t=(0,s.createClient)(),{data:i,error:o}=await t.from("user_lesson_progress").select("*").eq("user_id",e).eq("topic_id",r).order("lesson_id",{ascending:!0});return o||!i?[]:i}async function o(e){let{userId:r,zoneId:t}=e,i=(0,s.createClient)(),{data:o,error:n}=await i.from("topics").select("topic_id").eq("zone_id",t);if(n||!o)return{completed:0,total:0};let a=o.map(e=>e.topic_id),l=a.length;if(0===l)return{completed:0,total:0};let{data:c,error:u}=await i.from("lessons").select("id, topic_id").in("topic_id",a);if(u||!c)return{completed:0,total:l};let d=c.map(e=>e.id),{data:p,error:m}=await i.from("user_lesson_progress").select("lesson_id, topic_id, status").eq("user_id",r).in("lesson_id",d).eq("status","passed");if(m||!p)return{completed:0,total:l};let x=new Map;a.forEach(e=>{let s=c.filter(s=>s.topic_id===e);x.set(e,{total:s.length,passed:0})}),p.forEach(e=>{let s=x.get(e.topic_id);s&&(s.passed+=1)});let f=0;return x.forEach(e=>{e.total>0&&e.passed>=e.total&&(f+=1)}),{completed:f,total:l}}var n=e.i(761163);function a(e,s){var o;let{user:a}=(0,t.useUserProfile)(),{data:l=[],isLoading:c}=(0,r.useQuery)({queryKey:n.queryKeys.lessonProgress.topic(null!=(o=null==a?void 0:a.id)?o:"",e),queryFn:async()=>(null==a?void 0:a.id)?i(a.id,e):null!=s?s:[],enabled:!!(null==a?void 0:a.id),initialData:s,staleTime:3e4,gcTime:3e5});return{topicProgress:l,isLoading:c}}function l(e){var s,i,a;let{user:l}=(0,t.useUserProfile)(),{data:c,isLoading:u}=(0,r.useQuery)({queryKey:[...n.queryKeys.lessonProgress.zone(null!=(s=null==l?void 0:l.id)?s:"",e),"completion"],queryFn:async()=>(null==l?void 0:l.id)?o({userId:l.id,zoneId:e}):{completed:0,total:0},enabled:!!(null==l?void 0:l.id)&&e>0,staleTime:6e4,gcTime:6e5});return{completed:null!=(i=null==c?void 0:c.completed)?i:0,total:null!=(a=null==c?void 0:c.total)?a:0,isLoading:u}}function c(e){let{userTier:s,isAuthenticated:r,zoneLevel:t,lessonSortOrder:i,previousLessonProgress:o,completedTopicsInPreviousZone:n=0,totalTopicsInPreviousZone:a=0}=e;if(!r)return{isLocked:!0,reason:"login_required",requiredAction:"Please log in to access lessons"};if("UNLIMITED"===s)return{isLocked:!1};if("FREE"===s){if(1===t)return 1===i||o&&"passed"===o.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson in this topic first"};if(!(a>0&&n>=a)){var l;let e={1:"Beginner",2:"Elementary",3:"Intermediate",4:"Advanced",5:"Expert"}[l=t-1]||"Zone ".concat(l);return{isLocked:!0,reason:"zone_locked",requiredAction:"Complete all topics in ".concat(e," zone to unlock this zone (").concat(n,"/").concat(a," topics completed)"),completedTopicsInPrevZone:n,totalTopicsInPrevZone:a}}return 1===i||o&&"passed"===o.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson in this topic first"}}return"PLUS"===s?1===i||o&&"passed"===o.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson first"}:{isLocked:!0,reason:"tier_restriction",requiredAction:"Upgrade to access this lesson"}}function u(e,s){var o;let{user:a}=(0,t.useUserProfile)(),{data:l=[],isLoading:c}=(0,r.useQuery)({queryKey:n.queryKeys.lessonProgress.topic(null!=(o=null==a?void 0:a.id)?o:"",e),queryFn:async()=>(null==a?void 0:a.id)?i(a.id,e):null!=s?s:[],enabled:!!(null==a?void 0:a.id),initialData:s,staleTime:3e4,gcTime:3e5});return{completedLessons:l.filter(e=>"passed"===e.status).length,isLoading:c}}e.s(["checkLessonUnlock",()=>c],414637),e.s(["useTopicProgressStats",()=>u],242273)},783436,e=>{"use strict";e.s(["default",()=>x],783436);var s=e.i(843476),r=e.i(522016),t=e.i(859951),i=e.i(628574),o=e.i(503116),n=e.i(842009),a=e.i(595468),l=e.i(270756),c=e.i(545208);e.i(162566);var u=e.i(736860);e.i(305914),e.i(635121),e.i(316735),e.i(805068),e.i(115e3),e.i(70388),e.i(447297);var d=e.i(285370),p=e.i(991101);e.i(113207);var m=e.i(414637);function x(e){var x;let{lessons:f,topicId:g,topicSlug:v,zoneId:h,zoneLevel:y,initialProgress:b}=e,{profile:j,user:k}=(0,c.useUserProfile)(),{topicProgress:N}=(0,u.useTopicProgress)(g,b),{completed:w,total:P}=(0,u.useZoneCompletion)(h-1),_=null!=(x=null==j?void 0:j.subscription_type)?x:"FREE";return(0,s.jsx)("div",{className:"grid gap-4",children:f.map((e,c)=>{var u,x,g,h;let b=N.find(s=>s.lesson_id===e.id),j=c>0?f[c-1]:null,E=j?N.find(e=>e.lesson_id===j.id):null,S=(0,m.checkLessonUnlock)({userTier:_,isAuthenticated:!!k,zoneLevel:y,lessonSortOrder:null!=(u=e.sort_order)?u:c+1,previousLessonProgress:null!=E?E:null,completedTopicsInPreviousZone:w,totalTopicsInPreviousZone:P}),T=S.isLocked;return(0,s.jsx)(p.LessonUnlockTooltip,{unlockStatus:S,children:(0,s.jsx)(i.Card,{className:"transition-all duration-300 hover:shadow-lg ".concat(T?"opacity-60 cursor-not-allowed":"hover:scale-[1.02]"),children:(0,s.jsx)(i.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 ".concat((null==b?void 0:b.status)==="passed"?"bg-green-500 border-green-500 text-white":T?"bg-gray-200 border-gray-300 text-gray-500":"bg-blue-50 border-[#067BC2] text-[#067BC2]"),children:(null==b?void 0:b.status)==="passed"?(0,s.jsx)(a.CheckCircle2,{size:24}):T?(0,s.jsx)(l.Lock,{size:20}):(0,s.jsx)("span",{className:"font-bold",children:null!=(x=e.sort_order)?x:c+1})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.lesson_name}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(o.Clock,{size:14}),"~",null!=(g=e.duration_minutes)?g:15," min"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(n.Award,{size:14}),null!=(h=e.coins_reward)?h:50," coins"]})]}),b&&(0,s.jsx)("div",{className:"mt-2 inline-block",children:(0,s.jsx)(d.LessonProgressBadge,{status:b.status,bestScore:b.best_score_percent,passThreshold:b.pass_threshold})})]})]}),(0,s.jsx)("div",{children:T?(0,s.jsxs)(t.Button,{disabled:!0,variant:"secondary",className:"px-6",children:[(0,s.jsx)(l.Lock,{size:16,className:"mr-2"}),"Locked"]}):(0,s.jsx)(t.Button,{asChild:!0,className:"px-6 bg-[#067BC2] hover:bg-[#055a9f]",children:(0,s.jsx)(r.default,{href:"/learn/".concat(v,"/").concat(e.slug),children:(null==b?void 0:b.status)==="passed"?"Review":"Start Lesson"})})})]})})})},e.slug)})})}},203777,e=>{"use strict";e.s(["default",()=>n]);var s=e.i(843476),r=e.i(810980),t=e.i(595468),i=e.i(243970);e.i(162566);var o=e.i(242273);function n(e){let{topicId:n,totalLessons:a,initialProgress:l}=e,{completedLessons:c,isLoading:u}=(0,o.useTopicProgressStats)(n,l),d=c>0?c:0,p=a>0?Math.round(d/a*100):0;return console.log("[TopicProgressStats] Debug:",{topicId:n,completedLessons:c,totalLessons:a,displayPercentage:p}),(0,s.jsxs)("div",{className:"mt-4 space-y-3 bg-black/30 backdrop-blur-sm p-3 rounded-lg border border-white/10",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 text-gray-200",children:[(0,s.jsxs)("span",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,s.jsx)(r.BookOpen,{size:16}),(0,s.jsxs)("span",{children:[a," lessons"]})]}),(0,s.jsxs)("span",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,s.jsx)(t.CheckCircle2,{size:16}),(0,s.jsxs)("span",{children:[d," completed"]})]})]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-100",children:[(0,s.jsx)("span",{children:"Your Progress"}),(0,s.jsxs)("span",{children:[p,"%"]})]}),(0,s.jsx)(i.Progress,{value:p,className:"h-1.5 bg-white/20 [&>div]:bg-teal-400"})]})]})}}]);