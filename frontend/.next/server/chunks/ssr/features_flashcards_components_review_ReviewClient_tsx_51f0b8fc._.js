module.exports=[226215,a=>{"use strict";a.s(["default",()=>aX],226215);var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(255895),f=a.i(214549),g=a.i(429535),h=a.i(172252),i=a.i(675751),j=a.i(669520),k=a.i(823292),l=a.i(125138),m=a.i(816201),n=a.i(65151),o=a.i(596221),p=a.i(862722);let q=({status:a})=>{switch(a){case"pending":default:return(0,b.jsx)(n.Circle,{className:"h-5 w-5 text-gray-400"});case"loading":return(0,b.jsx)(o.Loader2,{className:"h-5 w-5 text-blue-600 animate-spin"});case"completed":return(0,b.jsx)(m.CheckCircle,{className:"h-5 w-5 text-green-600"});case"error":return(0,b.jsx)(p.XCircle,{className:"h-5 w-5 text-red-600"})}},r=({steps:a})=>{let c=a.filter(a=>"completed"===a.status).length/a.length*100;return(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-6",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${c}%`}})})},s=({steps:a,title:c="Processing...",onCancel:d,className:e=""})=>{let f=a.some(a=>"error"===a.status),g=a.every(a=>"completed"===a.status);return(0,b.jsx)("div",{className:`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 ${e}`,children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:c}),(0,b.jsx)(r,{steps:a})]}),(0,b.jsx)("div",{className:"space-y-4 mb-6",children:a.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,b.jsx)(q,{status:a.status})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:`text-sm font-medium ${"completed"===a.status?"text-green-700":"loading"===a.status?"text-blue-700":"error"===a.status?"text-red-700":"text-gray-600"}`,children:a.label}),a.description&&(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.description})]})]},a.id))}),(f||d)&&!g&&(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[d&&(0,b.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),f&&(0,b.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Retry"})]}),g&&(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"text-sm text-green-700 font-medium",children:"Ready to start your session!"})})]})})};var t=a.i(761355),u=a.i(966395);let v=new class{baseUrl;constructor(){this.baseUrl="https://vietnamesenext.onrender.com"}async validateSessionFilters(a,b){try{let c={...a};b&&(c.user_id=b);let d=await fetch(`${this.baseUrl}/api/v1/flashcards/session/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok){let a=await d.json().catch(()=>null);throw Error(a?.detail||`HTTP error! status: ${d.status}`)}return await d.json()}catch(a){throw console.error("Error validating session filters:",a),a}}async generateSessionCards(a){try{let b=await fetch(`${this.baseUrl}/api/v1/flashcards/session/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a=await b.json().catch(()=>null);throw Error(a?.detail||`HTTP error! status: ${b.status}`)}return await b.json()}catch(a){throw console.error("Error generating session cards:",a),a}}buildFiltersFromForm(a){return{topic:a.topic||void 0,complexity:"All"===a.complexity?"all":a.complexity.toLowerCase(),common_words_only:a.onlyCommonWords,num_cards:a.numberOfCards}}formatSuggestionForDisplay(a){let b=[];return a.impact.removed_restrictions?.length&&b.push(`removes ${a.impact.removed_restrictions.join(", ")} restrictions`),a.impact.expanded_complexity&&b.push("includes all complexity levels"),a.impact.expanded_topics&&b.push("includes all topics"),b.length>0?b.join(", "):a.description}};var w=a.i(319408),x=a.i(6912),y=a.i(507554),z=a.i(470121),A=a.i(750104),B=a.i(30553),C=a.i(224050),D=a.i(225152),E=a.i(507827),F=a.i(3688),G=a.i(77994),H=a.i(777192),I="Radio",[J,K]=(0,A.createContextScope)(I),[L,M]=J(I),N=c.forwardRef((a,d)=>{let{__scopeRadio:e,name:f,checked:g=!1,required:h,disabled:i,value:j="on",onCheck:k,form:l,...m}=a,[n,o]=c.useState(null),p=(0,z.useComposedRefs)(d,a=>o(a)),q=c.useRef(!1),r=!n||l||!!n.closest("form");return(0,b.jsxs)(L,{scope:e,checked:g,disabled:i,children:[(0,b.jsx)(B.Primitive.button,{type:"button",role:"radio","aria-checked":g,"data-state":R(g),"data-disabled":i?"":void 0,disabled:i,value:j,...m,ref:p,onClick:(0,y.composeEventHandlers)(a.onClick,a=>{g||k?.(),r&&(q.current=a.isPropagationStopped(),q.current||a.stopPropagation())})}),r&&(0,b.jsx)(Q,{control:n,bubbles:!q.current,name:f,value:j,checked:g,required:h,disabled:i,form:l,style:{transform:"translateX(-100%)"}})]})});N.displayName=I;var O="RadioIndicator",P=c.forwardRef((a,c)=>{let{__scopeRadio:d,forceMount:e,...f}=a,g=M(O,d);return(0,b.jsx)(H.Presence,{present:e||g.checked,children:(0,b.jsx)(B.Primitive.span,{"data-state":R(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c})})});P.displayName=O;var Q=c.forwardRef(({__scopeRadio:a,control:d,checked:e,bubbles:f=!0,...g},h)=>{let i=c.useRef(null),j=(0,z.useComposedRefs)(i,h),k=(0,G.usePrevious)(e),l=(0,F.useSize)(d);return c.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(k!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[k,e,f]),(0,b.jsx)(B.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:j,style:{...g.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function R(a){return a?"checked":"unchecked"}Q.displayName="RadioBubbleInput";var S=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],T="RadioGroup",[U,V]=(0,A.createContextScope)(T,[C.createRovingFocusGroupScope,K]),W=(0,C.createRovingFocusGroupScope)(),X=K(),[Y,Z]=U(T),$=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,name:e,defaultValue:f,value:g,required:h=!1,disabled:i=!1,orientation:j,dir:k,loop:l=!0,onValueChange:m,...n}=a,o=W(d),p=(0,E.useDirection)(k),[q,r]=(0,D.useControllableState)({prop:g,defaultProp:f??null,onChange:m,caller:T});return(0,b.jsx)(Y,{scope:d,name:e,required:h,disabled:i,value:q,onValueChange:r,children:(0,b.jsx)(C.Root,{asChild:!0,...o,orientation:j,dir:p,loop:l,children:(0,b.jsx)(B.Primitive.div,{role:"radiogroup","aria-required":h,"aria-orientation":j,"data-disabled":i?"":void 0,dir:p,...n,ref:c})})})});$.displayName=T;var _="RadioGroupItem",aa=c.forwardRef((a,d)=>{let{__scopeRadioGroup:e,disabled:f,...g}=a,h=Z(_,e),i=h.disabled||f,j=W(e),k=X(e),l=c.useRef(null),m=(0,z.useComposedRefs)(d,l),n=h.value===g.value,o=c.useRef(!1);return c.useEffect(()=>{let a=a=>{S.includes(a.key)&&(o.current=!0)},b=()=>o.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,b.jsx)(C.Item,{asChild:!0,...j,focusable:!i,active:n,children:(0,b.jsx)(N,{disabled:i,required:h.required,checked:n,...k,...g,name:h.name,ref:m,onCheck:()=>h.onValueChange(g.value),onKeyDown:(0,y.composeEventHandlers)(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:(0,y.composeEventHandlers)(g.onFocus,()=>{o.current&&l.current?.click()})})})});aa.displayName=_;var ab=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,...e}=a,f=X(d);return(0,b.jsx)(P,{...f,...e,ref:c})});ab.displayName="RadioGroupIndicator";var ac=a.i(171150),ad=a.i(16116);function ae({className:a,...c}){return(0,b.jsx)($,{"data-slot":"radio-group",className:(0,ad.cn)("grid gap-3",a),...c})}function af({className:a,...c}){return(0,b.jsx)(aa,{"data-slot":"radio-group-item",className:(0,ad.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(ab,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,b.jsx)(ac.CircleIcon,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var ag=a.i(81594),ah=a.i(73570),ai=a.i(50522),aj=a.i(724669),ak=a.i(419499);let al=({isOpen:a,onClose:d,availableCount:e,requestedCount:g,suggestions:h,onAcceptSuggestion:j,onAdjustFilters:k,isLoading:l=!1})=>{let[m,n]=(0,c.useState)(h.length>0?h[0].id:""),o=h.find(a=>a.id===m);return(0,b.jsx)(i.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(i.DialogContent,{className:"sm:max-w-2xl",children:[(0,b.jsx)(i.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-orange-100 dark:bg-orange-900 rounded-full",children:(0,b.jsx)(ah.AlertTriangle,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.DialogTitle,{className:"text-xl",children:"Not Enough Cards Available"}),(0,b.jsxs)(i.DialogDescription,{className:"mt-1",children:["Only ",e," cards found, but you requested ",g," cards"]})]})]})}),(0,b.jsx)("div",{className:"py-6",children:h.length>0?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(aj.TrendingUp,{className:"h-4 w-4 text-blue-600"}),(0,b.jsxs)("span",{className:"font-medium text-blue-900 dark:text-blue-100",children:["Suggestions to reach ",g," cards:"]})]}),(0,b.jsx)(ae,{value:m,onValueChange:n,className:"space-y-4",children:h.map(a=>(0,b.jsx)("div",{className:`border rounded-lg p-4 transition-all ${m===a.id?"border-blue-500 bg-blue-50 dark:bg-blue-950/20":"border-gray-200 dark:border-gray-700"}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(af,{value:a.id,id:a.id,className:"mt-1"}),(0,b.jsxs)(ag.Label,{htmlFor:a.id,className:"flex-1 cursor-pointer space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.title}),(0,b.jsxs)(ak.Badge,{variant:"secondary",className:"ml-2",children:[a.estimated_count," cards"]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.description}),a.impact.additional_count&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm text-green-600 dark:text-green-400",children:[(0,b.jsx)(ai.ChevronRight,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:["+",a.impact.additional_count," additional cards"]})]})]})]})},a.id))}),o&&(0,b.jsx)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Selected option will provide: "}),(0,b.jsxs)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[o.estimated_count," cards total"]})]})})]}):(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:[(0,b.jsxs)("p",{children:["No suggestions available to reach ",g," cards."]}),(0,b.jsx)("p",{className:"mt-2",children:"Try adjusting your filters manually."})]})})}),(0,b.jsxs)(i.DialogFooter,{className:"flex gap-3",children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:k,className:"flex-1",disabled:l,children:"Adjust Filters"}),h.length>0&&o&&(0,b.jsx)(f.Button,{onClick:()=>{let a=h.find(a=>a.id===m);a&&j(a)},className:"flex-1",disabled:l,children:l?"Creating Session...":"Accept Suggestion"})]})]})})};var am=a.i(771441),an=a.i(557116),ao=a.i(211885),ap="Toggle",aq=c.forwardRef((a,c)=>{let{pressed:d,defaultPressed:e,onPressedChange:f,...g}=a,[h,i]=(0,D.useControllableState)({prop:d,onChange:f,defaultProp:e??!1,caller:ap});return(0,b.jsx)(B.Primitive.button,{type:"button","aria-pressed":h,"data-state":h?"on":"off","data-disabled":a.disabled?"":void 0,...g,ref:c,onClick:(0,y.composeEventHandlers)(a.onClick,()=>{a.disabled||i(!h)})})});aq.displayName=ap;var ar="ToggleGroup",[as,at]=(0,A.createContextScope)(ar,[C.createRovingFocusGroupScope]),au=(0,C.createRovingFocusGroupScope)(),av=c.default.forwardRef((a,c)=>{let{type:d,...e}=a;if("single"===d)return(0,b.jsx)(ay,{...e,ref:c});if("multiple"===d)return(0,b.jsx)(az,{...e,ref:c});throw Error(`Missing prop \`type\` expected on \`${ar}\``)});av.displayName=ar;var[aw,ax]=as(ar),ay=c.default.forwardRef((a,d)=>{let{value:e,defaultValue:f,onValueChange:g=()=>{},...h}=a,[i,j]=(0,D.useControllableState)({prop:e,defaultProp:f??"",onChange:g,caller:ar});return(0,b.jsx)(aw,{scope:a.__scopeToggleGroup,type:"single",value:c.default.useMemo(()=>i?[i]:[],[i]),onItemActivate:j,onItemDeactivate:c.default.useCallback(()=>j(""),[j]),children:(0,b.jsx)(aC,{...h,ref:d})})}),az=c.default.forwardRef((a,d)=>{let{value:e,defaultValue:f,onValueChange:g=()=>{},...h}=a,[i,j]=(0,D.useControllableState)({prop:e,defaultProp:f??[],onChange:g,caller:ar}),k=c.default.useCallback(a=>j((b=[])=>[...b,a]),[j]),l=c.default.useCallback(a=>j((b=[])=>b.filter(b=>b!==a)),[j]);return(0,b.jsx)(aw,{scope:a.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:k,onItemDeactivate:l,children:(0,b.jsx)(aC,{...h,ref:d})})});av.displayName=ar;var[aA,aB]=as(ar),aC=c.default.forwardRef((a,c)=>{let{__scopeToggleGroup:d,disabled:e=!1,rovingFocus:f=!0,orientation:g,dir:h,loop:i=!0,...j}=a,k=au(d),l=(0,E.useDirection)(h),m={role:"group",dir:l,...j};return(0,b.jsx)(aA,{scope:d,rovingFocus:f,disabled:e,children:f?(0,b.jsx)(C.Root,{asChild:!0,...k,orientation:g,dir:l,loop:i,children:(0,b.jsx)(B.Primitive.div,{...m,ref:c})}):(0,b.jsx)(B.Primitive.div,{...m,ref:c})})}),aD="ToggleGroupItem",aE=c.default.forwardRef((a,d)=>{let e=ax(aD,a.__scopeToggleGroup),f=aB(aD,a.__scopeToggleGroup),g=au(a.__scopeToggleGroup),h=e.value.includes(a.value),i=f.disabled||a.disabled,j={...a,pressed:h,disabled:i},k=c.default.useRef(null);return f.rovingFocus?(0,b.jsx)(C.Item,{asChild:!0,...g,focusable:!i,active:h,ref:k,children:(0,b.jsx)(aF,{...j,ref:d})}):(0,b.jsx)(aF,{...j,ref:d})});aE.displayName=aD;var aF=c.default.forwardRef((a,c)=>{let{__scopeToggleGroup:d,value:e,...f}=a,g=ax(aD,d),h={role:"radio","aria-checked":a.pressed,"aria-pressed":void 0},i="single"===g.type?h:void 0;return(0,b.jsx)(aq,{...i,...f,ref:c,onPressedChange:a=>{a?g.onItemActivate(e):g.onItemDeactivate(e)}})});let aG=(0,a.i(400187).cva)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),aH=c.createContext({size:"default",variant:"default",spacing:0});function aI({className:a,variant:c,size:d,spacing:e=0,children:f,...g}){return(0,b.jsx)(av,{"data-slot":"toggle-group","data-variant":c,"data-size":d,"data-spacing":e,style:{"--gap":e},className:(0,ad.cn)("group/toggle-group flex w-fit items-center gap-[--spacing(var(--gap))] rounded-md data-[spacing=default]:data-[variant=outline]:shadow-xs",a),...g,children:(0,b.jsx)(aH.Provider,{value:{variant:c,size:d,spacing:e},children:f})})}function aJ({className:a,children:d,variant:e,size:f,...g}){let h=c.useContext(aH);return(0,b.jsx)(aE,{"data-slot":"toggle-group-item","data-variant":h.variant||e,"data-size":h.size||f,"data-spacing":h.spacing,className:(0,ad.cn)(aG({variant:h.variant||e,size:h.size||f}),"w-auto min-w-0 shrink-0 px-3 focus:z-10 focus-visible:z-10","data-[spacing=0]:rounded-none data-[spacing=0]:shadow-none data-[spacing=0]:first:rounded-l-md data-[spacing=0]:last:rounded-r-md data-[spacing=0]:data-[variant=outline]:border-l-0 data-[spacing=0]:data-[variant=outline]:first:border-l",a),...g,children:d})}var aK=a.i(694660);let aL=(0,a.i(883706).default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var aM=a.i(325015),aN=a.i(943108),aO=a.i(786520),aP=a.i(238246);function aQ({sessionConfig:a,setSessionConfig:c,topics:d,user:e,onStartCustomSession:h,isCreatingCustomSession:i,isValidating:j}){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(an.Card,{className:"mb-8",children:[(0,b.jsxs)(an.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(aL,{className:"h-5 w-5"}),(0,b.jsx)(an.CardTitle,{children:"Create Your Own Review Session"})]}),(0,b.jsx)(an.CardDescription,{children:"Customize your review experience with specific filters and preferences"})]}),(0,b.jsxs)(an.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-end md:gap-6",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Filter by Topic"}),(0,b.jsxs)(ao.Select,{value:a.topic,onValueChange:b=>c({...a,topic:b}),children:[(0,b.jsx)(ao.SelectTrigger,{children:(0,b.jsx)(ao.SelectValue,{placeholder:"Select a Topic"})}),(0,b.jsx)(ao.SelectContent,{children:d.map(a=>(0,b.jsx)(ao.SelectItem,{value:a.name,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.icon}),(0,b.jsx)("span",{children:a.name})]})},a.id))})]})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-2 mt-4 md:mt-0",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Filter by Complexity"}),(0,b.jsxs)(aI,{type:"single",value:a.complexity,onValueChange:b=>b&&c({...a,complexity:b}),className:"w-full",children:[(0,b.jsx)(aJ,{value:"All",children:"All"}),(0,b.jsx)(aJ,{value:"Simple",children:"Simple"}),(0,b.jsx)(aJ,{value:"Complex",children:"Complex"})]})]})]}),(0,b.jsx)("div",{className:"flex flex-col md:flex-row md:items-end md:gap-6",children:(0,b.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,b.jsx)(g.Checkbox,{id:"onlyCommonWords",checked:!!a.onlyCommonWords,onCheckedChange:b=>c({...a,onlyCommonWords:!!b})}),(0,b.jsx)("label",{htmlFor:"onlyCommonWords",className:"ml-2 text-sm font-medium",children:"Only show common words"})]})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.Checkbox,{id:"savedCards",checked:a.includeSavedCards,onCheckedChange:b=>c({...a,includeSavedCards:!!b}),disabled:e?.subscription_type==="FREE"}),(0,b.jsx)("label",{htmlFor:"savedCards",className:"text-sm font-medium",children:"Include My Saved Cards"}),e?.subscription_type==="FREE"&&(0,b.jsxs)(ak.Badge,{variant:"secondary",children:[(0,b.jsx)(aO.Crown,{className:"w-3 h-3 mr-1"}),"Plus"]})]}),(0,b.jsx)("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aL,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),(0,b.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"Saved cards feature requires Supabase integration. Currently showing regular flashcards only."})]})}),e?.subscription_type==="FREE"&&(0,b.jsxs)("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aN.Lock,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),(0,b.jsx)("p",{className:"text-sm text-amber-800 dark:text-amber-200 font-medium",children:"Tired of random words? Upgrade to Plus to unlock unlimited saved flashcards for review!"})]}),(0,b.jsx)(f.Button,{asChild:!0,size:"sm",className:"mt-2",children:(0,b.jsxs)(aP.default,{href:"/plans",children:[(0,b.jsx)(aO.Crown,{className:"w-4 h-4 mr-2"}),"Upgrade to Plus"]})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:["Number of cards to review: ",a.numberOfCards]}),(0,b.jsx)(aK.Slider,{value:[a.numberOfCards],onValueChange:b=>c({...a,numberOfCards:b[0]}),max:50,min:10,step:5,className:"w-full"})]})]})]}),(0,b.jsx)("div",{className:"text-center mb-8 space-y-4",children:(0,b.jsxs)(f.Button,{onClick:h,size:"lg",className:"text-lg px-8 py-6 h-auto",disabled:i||j,children:[(0,b.jsx)(aM.Play,{className:"w-5 h-5 mr-2"}),i||j?"Validating Session...":"Start Custom Review Session"]})})]})}let aR="flashcards:review";function aS(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function aT(a){let b=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:a,year:"numeric",month:"2-digit",day:"2-digit"}).format(b)}var aU=a.i(405050),aV=(0,aU.createServerReference)("40138ba5c927606e17947caf045f883ea82b7072d9",aU.callServer,void 0,aU.findSourceMapURL,"createReviewSession"),aW=(0,aU.createServerReference)("4066c3bfc9842b3e7a2fa482e6d40eb90f4e658ba3",aU.callServer,void 0,aU.findSourceMapURL,"createSessionCardMappings");function aX(){let a=(0,d.useRouter)(),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)([]),[y,z]=(0,c.useState)({reviewedToday:0,dailyGoal:20,dueForReview:0,accuracy:0}),[A,B]=(0,c.useState)({complexity:"All",includeSavedCards:!1,numberOfCards:10,onlyCommonWords:!1}),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),{isLoading:M,withLoading:N,stopLoading:O}=(0,t.useLoading)(),{isValidating:P,validationResult:Q,validateSession:R,clearValidation:S}=(()=>{let[a,b]=(0,c.useState)(!1),[d,e]=(0,c.useState)(null),[f,g]=(0,c.useState)(null);return{isValidating:a,validationResult:d,validateSession:(0,c.useCallback)(async(a,c)=>{b(!0),g(null);try{console.log("ðŸ” Validating session filters:",a,c?`for user ${c}`:"");let b=await v.validateSessionFilters(a,c);return console.log("âœ… Validation result:",b),e(b),b.insufficient?(console.log(`âš ï¸ Insufficient cards: ${b.available_count}/${a.num_cards}`),b.suggestions&&b.suggestions.length>0&&console.log(`ðŸ’¡ Found ${b.suggestions.length} suggestions`)):console.log(`âœ… Sufficient cards available: ${b.available_count}/${a.num_cards}`),b}catch(b){let a=b instanceof Error?b.message:"Failed to validate session";return console.error("âŒ Session validation error:",b),g(a),k.toast.error(a),null}finally{b(!1)}},[]),clearValidation:(0,c.useCallback)(()=>{e(null),g(null)},[]),error:f}})(),{steps:T,updateStep:U,resetSteps:V,hasError:W}=(()=>{let[a,b]=(0,c.useState)([{id:"validate",label:"Validating session filters",status:"pending",description:"Checking if enough cards match your criteria"},{id:"generate",label:"Generating flashcards",status:"pending",description:"Fetching and preparing your cards"},{id:"save",label:"Creating session",status:"pending",description:"Saving session data to database"},{id:"redirect",label:"Preparing review interface",status:"pending",description:"Loading your flashcard session"}]),d=(0,c.useCallback)((a,c,d)=>{b(b=>b.map(b=>b.id===a?{...b,status:c,...d&&{description:d}}:b))},[]),e=(0,c.useCallback)(()=>{b(a=>a.map(a=>({...a,status:"pending"})))},[]),f=a.some(a=>"error"===a.status),g=a.every(a=>"completed"===a.status),h=a.find(a=>"loading"===a.status)||null;return{steps:a,updateStep:d,resetSteps:e,hasError:f,isCompleted:g,currentStep:h}})(),{getAnimationDuration:X}=(0,w.useDisplaySettings)(),{currentCard:Y,currentCardIndex:Z,isFlipped:$,timer:_,isTimerActive:aa,cardResults:ab,handleCardResult:ac,handleSaveCard:ad,handleFlipCard:ae,resetSession:af,getProgressStats:ag,savedCards:ah}=(0,x.useFlashcardReview)({cards:C,onSessionComplete:function(){k.toast.success("Practice session completed! Starting a new session..."),an()},enableTimer:!0});(0,c.useEffect)(()=>{n(!0)},[]),(0,c.useEffect)(()=>{if(!M)return;let a=setTimeout(()=>{try{O()}catch(a){}},33e3);return()=>clearTimeout(a)},[M,O]),(0,c.useEffect)(()=>{(async()=>{m&&await N(async()=>{try{let{data:{user:b},error:c}=await e.supabase.auth.getUser();if(c||!b){k.toast.error("Please log in to continue"),a.push("/auth/login");return}let{data:d,error:f}=await e.supabase.from("user_profiles").select("*").eq("id",b.id).maybeSingle();if(f||!d){console.error("Profile error:",f);let a={id:b.id,name:b.email?.split("@")[0]||"User",email:b.email||"",subscription_type:"FREE",streak_days:0,coins:0};try{let{data:b,error:c}=await e.supabase.from("user_profiles").insert(a).select().single();!c&&b?p(b):p(a)}catch(b){console.error("Error creating profile:",b),p(a)}}else p(d);try{let a=await u.flashcardAPI.getAllTopics();r(a.map(a=>({id:a.id,name:a.title,description:a.description,icon:"ðŸ“š"})))}catch(a){console.error("Error fetching topics:",a),r([])}await ai(b.id),await aj(b.id)}catch(a){console.error("Error fetching data:",a),k.toast.error("Failed to load review data")}})})()},[m,a,N]),(0,c.useEffect)(()=>{H("true"===sessionStorage.getItem("hideRestartSessionModal"))},[]);let ai=async a=>{try{let b=new Date().toISOString().split("T")[0],{data:c,error:d}=await e.supabase.from("flashcard_statistics").select("*").eq("user_id",a).eq("date",b).maybeSingle(),{data:f,count:g}=await e.supabase.from("flashcard_srs_records").select("*",{count:"exact"}).eq("user_id",a).lte("due_date",b);z({reviewedToday:c?.flashcards_reviewed||0,dailyGoal:20,dueForReview:g||0,accuracy:c?.accuracy_rate||0})}catch(a){console.error("Error fetching today's stats:",a)}},aj=async(b,c=!1)=>{try{console.log("Loading practice cards for user:",b,c?"(force refresh)":"");let e=null;if(c||(e=function(){try{let a=localStorage.getItem(aR);if(!a)return console.log("ðŸ“­ No cached flashcards found"),null;let b=JSON.parse(a),c=aS(),d=aT(c),e=Date.now();if(b.date===d&&e<b.expiry)return console.log(`ðŸ“š Loaded ${b.flashcards.length} cached flashcards from ${b.date}`),b.flashcards;return console.log(`ðŸ—‘ï¸ Cache expired or from different day. Cached: ${b.date}, Today: ${d}`),localStorage.removeItem(aR),null}catch(a){return console.error("Failed to load flashcards from localStorage:",a),localStorage.removeItem(aR),null}}()),e)k.toast.success(`Using today's cached flashcards (${e.length} cards)`);else if(console.log("ðŸ“¡ Fetching fresh flashcards from backend API..."),e=await u.flashcardAPI.getRandomFlashcards({count:15}),console.log("Fetched cards from backend:",e.length),e&&e.length>0){var d=e;let a=aS(),b=aT(a),c=function(a){let b=aT(a),c=new Date(`${b}T23:59:59.999`),d=new Date(c.toLocaleString("en-US",{timeZone:a})),e=new Date(c.toLocaleString("en-US",{timeZone:"UTC"})).getTime()-d.getTime();return c.getTime()+e}(a);try{localStorage.setItem(aR,JSON.stringify({flashcards:d,date:b,expiry:c,timezone:a})),console.log(`ðŸ’¾ Saved ${d.length} flashcards to localStorage, expires at:`,new Date(c))}catch(a){console.error("Failed to save flashcards to localStorage:",a)}k.toast.success(`Loaded ${e.length} fresh flashcards for today!`)}else{console.log("No cards returned from backend"),k.toast.error("No flashcards available for review"),D([]),a.push("/404");return}console.log("Successfully loaded cards:",e.length),D(e)}catch(a){console.error("Error loading practice cards:",a),k.toast.error("Failed to load flashcards. Please try again."),D([])}},ak=(0,c.useCallback)(async()=>{o&&(af(),await aj(o.id,!1))},[o,af]),an=(0,c.useCallback)(()=>{G?ak():F(!0)},[G,ak]),ao=(0,c.useCallback)(async()=>{o&&(af(),await aj(o.id,!1),k.toast.success("Session restarted!"))},[o,af]),ap=(0,c.useCallback)(async()=>{o&&await N(async()=>{af(),await aj(o.id,!0),k.toast.success("Loaded fresh flashcards!")})},[o,N,af]),aq=async()=>{if(o){L(!0),S(),V();try{U("validate","loading");let a=v.buildFiltersFromForm(A);console.log("ðŸŽ¯ Starting custom session validation:",a);let b=await R(a,o.id);if(console.log("Session validation result:",b),!b){U("validate","error","Validation failed"),k.toast.error("Failed to validate session filters");return}U("validate","completed"),b.insufficient?(console.log("âš ï¸ Insufficient cards - showing modal"),J(!0),L(!1)):(console.log("âœ… Sufficient cards - creating session directly"),await ar(a))}catch(a){console.error("Error starting custom session:",a),U("validate","error","Failed to start session"),k.toast.error("Failed to start custom session"),L(!1)}}},ar=async(b,c)=>{if(!o)throw Error("User not found");try{U("generate","loading");let d={user_id:o.id,filters:{...b,include_saved_cards:A.includeSavedCards},suggestion_id:c,include_saved_cards:A.includeSavedCards,session_metadata:{created_from:c?"suggestion":"form",original_filters:A}};console.log("ðŸ—ï¸ Generating custom session:",d);let e=new Promise((a,b)=>{let c=setTimeout(()=>{b(Error("Timeout generating session cards - backend took too long"))},3e4);v.generateSessionCards(d).then(b=>{clearTimeout(c),a(b)}).catch(a=>{clearTimeout(c),b(a)})}),f=await e;if(console.log("âœ… Session generated:",f),!f||!f.flashcards||0===f.flashcards.length)throw Error("No flashcards generated for session");U("generate","completed"),U("save","loading"),console.log("ðŸ’¾ [STEP 3] Starting session save process (Server Action)"),console.log("ðŸ“‹ Session config:",A),console.log("ðŸ“‹ Flashcards count:",f.actual_count);let g=await aV({session_type:"custom",total_cards:f.actual_count||0,session_config:{created_from:c?"suggestion":"form",original_filters:A},filters_applied:b});if(!g.success||!g.data)throw console.error("âŒ [STEP 3] Failed to create session:",g.error),Error(g.error||"Failed to save session");let h=g.data;console.log("âœ… [STEP 3] Session created successfully:",h.id),U("save","completed"),console.log("ðŸ“ [STEP 3.5] Persisting session cards mapping (Server Action)");let i=Array.isArray(f.flashcards)?f.flashcards:[];if(console.log(`ðŸ“Š [STEP 3.5] Processing ${i.length} flashcards`),i.length>0){let a=await aW({session_id:h.id,flashcards:i});a.success?console.log(`âœ… [STEP 3.5] Cards mapped: ${a.data?.inserted_count}/${i.length}`):console.error("âŒ [STEP 3.5] Failed to persist session cards mapping:",a.error)}console.log("ðŸš€ [STEP 4] Navigating to session page"),U("redirect","loading"),k.toast.success(`Custom session created with ${f.actual_count} cards!`),U("redirect","completed"),setTimeout(()=>{console.log(`âœ… [STEP 4] Redirecting to /flashcards/review/session?id=${h.id}`),L(!1),a.push(`/flashcards/review/session?id=${h.id}`)},800)}catch(b){console.error("Error creating custom session:",b?.message||b);let a=T.find(a=>"loading"===a.status);a&&U(a.id,"error",b?.message||"Failed to complete step"),b?.message?.includes("Timeout")?k.toast.error("Session creation timed out. Please try again or use Quick Review instead."):b?.message?.includes("Database error")?k.toast.error("Database error. Please check your connection and try again."):b?.message?.includes("Network")?k.toast.error("Network error. Please check your internet connection."):b?.message?.includes("generating session cards")?k.toast.error("Unable to generate cards. Try adjusting your filters or use Quick Review."):k.toast.error(`Failed to create custom session: ${b?.message||"Unknown error"}`),console.log("ðŸ’¡ Suggesting fallback to Quick Review")}},as=async(a,b)=>{await ar(a,b)},at=async a=>{J(!1),console.log("âœ… Accepting suggestion:",a),await as(a.filters,a.id)};if(!m)return null;let au=ag();return(0,b.jsx)(l.default,{isLoading:M,children:(0,b.jsxs)("div",{className:"container mx-auto py-10 px-4 max-w-4xl",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Flashcard Quick Review"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Practice Vietnamese vocabulary with intelligent spaced repetition"})]}),(0,b.jsx)(am.ReviewSession,{practiceCards:C,currentCard:Y,currentCardIndex:Z,isFlipped:$,timer:_,isTimerActive:aa,cardResults:ab,progressStats:au,savedCards:ah,onCardResult:ac,onSaveCard:ad,onFlipCard:ae,onRefreshCards:ao,onGetFreshCards:ap,getAnimationDuration:X,isLoading:M}),(0,b.jsx)("div",{className:"flex justify-center gap-4",children:(0,b.jsxs)(f.Button,{onClick:ap,variant:"outline",disabled:M,children:[(0,b.jsx)(j.RefreshCw,{className:`w-4 h-4 mr-2 ${M?"animate-spin":""}`}),"Get Fresh Cards for Today"]})}),(0,b.jsx)(h.Separator,{className:"my-8"}),(0,b.jsx)(aQ,{sessionConfig:A,setSessionConfig:B,topics:q,user:o,onStartCustomSession:aq,isCreatingCustomSession:K,isValidating:P}),(0,b.jsx)(al,{isOpen:I,onClose:()=>J(!1),availableCount:Q?.available_count||0,requestedCount:A.numberOfCards,suggestions:Q?.suggestions||[],onAcceptSuggestion:at,onAdjustFilters:()=>{J(!1),S(),console.log("ðŸ”§ User chose to adjust filters manually")},isLoading:K}),(0,b.jsx)(i.Dialog,{open:E,onOpenChange:F,children:(0,b.jsxs)(i.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsx)(i.DialogTitle,{children:"Do you want to restart this session?"}),(0,b.jsx)(i.DialogDescription,{children:"This will reset your progress for the current session. Are you sure you want to continue?"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 mt-4",children:[(0,b.jsx)(g.Checkbox,{id:"dontShowRestartAgain",checked:G,onCheckedChange:a=>{H(!!a),sessionStorage.setItem("hideRestartSessionModal",a?"true":"false")}}),(0,b.jsx)("label",{htmlFor:"dontShowRestartAgain",className:"text-sm font-medium",children:"Do not show this again"})]}),(0,b.jsxs)(i.DialogFooter,{className:"flex gap-2 mt-6",children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>F(!1),className:"flex-1",children:"Cancel"}),(0,b.jsx)(f.Button,{variant:"destructive",onClick:()=>{F(!1),ak()},className:"flex-1",children:"Yes, Restart"})]})]})}),K&&(0,b.jsx)(s,{title:"Creating Your Review Session",steps:T,onCancel:()=>{L(!1),V()}})]})})}}];

//# sourceMappingURL=features_flashcards_components_review_ReviewClient_tsx_51f0b8fc._.js.map