module.exports=[350711,a=>{"use strict";a.s(["default",()=>J],350711);var b=a.i(187924),c=a.i(572131),d=a.i(255895),e=a.i(823292),f=a.i(214549),g=a.i(975009),h=a.i(214852),i=a.i(557116),j=a.i(211885),k=a.i(81594),l=a.i(883706);let m=(0,l.default)("image-plus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);var n=a.i(212439),o=a.i(787654),p=a.i(915618),q=a.i(669520),r=a.i(633508),s=a.i(808406);let t=(0,l.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var u=a.i(50944),v=a.i(346271),w=a.i(419499);function x({vietnamese:a,english:c,pronunciation:d,wordType:e,topic:f,imagePreview:g,isFlipped:h=!1,onFlip:j}){return(0,b.jsxs)("div",{className:"relative",style:{perspective:"1000px"},children:[(0,b.jsxs)(v.motion.div,{style:{width:"100%",height:"320px",position:"relative",transformStyle:"preserve-3d"},transition:{duration:.6},animate:{rotateY:180*!!h},children:[(0,b.jsx)(v.motion.div,{style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"},children:(0,b.jsx)(i.Card,{className:"h-full cursor-pointer transition-all duration-300 hover:shadow-lg",onClick:j,children:(0,b.jsx)(i.CardContent,{className:"h-full flex flex-col justify-center items-center p-8 text-center",children:(0,b.jsxs)("div",{className:"space-y-4 w-full",children:[g&&(0,b.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 rounded-lg overflow-hidden bg-muted",children:(0,b.jsx)("img",{src:g||"/placeholder.svg",alt:"Flashcard visual",className:"w-full h-full object-cover"})}),(0,b.jsx)("div",{className:"text-3xl font-bold text-foreground",children:a||"Vietnamese text will appear here"}),d&&(0,b.jsx)("div",{className:"text-lg text-muted-foreground font-mono",children:d}),(0,b.jsxs)("div",{className:"flex justify-center gap-2 flex-wrap",children:[e&&(0,b.jsx)(w.Badge,{variant:"secondary",className:"capitalize",children:e}),f&&(0,b.jsx)(w.Badge,{variant:"outline",className:"capitalize",children:f.replace("-"," ")})]})]})})})}),(0,b.jsx)(v.motion.div,{style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:(0,b.jsx)(i.Card,{className:"h-full cursor-pointer transition-all duration-300 hover:shadow-lg",onClick:j,children:(0,b.jsx)(i.CardContent,{className:"h-full flex flex-col justify-center items-center p-8 text-center",children:(0,b.jsxs)("div",{className:"space-y-4 w-full",children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-foreground",children:c||"Your translation will appear here"}),a&&(0,b.jsx)("div",{className:"text-lg text-muted-foreground",children:a}),(0,b.jsxs)("div",{className:"flex justify-center gap-2 flex-wrap",children:[e&&(0,b.jsx)(w.Badge,{variant:"secondary",className:"capitalize",children:e}),f&&(0,b.jsx)(w.Badge,{variant:"outline",className:"capitalize",children:f.replace("-"," ")})]})]})})})})]}),(0,b.jsxs)("div",{className:"absolute bottom-4 right-4 text-xs text-muted-foreground bg-background/80 px-2 py-1 rounded",children:[h?"Back":"Front"," â€¢ Click to flip"]})]})}var y=a.i(405050),z=(0,y.createServerReference)("40df7fcce92212cb097847765ff160f9fc458fc66f",y.callServer,void 0,y.findSourceMapURL,"createFlashcard"),A=(0,y.createServerReference)("601ee54aa3ae234bd73dda91171672730ddb48c914",y.callServer,void 0,y.findSourceMapURL,"uploadFlashcardImage"),B=(0,y.createServerReference)("406bf430709870b36d9a7ac85feffe60d998327396",y.callServer,void 0,y.findSourceMapURL,"updateCustomFlashcard");function C({userId:a,initialData:l,onCancelEdit:v,onSuccess:w}){let y=(0,u.useRouter)(),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)({vietnamese:"",english:"",pronunciation:"",wordType:"",topic:"",imageFile:null,imageUrl:null}),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)("");(0,c.useEffect)(()=>{if(l)if(H({vietnamese:l.vietnamese_text||"",english:l.english_text||"",pronunciation:l.ipa_pronunciation||"",wordType:"",topic:l.topic||"",imageFile:null,imageUrl:l.image_url||null}),l.image_url){let{data:a}=(0,d.createClient)().storage.from("images").getPublicUrl(l.image_url);a?.publicUrl&&L(a.publicUrl)}else L("");else O()},[l]);let M=(a,b=20)=>{if(a.length<=b)return a;let c=a.split(".").pop()||"",d=a.slice(0,a.lastIndexOf(".")).slice(0,3)+"...";return`${d}${c?"."+c:""}`},N=(a,b)=>{H(c=>({...c,[a]:b}))},O=()=>{H({vietnamese:"",english:"",pronunciation:"",wordType:"",topic:"",imageFile:null,imageUrl:null}),L(""),J(!1)},P=async()=>{if(!G.vietnamese.trim())return void e.toast.error("Please enter Vietnamese text first");F(!0),console.log("ðŸ”Š Fetching IPA pronunciation...");try{let a=await fetch("https://vietnamesenext.onrender.com/api/v1/phoneme/ipa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:G.vietnamese.trim()})});if(!a.ok)throw Error(`Failed to fetch IPA: ${a.status} ${a.statusText}`);let b=await a.json();console.log("âœ… IPA pronunciation received:",b);let c=b.ipa||b.pronunciation||b.text||"";c?(H(a=>({...a,pronunciation:c})),e.toast.success("IPA pronunciation generated successfully!")):e.toast.error("No IPA pronunciation returned from API")}catch(b){console.error("âŒ Error fetching IPA:",b);let a=b instanceof Error?b.message:"Failed to fetch IPA pronunciation";e.toast.error(a)}finally{F(!1)}},Q=async()=>{if(!G.vietnamese.trim()||!G.english.trim())return void e.toast.error("Please enter both Vietnamese text and English translation");D(!0);try{let b=G.imageUrl;if(G.imageFile){console.log("ðŸ–¼ï¸ Uploading image...");let c=await A(G.imageFile,a);if(!c.success)throw Error(c.error||"Failed to upload image");b=c.url||null}if(l){console.log("ðŸ“ Updating flashcard...");let a=await B({id:l.id,vietnamese_text:G.vietnamese.trim(),english_text:G.english.trim(),ipa_pronunciation:G.pronunciation.trim()||null,image_url:b,topic:G.topic.trim()||null,notes:null});if(!a.success)throw Error(a.error||"Failed to update flashcard");e.toast.success("Flashcard updated successfully")}else{console.log("ðŸ’¾ Creating flashcard...");let a=await z({vietnamese_text:G.vietnamese.trim(),english_text:G.english.trim(),ipa_pronunciation:G.pronunciation.trim()||null,image_url:b,topic:G.topic.trim()||null,notes:null});if(!a.success)throw Error(a.error||"Failed to create flashcard");e.toast.success("Flashcard created successfully")}l||O(),w?.(),y.refresh()}catch(b){console.error("âŒ Error saving flashcard:",b);let a=b instanceof Error?b.message:"Failed to save flashcard";e.toast.error(a)}finally{D(!1)}};return(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,b.jsxs)(i.Card,{className:"h-fit border-2",children:[(0,b.jsxs)(i.CardHeader,{className:"pb-4",children:[(0,b.jsx)(i.CardTitle,{className:"flex items-center gap-2 text-lg",children:(0,b.jsx)("span",{children:l?"Edit Flashcard":"Create New Flashcard"})}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:l?"Update the details below":"Fill in the information to create your flashcard"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-5",children:[(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"vietnamese",className:"text-sm font-semibold text-foreground",children:"Vietnamese Text *"}),(0,b.jsx)(h.Textarea,{id:"vietnamese",placeholder:"Enter Vietnamese word or phrase...",value:G.vietnamese,onChange:a=>N("vietnamese",a.target.value),className:"min-h-[70px] resize-none border-2 focus:border-primary/50 transition-colors"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"english",className:"text-sm font-semibold text-foreground",children:"Translation *"}),(0,b.jsx)(h.Textarea,{id:"english",placeholder:"Enter translation...",value:G.english,onChange:a=>N("english",a.target.value),className:"min-h-[70px] resize-none border-2 focus:border-primary/50 transition-colors"})]})]})}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-foreground mb-3",children:"Additional Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-foreground",children:"Word Type"}),(0,b.jsxs)(j.Select,{value:G.wordType,onValueChange:a=>N("wordType",a),children:[(0,b.jsx)(j.SelectTrigger,{className:"border-2 focus:border-primary/50 transition-colors",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select type..."})}),(0,b.jsx)(j.SelectContent,{children:["Noun","Verb","Adjective","Adverb","Pronoun","Preposition","Conjunction","Interjection"].map(a=>(0,b.jsx)(j.SelectItem,{value:a.toLowerCase(),children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium text-foreground",children:"Topic"}),(0,b.jsxs)(j.Select,{value:G.topic,onValueChange:a=>N("topic",a),children:[(0,b.jsx)(j.SelectTrigger,{className:"border-2 focus:border-primary/50 transition-colors",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select topic..."})}),(0,b.jsx)(j.SelectContent,{children:["Food & Drink","Family","Travel","Work","Education","Health","Sports","Technology","Nature","Culture"].map(a=>(0,b.jsx)(j.SelectItem,{value:a.toLowerCase().replace(/\s+/g,"-"),children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(k.Label,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[(0,b.jsx)(m,{className:"w-4 h-4 text-muted-foreground"}),"Add Image",(0,b.jsx)("span",{className:"text-xs text-muted-foreground font-normal",children:"(Max 3MB)"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>3145728){e.toast.error(`Image size exceeds 3MB limit. Please choose a smaller image. (Current: ${(b.size/1024/1024).toFixed(2)}MB)`),a.target.value="";return}H(a=>({...a,imageFile:b}));let c=new FileReader;c.onload=a=>{L(a.target?.result)},c.readAsDataURL(b)}},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",id:"image-upload"}),(0,b.jsx)(f.Button,{type:"button",variant:"outline",className:"w-full border-2 focus:border-primary/50 transition-colors h-10 text-sm bg-transparent pointer-events-none",asChild:!0,children:(0,b.jsxs)("label",{htmlFor:"image-upload",className:"cursor-pointer flex items-center justify-center gap-2 pointer-events-auto",children:[(0,b.jsx)(m,{className:"w-4 h-4"}),G.imageFile?M(G.imageFile.name):"Choose file"]})})]}),(G.imageFile||G.imageUrl)&&(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>{H(a=>({...a,imageFile:null,imageUrl:null})),L("");let a=document.getElementById("image-upload");a&&(a.value="")},className:"h-10 w-10 text-destructive hover:text-destructive hover:bg-destructive/10 flex-shrink-0",title:"Remove image",children:(0,b.jsx)(r.X,{className:"w-4 h-4"})})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,b.jsxs)(k.Label,{htmlFor:"pronunciation",className:"text-sm font-medium text-foreground flex items-center gap-2",children:[(0,b.jsx)(n.Volume2,{className:"w-4 h-4 text-muted-foreground"}),"Pronunciation (IPA)"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Input,{id:"pronunciation",placeholder:"e.g., /ËˆvjÉ›t.nÉ‘m/",value:G.pronunciation,onChange:a=>N("pronunciation",a.target.value),className:"border-2 focus:border-primary/50 transition-colors font-mono flex-1"}),(0,b.jsx)(f.Button,{type:"button",variant:"outline",size:"icon",onClick:P,disabled:E||!G.vietnamese.trim(),className:"h-10 w-10 flex-shrink-0",title:"Generate IPA pronunciation",children:(0,b.jsx)(s.Sparkles,{className:`w-4 h-4 ${E?"animate-spin":""}`})})]})]})]}),(0,b.jsx)("div",{className:"border-t pt-5",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{O(),v?.()},disabled:C,className:"flex-1 h-11 font-medium",children:[l?(0,b.jsx)(r.X,{className:"w-4 h-4 mr-2"}):(0,b.jsx)(o.RotateCcw,{className:"w-4 h-4 mr-2"}),l?"Cancel Edit":"Reset"]}),(0,b.jsxs)(f.Button,{onClick:Q,disabled:C||!G.vietnamese||!G.english,className:"flex-1 h-11 font-medium",children:[l?(0,b.jsx)(t,{className:"w-4 h-4 mr-2"}):(0,b.jsx)(p.Plus,{className:"w-4 h-4 mr-2"}),C?l?"Updating...":"Creating...":l?"Update Flashcard":"Create & Add More"]})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Live Preview"}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>J(!I),className:"flex items-center gap-2 transition-transform duration-300",children:[(0,b.jsx)(q.RefreshCw,{className:`w-4 h-4 transition-transform duration-500 ${I?"[transform:rotateY(180deg)]":""}`}),"  Flip"]})]}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)(x,{vietnamese:G.vietnamese,english:G.english,pronunciation:G.pronunciation,wordType:G.wordType,topic:G.topic,imagePreview:K,isFlipped:I,onFlip:()=>J(!I)})}),(0,b.jsx)(i.Card,{className:"bg-muted/50",children:(0,b.jsxs)(i.CardContent,{className:"p-4",children:[(0,b.jsx)("h3",{className:"font-medium mb-2",children:"Card Information"}),(0,b.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{children:["Vietnamese: ",G.vietnamese||"Not set"]}),(0,b.jsxs)("div",{children:["Translation: ",G.english||"Not set"]}),(0,b.jsxs)("div",{children:["Pronunciation: ",G.pronunciation||"Not set"]}),(0,b.jsxs)("div",{children:["Type: ",G.wordType||"Not set"]}),(0,b.jsxs)("div",{children:["Topic: ",G.topic?G.topic.replace("-"," "):"Not set"]}),(0,b.jsxs)("div",{children:["Image: ",G.imageFile?M(G.imageFile.name):G.imageUrl?"Set (Existing)":"Not set"]})]})]})})]})]})}var D=a.i(596221),E=a.i(781560),F=a.i(533441),G=(0,y.createServerReference)("404db174e64fde8dc83f3aecc37e4914f00496bceb",y.callServer,void 0,y.findSourceMapURL,"deleteCustomFlashcard"),H=a.i(16116);function I({flashcards:a,selectedId:d,onSelect:g,onRefresh:h}){let[j,k]=(0,c.useState)(null),l=async(a,b)=>{if(a.stopPropagation(),confirm("Are you sure you want to delete this flashcard? This action cannot be undone."))try{k(b);let a=await G(b);a.success?(e.toast.success("Flashcard deleted successfully"),h()):e.toast.error(a.error||"Failed to delete flashcard")}catch(a){console.error("Error deleting flashcard:",a),e.toast.error("Failed to delete flashcard")}finally{k(null)}};return 0===a.length?(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:(0,b.jsx)("p",{children:"No flashcards created yet. Create your first flashcard above!"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold",children:"Your Flashcards"}),(0,b.jsxs)(w.Badge,{variant:"secondary",children:[a.length," ",1===a.length?"flashcard":"flashcards"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(a=>{let c=d===a.id;return(0,b.jsxs)(i.Card,{className:(0,H.cn)("relative cursor-pointer transition-all hover:shadow-md",c?"ring-2 ring-primary border-primary/50 bg-primary/5":"hover:border-primary/30"),onClick:()=>g(a),children:[c&&(0,b.jsx)("div",{className:"absolute -top-2 -right-2 bg-primary text-primary-foreground rounded-full p-1 shadow-sm z-10",children:(0,b.jsx)(F.Check,{className:"w-3 h-3"})}),(0,b.jsxs)("div",{className:"p-4 flex flex-col h-full",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"font-bold text-lg truncate",title:a.vietnamese_text,children:a.vietnamese_text}),(0,b.jsx)("div",{className:"flex gap-1 shrink-0",children:(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive hover:bg-destructive/10",onClick:b=>l(b,a.id),disabled:j===a.id,title:"Delete flashcard",children:j===a.id?(0,b.jsx)(D.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(E.Trash2,{className:"w-4 h-4"})})})]}),a.ipa_pronunciation&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground font-mono mb-2",children:["/",a.ipa_pronunciation,"/"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-auto",children:a.english_text}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[a.topic&&(0,b.jsx)(w.Badge,{variant:"outline",className:"text-[10px] h-5",children:a.topic.replace("-"," ")}),(0,b.jsx)(w.Badge,{variant:"secondary",className:"text-[10px] h-5",children:"lesson"===a.source_type?"From Lesson":"Manual"})]})]})]},a.id)})})]})}function J({userId:a}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(null),l=(0,c.useCallback)(async()=>{try{i(!0);let b=(0,d.createClient)(),{data:c,error:e}=await b.from("custom_flashcards").select("*").eq("user_id",a).eq("status","ACTIVE").order("created_at",{ascending:!1});if(e)throw e;g(c||[])}catch(a){console.error("Error fetching flashcards:",a),e.toast.error("Failed to load flashcards")}finally{i(!1)}},[a]);return((0,c.useEffect)(()=>{l()},[l]),h)?(0,b.jsx)("div",{className:"flex items-center justify-center py-12 min-h-screen",children:(0,b.jsx)(D.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,b.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(C,{userId:a,initialData:j,onCancelEdit:()=>{k(null)},onSuccess:()=>{l(),k(null)}}),(0,b.jsx)("div",{className:"border-t pt-8",children:(0,b.jsx)(I,{flashcards:f,selectedId:j?.id||null,onSelect:a=>{k(a),window.scrollTo({top:0,behavior:"smooth"})},onRefresh:l})})]})})}}];

//# sourceMappingURL=features_flashcards_components_create_FlashcardsPageClient_tsx_a038defb._.js.map