module.exports=[78769,a=>{"use strict";function b(a,b,c){let d=c.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^\w\-_]/g,"").replace(/_+/g,"_").replace(/^_|_$/g,"");return`t${a}-l${b}-${d}`}function c(a){return/^t\d+-l\d+-[\w\-_]+$/.test(a)}a.s(["generateVocabKey",()=>b,"isValidVocabKey",()=>c])},193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},262212,a=>{a.n(a.i(866114))},810162,a=>{a.n(a.i(281745))},535707,a=>{"use strict";a.s(["406d84cb44c4981a664e2476a59d980e60874605ab",()=>h,"40986aecbd86e0e666ca6f9c7e3044898795a258da",()=>i,"40a12d3392f5f7e3fd35f464eebcfef7da83f3293b",()=>k.unsaveVocabularyFromLesson,"40b7874b5beee18e2e913212052e9efd3061f9459a",()=>j.saveVocabularyFromLesson],535707),a.s([],30081);var b=a.i(707685),c=a.i(420861),d=a.i(137936),e=a.i(142238),f=a.i(118558),g=a.i(713095);async function h(a){try{if(console.log("ðŸ—‘ï¸ [Server Action] deleteCustomFlashcard called:",a),!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(console.log("ðŸ‘¤ [Server Action] User authentication:",{authenticated:!!c,userId:c?.id}),d||!c)return{success:!1,error:"Not authenticated - please log in first"};console.log("ðŸ—‘ï¸ [Server Action] Deleting from saved_flashcards...");let{error:g}=await b.from("saved_flashcards").delete().eq("flashcard_id",`custom_${a}`).eq("UserID",c.id).eq("flashcard_type","CUSTOM");g?console.error("âŒ [Server Action] Error deleting from saved_flashcards:",g):console.log("âœ… [Server Action] Deleted from saved_flashcards"),console.log("ðŸ—‘ï¸ [Server Action] Deleting from custom_flashcards...");let{error:h}=await b.from("custom_flashcards").delete().eq("id",a).eq("user_id",c.id);if(h)return console.error("âŒ [Server Action] Error deleting from custom_flashcards:",h),{success:!1,error:h.message||"Failed to delete flashcard"};return console.log("âœ… [Server Action] Successfully deleted custom flashcard"),(0,f.revalidatePath)("/flashcards/saved"),{success:!0}}catch(a){return console.error("âŒ [Server Action] Error deleting flashcard:",a),{success:!1,error:a instanceof Error?a.message:"Failed to delete flashcard"}}}async function i(a){try{if(console.log("ðŸ—‘ï¸ [Server Action] unsaveAppFlashcard called:",a),!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(console.log("ðŸ‘¤ [Server Action] User authentication:",{authenticated:!!c,userId:c?.id}),d||!c)return{success:!1,error:"Not authenticated - please log in first"};console.log("ðŸ—‘ï¸ [Server Action] Deleting from saved_flashcards...");let{error:g}=await b.from("saved_flashcards").delete().eq("id",a).eq("UserID",c.id);if(g)return console.error("âŒ [Server Action] Error unsaving flashcard:",g),{success:!1,error:g.message||"Failed to unsave flashcard"};return console.log("âœ… [Server Action] Successfully unsaved APP flashcard"),(0,f.revalidatePath)("/flashcards/saved"),{success:!0}}catch(a){return console.error("âŒ [Server Action] Error unsaving flashcard:",a),{success:!1,error:a instanceof Error?a.message:"Failed to unsave flashcard"}}}(0,g.ensureServerEntryExports)([h]),(0,d.registerServerReference)(h,"406d84cb44c4981a664e2476a59d980e60874605ab",null),(0,g.ensureServerEntryExports)([i]),(0,d.registerServerReference)(i,"40986aecbd86e0e666ca6f9c7e3044898795a258da",null),a.i(30081);var j=b,k=c},184892,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(211857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/features/flashcards/components/saved/SavedFlashcardsContainer.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/features/flashcards/components/saved/SavedFlashcardsContainer.tsx <module evaluation>","default")},524693,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(211857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/features/flashcards/components/saved/SavedFlashcardsContainer.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/features/flashcards/components/saved/SavedFlashcardsContainer.tsx","default")},582353,a=>{"use strict";a.i(184892);var b=a.i(524693);a.n(b)},533764,a=>{"use strict";a.s(["default",()=>s,"dynamic",()=>r],533764);var b=a.i(907997),c=a.i(800717);a.i(570396);var d=a.i(673727),e=a.i(142238);a.i(342537);var f=a.i(519673);function g(){return(0,f.createBrowserClient)("https://uavvljncupscxoxofcvp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVhdnZsam5jdXBzY3hveG9mY3ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ1MDk4NjAsImV4cCI6MjA2MDA4NTg2MH0.1ym2TlBf6_orJS3TgFxaMIeAHOGQsElaEjwRGRV_9U8",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"vietnamese-learning-app"}}})}async function h(a){let b=g(),{data:c,error:d}=await b.from("custom_flashcards").select("id").eq("user_id",a).eq("status","ACTIVE");if(d)return console.error("Error fetching custom flashcards:",d),{needsSync:!1,unsyncedCount:0};let e=(c||[]).map(a=>`custom_${a.id}`);if(0===e.length)return{needsSync:!1,unsyncedCount:0};let{data:f,error:h}=await b.from("saved_flashcards").select("flashcard_id").eq("UserID",a).eq("flashcard_type","CUSTOM").in("flashcard_id",e);if(h)return console.error("Error fetching saved custom flashcards:",h),{needsSync:!1,unsyncedCount:0};let i=new Set((f||[]).map(a=>a.flashcard_id)),j=e.filter(a=>!i.has(a));return{needsSync:j.length>0,unsyncedCount:j.length}}g();var i=a.i(78769);async function j(a){if(0===a.length)return[];try{console.log("ðŸŒ [Server] Fetching APP flashcard details from FastAPI for",a.length,"flashcards");let b=await fetch("https://vietnamesenext.onrender.com/api/v1/flashcards/by-ids",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(8e3)});if(!b.ok)throw Error(`FastAPI request failed: ${b.statusText}`);let c=await b.json();if(console.log("âœ… [Server] Successfully fetched APP flashcard details:",Array.isArray(c)?c.length:"not array"),!Array.isArray(c))return console.warn("âš ï¸ [Server] API response is not an array, wrapping:",c),[c].filter(Boolean);return c}catch(a){return console.error("âŒ [Server] Error fetching APP flashcard details:",a),[]}}async function k(a,b,c){if(0===c.length)return[];try{let{data:d,error:e}=await a.from("custom_flashcards").select("id, vocab_key, vietnamese_text, english_text, image_url, topic, ipa_pronunciation, audio_url, source_type").eq("user_id",b).eq("status","ACTIVE").in("id",c);if(e)throw e;return d||[]}catch(a){return console.error("âŒ [Server] Error fetching custom flashcard details by ID:",a),[]}}async function l(a,b,c){if(0===c.length)return[];try{let{data:d,error:e}=await a.from("custom_flashcards").select("id, vocab_key, vietnamese_text, english_text, image_url, topic, ipa_pronunciation, audio_url, source_type").eq("user_id",b).eq("status","ACTIVE").in("vocab_key",c);if(e)throw e;return d||[]}catch(a){return console.error("âŒ [Server] Error fetching custom flashcard details by vocab_key:",a),[]}}async function m(a,b){try{let{data:c,error:d}=await a.from("saved_flashcards").select("flashcard_type").eq("UserID",b);if(d)throw d;let e=(c||[]).filter(a=>"APP"===a.flashcard_type).length,f=(c||[]).filter(a=>"CUSTOM"===a.flashcard_type).length,{data:g,error:h}=await a.from("user_profiles").select("subscription_type").eq("id",b).single();h&&console.warn("âš ï¸ [Server] Could not fetch subscription type:",h);let i=g?.subscription_type||"FREE";return{appFlashcards:e,customFlashcards:f,subscription_type:i}}catch(a){return console.error("âŒ [Server] Error fetching user stats:",a),{appFlashcards:0,customFlashcards:0,subscription_type:"FREE"}}}async function n(a,b){try{console.log("ðŸ” [Server] Fetching topics for user:",b);let{data:c,error:d}=await a.from("custom_flashcards").select("topic").eq("user_id",b).eq("status","ACTIVE").not("topic","is",null);if(d)throw console.error("âŒ [Server] Supabase error fetching topics:",d),d;if(console.log("ðŸ“Š [Server] Topics data from Supabase:",c),!c||0===c.length)return console.log("â„¹ï¸ [Server] No topics found for user"),[];let e=[...new Set(c.map(a=>a.topic).filter(Boolean))];return console.log("âœ… [Server] Unique topics extracted:",e),e.map((a,b)=>({id:a,name:a,description:null,icon:null,sort_order:b}))}catch(a){return console.error("âŒ [Server] Error fetching topics:",a),[]}}async function o(a,b){try{let{data:c,error:d}=await a.from("saved_flashcards").select("*").eq("UserID",b).order("saved_at",{ascending:!1}).limit(100);if(d)throw d;if(!c||0===c.length)return[];console.log("ðŸ“Š [Server] Fetched saved flashcards:",c.length);let e=c.filter(a=>"APP"===a.flashcard_type).map(a=>a.flashcard_id),f=[],g=[];c.filter(a=>"CUSTOM"===a.flashcard_type).forEach(a=>{let b=a.flashcard_id;if((0,i.isValidVocabKey)(b))g.push(b);else{let a=b.replace("custom_","");a&&f.push(a)}}),console.log("ðŸ” [Server] APP flashcard IDs:",e.length),console.log("ðŸ” [Server] CUSTOM flashcard IDs (UUID):",f.length),console.log("ðŸ” [Server] CUSTOM flashcard IDs (vocab_key):",g.length);let[h,m,n]=await Promise.all([j(e),f.length>0?k(a,b,f):Promise.resolve([]),g.length>0?l(a,b,g):Promise.resolve([])]),o=[...m,...n],p=c.map(a=>{if("APP"===a.flashcard_type){let b=h.find(b=>b.id===a.flashcard_id);return{...a,vietnamese:b?.vietnamese||`App Card ${a.flashcard_id?.slice(-4)||"N/A"}`,english:Array.isArray(b?.english)?b.english:b?.english?[b.english]:["No translation available"],image_url:b?.image_url||"/placeholder.svg",word_type:b?.type||b?.word_type||"word",audio_url:b?.audio_url||void 0,pronunciation:b?.pronunciation||void 0}}{let b,c=a.flashcard_id;if((0,i.isValidVocabKey)(c))b=o.find(a=>a.vocab_key===c);else{let a=c.replace("custom_","");b=o.find(b=>b.id===a)}let d="/placeholder.svg";if(b?.image_url)if(b.image_url.startsWith("http"))d=b.image_url;else{let a=b.image_url.startsWith("/")?b.image_url.slice(1):b.image_url;d=`https://uavvljncupscxoxofcvp.supabase.co/storage/v1/object/public/images/${a}`}let e=b?.id||c.slice(-4);return{...a,vietnamese_text:b?.vietnamese_text||`Custom Card ${e}`,english_text:b?.english_text||"No translation available",image_url:d,topic:b?.topic||a.topic,ipa_pronunciation:b?.ipa_pronunciation||null,source_type:b?.source_type||"user",audio_url:b?.audio_url||null}}});return console.log("âœ… [Server] Processed saved flashcards with details:",p.length),p}catch(a){throw console.error("âŒ [Server] Error fetching saved flashcards:",a),a}}async function p(){try{console.log("ðŸš€ [Server] Starting loadSavedFlashcardsData...");let a=await (0,e.createClient)(),{data:{user:b},error:c}=await a.auth.getUser();if(c||!b)return console.error("âŒ [Server] User not authenticated:",c),null;console.log("ðŸ‘¤ [Server] User authenticated:",b.id);let[d,f,g,i]=await Promise.all([o(a,b.id),m(a,b.id),n(a,b.id),h(b.id).catch(a=>(console.error("âŒ [Server] Error checking sync status:",a),null))]);return console.log("âœ… [Server] All data fetched successfully"),console.log("ðŸ“Š [Server] Stats:",{flashcards:d.length,appCards:f.appFlashcards,customCards:f.customFlashcards,topics:g.length,syncNeeded:i?.needsSync}),{savedFlashcards:d,userStats:f,topics:g,syncStatus:i,userId:b.id}}catch(a){throw console.error("âŒ [Server] Error in loadSavedFlashcardsData:",a),a}}var q=a.i(582353);let r="force-dynamic";async function s(){let a=await p();return a||(0,d.redirect)("/auth/login"),(0,b.jsx)(c.Suspense,{fallback:(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-sm mb-4",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-16 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-4 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-20 animate-pulse"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"h-8 w-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-48 mb-2 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-64 animate-pulse"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-24 animate-pulse"}),(0,b.jsx)("div",{className:"h-10 bg-blue-200 dark:bg-blue-800 rounded w-32 animate-pulse"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),(0,b.jsx)("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]}),(0,b.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),(0,b.jsx)("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded mb-6 animate-pulse"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Array.from({length:8}).map((a,c)=>(0,b.jsx)("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"},c))})]}),children:(0,b.jsx)(q.default,{initialData:a})})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1334e6e6._.js.map