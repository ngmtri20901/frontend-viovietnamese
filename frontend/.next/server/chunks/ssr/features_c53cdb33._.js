module.exports=[319408,a=>{"use strict";a.s(["useDisplaySettings",()=>v],319408);var b=a.i(433217),c=a.i(572131),d=a.i(612794),e=a.i(118544),f=a.i(533791),g=a.i(442871),h=class extends f.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,g.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,g.hashKey)(b.mutationKey)!==(0,g.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,d.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){e.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},i=a.i(937927),j=a.i(823292),k=a.i(255895);let l={display:{flashcardAnimationSpeed:"normal",muteSounds:!1,soundVolume:75,reviewTimeSeconds:4,language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",keyboardNavigation:!0,focusIndicators:!0},notifications:{email:{dailyReminders:!1,weeklyProgress:!1,achievements:!1,questUpdates:!1,marketingEmails:!1},push:{studyReminders:!1,streakReminders:!1,achievements:!1,questUpdates:!1,flashcardReviews:!1},inApp:{sounds:!0,popups:!0,achievements:!0,levelUps:!0},studyReminders:{enabled:!1,dailyGoal:!1,weeklyGoal:!1,streakMaintenance:!1}},privacy:{dataCollection:!0,analyticsTracking:!0,crashReporting:!0,marketingCommunications:!1,sessionTimeout:"30",passwordChangeNotifications:!0}};function m(a){try{return{display:a.display||l.display,notifications:a.notifications||l.notifications,privacy:a.privacy||l.privacy}}catch{return l}}let n={all:["user-settings"],detail:a=>[...n.all,"detail",a],category:(a,b)=>[...n.all,b,a]},o=async()=>{let{data:{user:a},error:b}=await k.supabase.auth.getUser();if(b||!a)throw Error("User not authenticated");return a.id},p=async()=>{let a=await o(),{data:b,error:c}=await k.supabase.from("user_settings").select("settings").eq("user_id",a).single();if(c){if("PGRST116"===c.code)return l;throw Error(`Failed to fetch user settings: ${c.message}`)}let d=function(a){try{let b="string"==typeof a?JSON.parse(a):a,c=m(b);return{success:!0,data:c}}catch(a){return{success:!1,error:a instanceof Error?a:Error("Failed to parse settings")}}}(b.settings);return d.success?d.data:(console.warn("Invalid settings from database, using defaults:",d.error),l)},q=async a=>{let b=await o(),c=m(a),{error:d}=await k.supabase.from("user_settings").upsert({user_id:b,settings:c,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(d)throw Error(`Failed to save user settings: ${d.message}`)},r=(a,b)=>JSON.stringify(a)===JSON.stringify(b),s={slow:750,normal:500,fast:250},t={min:2,max:8,default:4},u={min:0,max:100,default:75,step:5},v=()=>{let{settings:a,savedSettings:d,updateDisplaySetting:f,updateDisplaySettings:k,saveSettings:m,discardChanges:o,resetToDefaults:v,hasUnsavedChanges:w,isSaving:x}=(()=>{let{settings:a,savedSettings:d,updateDraftCategory:f,updateDraftSetting:k,saveSettings:m,discardChanges:o,resetToDefaults:s,hasUnsavedChanges:t,isSaving:u}=(()=>{let a=(0,i.useQueryClient)(),[d,f]=(0,c.useState)(null),k=(0,b.useQuery)({queryKey:n.all,queryFn:p,staleTime:3e5,gcTime:6e5,retry:(a,b)=>!b.message.includes("not authenticated")&&a<3}),m=k.data??l,o=d??m,s=null!==d&&!r(d,m);(0,c.useEffect)(()=>{k.data&&d&&r(d,k.data)&&f(null)},[k.data,d]);let t=function(a,b){let d=(0,i.useQueryClient)(void 0),[f]=c.useState(()=>new h(d,a));c.useEffect(()=>{f.setOptions(a)},[f,a]);let j=c.useSyncExternalStore(c.useCallback(a=>f.subscribe(e.notifyManager.batchCalls(a)),[f]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),k=c.useCallback((a,b)=>{f.mutate(a,b).catch(g.noop)},[f]);if(j.error&&(0,g.shouldThrowError)(f.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}({mutationFn:q,onMutate:async b=>{await a.cancelQueries({queryKey:n.all});let c=a.getQueryData(n.all);return a.setQueryData(n.all,b),{previousSettings:c}},onError:(b,c,d)=>{d?.previousSettings&&a.setQueryData(n.all,d.previousSettings),j.toast.error("Failed to save settings"),console.error("Settings save error:",b)},onSuccess:()=>{f(null),j.toast.success("Settings saved successfully")},onSettled:()=>{a.invalidateQueries({queryKey:n.all})}}),u=(0,c.useCallback)((a,b,c)=>{let e=d??m;f({...e,[a]:{...e[a],[b]:c}})},[d,m]),v=(0,c.useCallback)((a,b)=>{f({...d??m,[a]:b})},[d,m]),w=(0,c.useCallback)(a=>{let b=a??o;return new Promise((a,c)=>{t.mutate(b,{onSuccess:()=>{a()},onError:a=>{c(a)}})})},[o,t]),x=(0,c.useCallback)(()=>{f(null)},[]),y=(0,c.useCallback)(()=>{f(l)},[]);return{settings:o,savedSettings:m,isLoading:k.isLoading,isError:k.isError,error:k.error,hasUnsavedChanges:s,draftSettings:d,saveSettings:w,updateDraftSetting:u,updateDraftCategory:v,discardChanges:x,resetToDefaults:y,isSaving:t.isPending}})();return{settings:a.display,savedSettings:d.display,updateDisplaySettings:a=>f("display",a),updateDisplaySetting:(a,b)=>k("display",a,b),saveSettings:()=>m(),discardChanges:o,resetToDefaults:s,hasUnsavedChanges:t,isSaving:u}})(),y=(a,b)=>{f(a,b)},z=()=>{let{min:b,max:c}=u;return Math.max(b,Math.min(c,a.soundVolume))};return{settings:a,savedSettings:d,updateSetting:y,updateMultipleSettings:b=>{k({...a,...b})},resetSettings:()=>{v()},saveSettings:()=>{m()},discardSettings:()=>{o()},hasUnsavedChanges:w,isLoaded:!0,isSaving:x,getAnimationDuration:()=>s[a.flashcardAnimationSpeed],getReviewTimeSeconds:()=>{let{min:b,max:c}=t;return Math.max(b,Math.min(c,a.reviewTimeSeconds))},updateReviewTime:a=>{let{min:b,max:c}=t;y("reviewTimeSeconds",Math.max(b,Math.min(c,a)))},getSoundVolume:z,updateSoundVolume:a=>{let{min:b,max:c}=u;y("soundVolume",Math.max(b,Math.min(c,a)))},areSoundEffectsDisabled:()=>a.muteSounds||0===a.soundVolume,getEffectiveVolume:()=>a.muteSounds?0:z(),getPronunciationVolume:()=>z(),toggleMute:()=>{y("muteSounds",!a.muteSounds)}}}},11221,257394,979472,a=>{"use strict";a.s(["FlashcardFront",()=>l],11221);var b=a.i(187924),c=a.i(572131),d=a.i(212439),e=a.i(438617);a.s(["BookmarkCheck",()=>f],257394);let f=(0,a.i(883706).default)("bookmark-check",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);var g=a.i(57703),h=a.i(214549),i=a.i(419499),j=a.i(350669),k=a.i(945682);function l({data:a,saved:l,onSave:m}){var n;let[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),s=async()=>{if(!q){r(!0);try{a.audio_url&&"APP"===a.flashcard_type?(console.log("Playing APP flashcard audio:",a.audio_url),await k.audioManager.playPronunciation(a.audio_url)):"CUSTOM"===a.flashcard_type?(console.log("Playing CUSTOM flashcard audio for:",a.vietnamese),await playCustomFlashcardAudio(a.id,a.vietnamese)):a.audio_url?(console.log("Playing fallback audio:",a.audio_url),await k.audioManager.playPronunciation(a.audio_url)):console.log("No audio available for:",a.vietnamese)}catch(a){console.error("Failed to play audio:",a)}finally{r(!1)}}};return Array.isArray(a.english)?a.english[0]:a.english,(0,b.jsxs)("div",{className:"w-full max-w-2xl mx-auto bg-white rounded-3xl p-8 shadow-lg border border-gray-200",children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),console.log("Save button clicked for card:",a.id);try{m(a.id)}catch(a){console.error("Error saving flashcard:",a)}},className:"p-2 hover:bg-gray-100",children:l?(0,b.jsx)(f,{className:"h-5 w-5 text-blue-600"}):(0,b.jsx)(e.Bookmark,{className:"h-5 w-5 text-gray-500"})})}),(0,b.jsxs)("div",{className:"flex gap-8 h-full",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:a.image_url?(0,b.jsx)("img",{src:a.image_url,alt:a.vietnamese,className:"w-48 h-48 object-cover rounded-xl border-2 border-gray-200",loading:"lazy",onError:a=>{a.target.src="/placeholder.svg"}}):(0,b.jsx)("div",{className:"w-48 h-48 bg-gray-100 rounded-xl border-2 border-gray-200 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center text-gray-400",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ“š"}),(0,b.jsx)("div",{className:"text-sm",children:"No image"})]})})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col justify-center space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("h2",{className:"text-4xl font-bold text-gray-800",children:a.vietnamese}),a.pronunciation&&(0,b.jsxs)("p",{className:"text-lg text-gray-500 mt-1 font-mono",children:["/",a.pronunciation,"/"]})]}),(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),s()},className:`p-3 hover:bg-gray-100 rounded-full ${q?"animate-pulse bg-blue-100":""}`,disabled:q,title:q?"Playing audio...":"Play pronunciation",children:(0,b.jsx)(d.Volume2,{className:`h-6 w-6 ${q?"text-blue-700":"text-blue-600"}`})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Badge,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:Array.isArray(n=a.type)?n.join(", "):n}),a.is_multimeaning&&(0,b.jsx)(i.Badge,{variant:"outline",className:"text-purple-600 border-purple-300",children:"Multi-meaning"})]}),a.vietnamese_sentence?(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Example sentence:"}),(0,b.jsxs)("p",{className:"text-md md:text-lg text-gray-700 italic",children:[(0,b.jsx)("span",{className:"text-gray-400",children:'"'}),((a,c)=>{let d;if(!a||!c)return a;let e=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");try{d=RegExp(`(?<!\\p{L})(${e})(?!\\p{L})`,"giu")}catch{d=RegExp(`(${e})`,"gi")}let f=[],g=0;for(let c of a.matchAll(d)){let d=c.index??0,e=d+c[0].length;d>g&&f.push(a.slice(g,d)),f.push((0,b.jsx)("mark",{className:"rounded-md px-1 bg-amber-200/70 text-gray-900 ring-1 ring-amber-300 underline decoration-amber-500/50 decoration-2 underline-offset-2",children:c[0]},`hl-${d}`)),g=e}return 0===g?a:(g<a.length&&f.push(a.slice(g)),f)})(a.vietnamese_sentence,a.vietnamese),(0,b.jsx)("span",{className:"text-gray-400",children:'"'})]}),a.english_sentence&&(0,b.jsx)("div",{className:"flex items-center gap-1 mt-1",children:(0,b.jsx)(j.TooltipProvider,{children:(0,b.jsxs)(j.Tooltip,{children:[(0,b.jsx)(j.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(h.Button,{variant:"ghost",size:"icon",className:"p-1 h-auto text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-full","aria-label":"Xem dá»‹ch cÃ¢u vÃ­ dá»¥",children:(0,b.jsx)(g.TbMessageLanguage,{className:"h-4 w-4"})})}),(0,b.jsx)(j.TooltipContent,{side:"bottom",align:"start",children:(0,b.jsxs)("p",{className:"text-sm text-gray-700 italic",children:['"',a.english_sentence,'"']})})]})})})]}):(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Example sentence:"}),(0,b.jsx)("p",{className:"text-md md:text-lg text-gray-400 italic",children:"No example sentence available"})]})]})]})]})}a.s(["FlashcardBack",()=>n],979472);var m=a.i(45748);function n({data:a,saved:c,onSave:d}){let g=a.english?a.english.filter(b=>b!==a.common_meaning):[];return(0,b.jsxs)("div",{className:"w-full h-full bg-white rounded-3xl p-6 shadow-lg border border-gray-200 flex flex-col",children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),console.log("Save button clicked for card:",a.id);try{d(a.id)}catch(a){console.error("Error saving flashcard:",a)}},className:"p-2 hover:bg-gray-100",children:c?(0,b.jsx)(f,{className:"h-5 w-5 text-green-600"}):(0,b.jsx)(e.Bookmark,{className:"h-5 w-5 text-gray-500"})})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col space-y-6 min-h-0",children:[(0,b.jsxs)("div",{className:"flex-shrink-0",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Primary Meaning"}),(0,b.jsx)("p",{className:"text-2xl font-medium text-green-700 bg-green-50 rounded-lg p-4 border border-green-200",children:a.common_meaning||(a.english&&a.english.length>0?a.english[0]:"No translation available")}),"CUSTOM"===a.flashcard_type&&a.ipa_pronunciation&&(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsxs)("p",{className:"text-sm text-gray-600 italic",children:["IPA: ",(0,b.jsx)("span",{className:"font-mono text-blue-600",children:a.ipa_pronunciation})]})})]}),g&&g.length>0&&(0,b.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,b.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 mb-3 flex-shrink-0",children:["Other Meanings (",g.length,")"]}),(0,b.jsx)(m.ScrollArea,{className:"flex-1 max-h-48 rounded-lg border border-gray-200 bg-gray-50 p-3",children:(0,b.jsx)("div",{className:"space-y-3",children:g.map((a,c)=>(0,b.jsxs)("p",{className:"text-base text-gray-700 bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:["â€¢ ",a]},c))})})]})]})]})}},817249,a=>{"use strict";a.s(["FlashcardComponent",()=>m]);var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(521520),f=a.i(901299),g=a.i(262036),h=a.i(11221),i=a.i(979472),j=a.i(319408),k=a.i(945682);function l({data:a,saved:g,onSave:j,onFlip:l,isFlipped:m,frontCard:n,index:o,setIndex:p,drag:q,animationDuration:r=500}){let[s,t]=(0,c.useState)(0),u=(0,e.useMotionValue)(0),v=(0,f.useTransform)(u,[-150,0,150],[.5,1,.5]),w=(0,f.useTransform)(u,[-150,0,150],[-45,0,45],{clamp:!1}),x=r/1e3;return(0,b.jsx)(d.motion.div,{style:{width:"100%",height:400,position:"absolute",top:0,x:u,rotate:w,cursor:"grab",pointerEvents:"auto"},whileTap:{cursor:"grabbing"},drag:q,dragConstraints:{top:0,right:0,bottom:0,left:0},onDragEnd:(a,b)=>{b.offset.x<-100&&(t(-250),p&&"number"==typeof o&&p(o+1)),b.offset.x>100&&(t(250),p&&"number"==typeof o&&p(o-1))},variants:n?{animate:{scale:1,y:0,opacity:1},exit:a=>({x:a,opacity:0,scale:.5,transition:{duration:.2}})}:{initial:{scale:0,y:105,opacity:0},animate:{scale:.75,y:30,opacity:.5}},initial:"initial",animate:"animate",exit:"exit",custom:s,transition:n?{type:"spring",stiffness:300,damping:20}:{scale:{duration:.2},opacity:{duration:.4}},onClick:a=>{!a.target.closest("button")&&5>Math.abs(u.get())&&l&&(a.preventDefault(),(0,k.playFlipSound)(),l())},children:(0,b.jsx)(d.motion.div,{style:{width:"100%",height:"100%",scale:v,perspective:"1000px"},children:(0,b.jsxs)("div",{className:`relative w-full h-full transform-style-preserve-3d ${m?"rotate-y-180":""}`,style:{transformStyle:"preserve-3d",transform:m?"rotateY(180deg)":"rotateY(0deg)",transition:`transform ${x}s ease-in-out`},children:[(0,b.jsx)("div",{className:`w-full h-full backface-hidden ${m?"opacity-0 pointer-events-none":"opacity-100"}`,style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transition:`opacity ${x}s ease-in-out`},children:(0,b.jsx)(h.FlashcardFront,{data:a,saved:g,onSave:j})}),(0,b.jsx)("div",{className:`absolute inset-0 w-full h-full backface-hidden ${m?"opacity-100":"opacity-0 pointer-events-none"}`,style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transform:"rotateY(180deg)",transition:`opacity ${x}s ease-in-out`},children:(0,b.jsx)(i.FlashcardBack,{data:a,saved:g,onSave:j})})]})})})}function m({data:a,saved:e,onSave:f,onSwipe:h,onFlip:i,isFlipped:m=!1,animationDuration:n=500}){let[o,p]=(0,c.useState)(0),{settings:q}=(0,j.useDisplaySettings)();return(0,c.useEffect)(()=>{q&&k.audioManager.updateSettings(q)},[q]),(0,b.jsx)("div",{className:"w-full max-w-2xl mx-auto mb-8",children:(0,b.jsx)(d.motion.div,{style:{width:"100%",height:400,position:"relative",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",pointerEvents:"auto"},children:(0,b.jsxs)(g.AnimatePresence,{initial:!1,children:[(0,b.jsx)(l,{data:a,saved:e,onSave:f,onFlip:i,isFlipped:m,frontCard:!1,animationDuration:n},o+1),(0,b.jsx)(l,{data:a,saved:e,onSave:f,onFlip:i,isFlipped:m,frontCard:!0,index:o,setIndex:a=>{a>o&&h?h("left"):a<o&&h&&h("right"),p(a)},drag:"x",animationDuration:n},o)]})})})}}];

//# sourceMappingURL=features_c53cdb33._.js.map