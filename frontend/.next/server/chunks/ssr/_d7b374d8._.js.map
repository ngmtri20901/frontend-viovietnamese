{"version":3,"sources":["turbopack:///[project]/features/learn/components/exercises/ExerciseContainer.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/ChooseWords/choose-words.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/MCQ/multiple-choice-question.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/SynonymsMatching/synonyms-matching.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/WordsMatching/words-matching.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/dialogue/DialogueCompletion.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/dialogue/RolePlay.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/features/learn/components/exercises/writing/ErrorCorrection.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/app/(app)/learn/[topicSlug]/[lessonSlug]/exercise/page.tsx","turbopack:///[project]/features/learn/components/exercises/index.ts","turbopack:///[project]/features/learn/api/practice.ts"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ExerciseContainer = registerClientReference(\n    function() { throw new Error(\"Attempted to call ExerciseContainer() from the server but ExerciseContainer is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/ExerciseContainer.tsx\",\n    \"ExerciseContainer\",\n);\nexport const ExerciseContainerShell = registerClientReference(\n    function() { throw new Error(\"Attempted to call ExerciseContainerShell() from the server but ExerciseContainerShell is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/ExerciseContainer.tsx\",\n    \"ExerciseContainerShell\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ChooseWords = registerClientReference(\n    function() { throw new Error(\"Attempted to call ChooseWords() from the server but ChooseWords is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/ChooseWords/choose-words.tsx\",\n    \"ChooseWords\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const MultipleChoiceQuestion = registerClientReference(\n    function() { throw new Error(\"Attempted to call MultipleChoiceQuestion() from the server but MultipleChoiceQuestion is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/MCQ/multiple-choice-question.tsx\",\n    \"MultipleChoiceQuestion\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const SynonymsMatching = registerClientReference(\n    function() { throw new Error(\"Attempted to call SynonymsMatching() from the server but SynonymsMatching is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/SynonymsMatching/synonyms-matching.tsx\",\n    \"SynonymsMatching\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const WordsMatching = registerClientReference(\n    function() { throw new Error(\"Attempted to call WordsMatching() from the server but WordsMatching is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/WordsMatching/words-matching.tsx\",\n    \"WordsMatching\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DialogueCompletion = registerClientReference(\n    function() { throw new Error(\"Attempted to call DialogueCompletion() from the server but DialogueCompletion is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/dialogue/DialogueCompletion.tsx\",\n    \"DialogueCompletion\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const RolePlay = registerClientReference(\n    function() { throw new Error(\"Attempted to call RolePlay() from the server but RolePlay is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/dialogue/RolePlay.tsx\",\n    \"RolePlay\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ErrorCorrection = registerClientReference(\n    function() { throw new Error(\"Attempted to call ErrorCorrection() from the server but ErrorCorrection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/features/learn/components/exercises/writing/ErrorCorrection.tsx\",\n    \"ErrorCorrection\",\n);\n","import { cookies } from 'next/headers'\r\nimport { createServerClient } from '@supabase/ssr'\r\nimport { redirect } from 'next/navigation'\r\nimport { ExerciseContainerShell } from \"@/features/learn/components/exercises\"\r\nimport type { Exercise } from \"@/features/learn/types\"\r\nimport { getExerciseBySlugs, canAccessExercise } from '@/features/learn/api/practice'\r\n\r\nexport const revalidate = 1\r\n\r\nexport default async function ExercisePage(\r\n  props: { params: Promise<{ topicSlug: string; lessonSlug: string }> }\r\n) {\r\n  const cookieStore = await cookies()\r\n  const supabase = createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll()\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) =>\r\n              cookieStore.set(name, value, options)\r\n            )\r\n          } catch {\r\n            // Handle potential errors here\r\n          }\r\n        },\r\n      },\r\n    }\r\n  )\r\n  const { data: { session } } = await supabase.auth.getSession()\r\n\r\n  const { topicSlug, lessonSlug } = await props.params\r\n  const exercise: Exercise | null = await getExerciseBySlugs(topicSlug, lessonSlug)\r\n\r\n  if (!exercise) {\r\n    // Debug fallback instead of 404\r\n    return (\r\n      <div className=\"p-6 space-y-4\">\r\n        <h1 className=\"text-xl font-semibold\">Exercise Debug Mode</h1>\r\n        <p className=\"text-sm text-muted-foreground\">Không tìm thấy dữ liệu exercise nhưng tạm thời không chuyển sang 404 để debug.</p>\r\n        <div className=\"rounded bg-muted p-4 text-sm whitespace-pre-wrap\">\r\n          {`Slugs:\\n  topicSlug: ${topicSlug}\\n  lessonSlug: ${lessonSlug}`}\r\n        </div>\r\n        <p className=\"text-sm font-medium\">Gợi ý kiểm tra:</p>\r\n        <ul className=\"list-disc pl-6 text-sm space-y-1\">\r\n          <li>Lesson status phải = published</li>\r\n          <li>practice_sets có lesson_id đúng, is_active = true, status = ACTIVE</li>\r\n          <li>Có ít nhất 1 record trong practice_set_questions</li>\r\n        </ul>\r\n        <p className=\"text-xs text-muted-foreground\">Xem console server để thấy log từ getLessonIdsBySlugs / getActivePracticeSet / getQuestionsForSet.</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Check if user can access this exercise page\r\n  // Allows access if: first time (no sessions) OR has in-progress session\r\n  // Blocks access if: only has completed sessions (prevents back button to finished exercise)\r\n  if (session?.user?.id) {\r\n    const canAccess = await canAccessExercise(exercise.id, session.user.id)\r\n    if (!canAccess) {\r\n      console.log('[ExercisePage] Access denied - exercise already completed, redirecting to lesson page')\r\n      redirect(`/learn/${topicSlug}/${lessonSlug}`)\r\n    }\r\n  } else {\r\n    // No user session, redirect to lesson page\r\n    redirect(`/learn/${topicSlug}/${lessonSlug}`)\r\n  }\r\n\r\n  return <ExerciseContainerShell exercise={exercise} topicSlug={topicSlug} lessonSlug={lessonSlug} />\r\n}\r\n","// Exercise component exports\r\nexport * from './ExerciseContainer'\r\nexport * from './ChooseWords/choose-words'\r\nexport * from './MCQ/multiple-choice-question'\r\nexport * from './SynonymsMatching/synonyms-matching'\r\nexport * from './WordsMatching/words-matching'\r\nexport * from './dialogue/DialogueCompletion'\r\nexport * from './dialogue/RolePlay'\r\nexport * from './writing/ErrorCorrection'\r\n","import { createClient } from '@/shared/lib/supabase/server'\r\nimport type {\r\n  Exercise,\r\n  Question,\r\n  MultipleChoiceQuestion,\r\n  WordMatchingQuestion,\r\n  SynonymMatchingQuestion,\r\n  ChooseWordsQuestion,\r\n  ErrorCorrectionQuestion,\r\n  DialogueCompletionQuestion,\r\n  RolePlayQuestion,\r\n  BaseQuestion,\r\n  Choice,\r\n  WordPair,\r\n  SynonymPair,\r\n  ChooseWordsType,\r\n  MCQType\r\n} from '@/features/learn/types'\r\n\r\nasync function getLessonIdsBySlugs(\r\n  topicSlug: string,\r\n  lessonSlug: string\r\n): Promise<{ topic_id: number; lesson_id: number; zone_id: number; zone_level: number } | null> {\r\n  const supabase = await createClient()\r\n\r\n  // First get the topic with zone information\r\n  const { data: topicData, error: topicError } = await supabase\r\n    .from('topics')\r\n    .select(`\r\n      topic_id,\r\n      zone_id,\r\n      zones!inner (\r\n        level\r\n      )\r\n    `)\r\n    .eq('slug', topicSlug)\r\n    .single()\r\n\r\n  if (topicError || !topicData) {\r\n    console.error('[getLessonIdsBySlugs] Supabase error fetching topic', { error: topicError, topicSlug })\r\n    return null\r\n  }\r\n\r\n  // Then get the lesson\r\n  // Chain with loose typing to avoid query builder union type friction\r\n  const lessonQuery = (supabase\r\n    .from('lessons')\r\n    .select('id, slug, status') as any)\r\n    .eq('topic_id', topicData.topic_id)\r\n    .eq('slug', lessonSlug)\r\n    .eq('status', 'published')\r\n    .maybeSingle()\r\n\r\n  const { data: lessonData, error: lessonError } = await lessonQuery\r\n\r\n  if (lessonError || !lessonData) {\r\n    console.error('[getLessonIdsBySlugs] Supabase error fetching lesson', { error: lessonError, lessonSlug, topic_id: topicData.topic_id })\r\n    return null\r\n  }\r\n\r\n  console.log('[getLessonIdsBySlugs] Successfully found lesson', { \r\n    topic_id: topicData.topic_id, \r\n    lesson_id: lessonData.id,\r\n    zone_id: topicData.zone_id,\r\n    zone_level: (topicData.zones as any).level\r\n  })\r\n  return { \r\n    topic_id: topicData.topic_id, \r\n    lesson_id: lessonData.id,\r\n    zone_id: topicData.zone_id,\r\n    zone_level: (topicData.zones as any).level\r\n  }\r\n}\r\n\r\nasync function getActivePracticeSet(\r\n  lesson_id: number\r\n): Promise<Partial<Exercise> | null> {\r\n  const supabase = await createClient()\r\n\r\n  console.log('[getActivePracticeSet] Searching for practice set with lesson_id:', lesson_id)\r\n\r\n  // Chain with loose typing to avoid query builder union type friction\r\n  const practiceSetQuery = (supabase\r\n    .from('practice_sets')\r\n    .select('id, title, description, coin_reward, xp_reward, reward_coins, status, is_active, sequence_order') as any)\r\n    .eq('lesson_id', lesson_id)\r\n    .eq('is_active', true)\r\n    .eq('status', 'ACTIVE')\r\n    .order('sequence_order', { ascending: true })\r\n    .limit(1)\r\n    .maybeSingle()\r\n\r\n  const { data, error } = await practiceSetQuery\r\n\r\n  if (error) {\r\n    console.error('[getActivePracticeSet] Supabase error', { error, lesson_id })\r\n    return null\r\n  }\r\n  if (!data) {\r\n    console.warn('[getActivePracticeSet] No active practice set found', { lesson_id })\r\n    // Log all practice sets for this lesson to debug\r\n    // @ts-ignore - TypeScript issue with Supabase query builder\r\n    const debugQuery = supabase\r\n      .from('practice_sets')\r\n      .select('id, title, status, is_active, sequence_order')\r\n      .eq('lesson_id', lesson_id)\r\n\r\n    const { data: allSetsData } = (await debugQuery) as any\r\n    console.warn('[getActivePracticeSet] All practice sets for lesson:', allSetsData)\r\n    return null\r\n  }\r\n\r\n  console.log('[getActivePracticeSet] Found practice set:', { id: data.id, title: data.title })\r\n  return {\r\n    id: data.id,\r\n    title: data.title,\r\n    description: data.description,\r\n    coinReward: data.coin_reward ?? data.reward_coins ?? 0,\r\n    xpReward: data.xp_reward ?? 0,\r\n  }\r\n}\r\n\r\nasync function getQuestionsForSet(\r\n  practice_set_id: string,\r\n  topicSlug?: string,\r\n  lessonSlug?: string,\r\n): Promise<Question[]> {\r\n  const supabase = await createClient()\r\n\r\n  // @ts-ignore - TypeScript issue with Supabase query builder\r\n  const questionsQuery = (supabase\r\n    .from('practice_set_questions')\r\n    .select(`\r\n      sort_order,\r\n      questions (\r\n        id,\r\n        question_type,\r\n        question_subtype,\r\n        question_data,\r\n        correct_choice_id,\r\n        metadata,\r\n        image_url,\r\n        audio_url\r\n      )\r\n    `) as any)\r\n    .eq('practice_set_id', practice_set_id)\r\n    .order('sort_order', { ascending: true })\r\n\r\n  const { data: rows, error } = await questionsQuery\r\n\r\n  if (error || !rows) {\r\n    return []\r\n  }\r\n\r\n  const questions: Question[] = rows\r\n    .map((row: { sort_order: number; questions: any }): Question | null => {\r\n      const q = row.questions\r\n      if (!q) return null\r\n\r\n      const base: BaseQuestion = {\r\n        id: q.id.toString(),\r\n        type: q.question_type as Question['type'],\r\n      }\r\n\r\n      // Parse question_data\r\n      let parsedData: any = {}\r\n      if (q.question_data) {\r\n        try {\r\n          parsedData = typeof q.question_data === 'string' ? JSON.parse(q.question_data) : q.question_data\r\n        } catch {\r\n          parsedData = {}\r\n        }\r\n      }\r\n\r\n      // Parse metadata (previously extra_data)\r\n      let extraData: any = {}\r\n      if (q.metadata) {\r\n        try {\r\n          extraData = typeof q.metadata === 'string' ? JSON.parse(q.metadata) : q.metadata\r\n        } catch {\r\n          extraData = {}\r\n        }\r\n      }\r\n\r\n      // Handle audio_url\r\n      let audioUrl: string | undefined\r\n      if (q.audio_url) {\r\n        try {\r\n          const audioData = typeof q.audio_url === 'string' ? JSON.parse(q.audio_url) : q.audio_url\r\n          audioUrl = audioData?.url\r\n        } catch {}\r\n      }\r\n\r\n      // Handle image_url - can be a single object, a URL string, or an array of { alt, src, role }\r\n      let imageUrl: string | undefined\r\n      let imageArray: Array<{ alt?: string; src?: string; role?: string }> = []\r\n      if (q.image_url) {\r\n        console.log('[practice.ts] Processing image_url for question:', q.id, 'raw value:', q.image_url)\r\n        try {\r\n          const raw = typeof q.image_url === 'string' ? JSON.parse(q.image_url) : q.image_url\r\n          console.log('[practice.ts] Parsed image_url:', raw)\r\n          if (Array.isArray(raw)) {\r\n            imageArray = raw\r\n            console.log('[practice.ts] Set imageArray:', imageArray)\r\n          } else if (raw && typeof raw === 'object') {\r\n            // Legacy single object { url } or { src }\r\n            if (raw.url) {\r\n              imageUrl = raw.url as string\r\n            } else if (raw.src && topicSlug && lessonSlug) {\r\n              const path = `${topicSlug}/${lessonSlug}/images/${raw.src}`\r\n              const { data } = supabase.storage.from('exercises').getPublicUrl(path)\r\n              imageUrl = (data.publicUrl as string) || undefined\r\n            }\r\n          } else if (typeof raw === 'string') {\r\n            imageUrl = raw\r\n          }\r\n        } catch {}\r\n      }\r\n\r\n      let question: Question | null = null\r\n\r\n      switch (q.question_type) {\r\n        case 'multiple-choice': {\r\n          let mcqType: MCQType\r\n          switch (q.question_subtype) {\r\n            case 'mcq_text_only':\r\n              mcqType = 'text-only'\r\n              break\r\n            case 'mcq_image_question':\r\n              mcqType = 'image-question'\r\n              break\r\n            case 'mcq_image_choices':\r\n              mcqType = 'image-choices'\r\n              break\r\n            case 'mcq_grammar_structure':\r\n              mcqType = 'grammar-structure'\r\n              break\r\n            case 'mcq_word_translation':\r\n              mcqType = 'word-translation'\r\n              break\r\n            default:\r\n              mcqType = 'text-only'\r\n          }\r\n\r\n          let choices: Choice[] = []\r\n          let correctChoiceId = q.correct_choice_id?.toString() || ''\r\n          \r\n          // Default path resolver for images from storage when we have slugs\r\n          const resolvePublicUrl = (src?: string): string | undefined => {\r\n            if (!src) return undefined\r\n            if (/^https?:\\/\\//i.test(src)) return src\r\n            if (topicSlug && lessonSlug) {\r\n              const path = `${topicSlug}/${lessonSlug}/images/${src}`\r\n              const { data } = supabase.storage.from('exercises').getPublicUrl(path)\r\n              console.log('[practice.ts] Resolving image path:', path, 'to URL:', data.publicUrl)\r\n              return (data.publicUrl as string) || undefined\r\n            }\r\n            return undefined\r\n          }\r\n\r\n          // Handle image-choices: build choices from imageArray\r\n          if (q.question_subtype === 'mcq_image_choices' && imageArray.length > 0) {\r\n            console.log('[practice.ts] Processing mcq_image_choices with imageArray:', imageArray)\r\n            choices = imageArray.map((img, index) => ({\r\n              id: String(index + 1),\r\n              text: img.alt || `Option ${index + 1}`,\r\n              imageUrl: resolvePublicUrl(img.src),\r\n            }))\r\n            console.log('[practice.ts] Built choices for mcq_image_choices:', choices)\r\n            \r\n            // If correct_choice_id not provided, infer from role === 'main'\r\n            if (!correctChoiceId || correctChoiceId === '') {\r\n              const mainIndex = imageArray.findIndex((it) => (it.role || '').toLowerCase() === 'main')\r\n              correctChoiceId = String((mainIndex >= 0 ? mainIndex : 0) + 1)\r\n              console.log('[practice.ts] Inferred correctChoiceId from role=main:', correctChoiceId)\r\n            }\r\n          } else if (q.question_subtype !== 'mcq_image_choices') {\r\n            // For non image-choices, keep existing parsed choices\r\n            choices = parsedData.choices?.map((c: any) => ({\r\n              id: c.id,\r\n              text: c.text,\r\n              imageUrl: c.imageUrl,\r\n            })) || []\r\n          }\r\n\r\n          const mcq: MultipleChoiceQuestion = {\r\n            ...base,\r\n            type: 'multiple-choice',\r\n            questionType: mcqType,\r\n            choices,\r\n            correctChoiceId,\r\n            hint: extraData?.hint,\r\n          }\r\n\r\n          if (mcqType === 'text-only') {\r\n            mcq.passage = parsedData.context || parsedData.passage\r\n            mcq.questionText = parsedData.questionText\r\n          } else if (mcqType === 'image-question') {\r\n            mcq.questionText = parsedData.questionText\r\n            if (!imageUrl && imageArray.length > 0) {\r\n              const mainImg = imageArray.find((it) => (it.role || '').toLowerCase() === 'main') || imageArray[0]\r\n              mcq.questionImage = resolvePublicUrl(mainImg?.src)\r\n            } else {\r\n              mcq.questionImage = imageUrl || parsedData.imageUrl\r\n            }\r\n          } else if (mcqType === 'image-choices') {\r\n            mcq.targetWord = parsedData.targetWord\r\n          } else if (mcqType === 'grammar-structure' || mcqType === 'word-translation') {\r\n            mcq.questionText = parsedData.questionText\r\n            mcq.targetWord = parsedData.targetWord\r\n          }\r\n\r\n          question = mcq\r\n          break\r\n        }\r\n\r\n        case 'choose-words': {\r\n          // Parse the nested question_data structure\r\n          const questionData = parsedData.data || parsedData\r\n          const uiData = parsedData.ui || extraData?.ui || {}\r\n          \r\n          const cw: ChooseWordsQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'choose-words',\r\n            question_data: {\r\n              spec_version: 1,\r\n              subtype: q.question_subtype as ChooseWordsType,\r\n              data: questionData,\r\n              ui: uiData,\r\n            },\r\n            audioUrl,\r\n          }\r\n          question = cw\r\n          break\r\n        }\r\n\r\n        case 'error-correction': {\r\n          const ec: ErrorCorrectionQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'error-correction',\r\n            question: parsedData.question || parsedData.instruction || 'Correct the sentence',\r\n            faultySentence: parsedData.faultySentence || parsedData.faulty,\r\n            target: parsedData.target || parsedData.correct,\r\n            hint: parsedData.hint || extraData?.hint,\r\n          }\r\n          question = ec\r\n          break\r\n        }\r\n\r\n        case 'synonyms-matching': {\r\n          const pairs: SynonymPair[] = parsedData.pairs?.map((p: any, i: number) => ({\r\n            id: i + 1,\r\n            word1: p.left || p.word1,\r\n            word2: p.right || p.word2,\r\n            meaning: p.meaning,\r\n          })) || []\r\n          const sm: SynonymMatchingQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'synonyms-matching',\r\n            pairs,\r\n          }\r\n          question = sm\r\n          break\r\n        }\r\n\r\n        case 'word-matching': {\r\n          const pairs: WordPair[] = parsedData.pairs?.map((p: any, i: number) => ({\r\n            id: i + 1,\r\n            english: p.left || p.word1,\r\n            vietnamese: p.right || p.word2,\r\n          })) || []\r\n          const wm: WordMatchingQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'word-matching',\r\n            pairs,\r\n          }\r\n          question = wm\r\n          break\r\n        }\r\n\r\n        case 'dialogue-completion': {\r\n          // Map dialogue data to context format expected by DialogueCompletion component\r\n          const context = parsedData.dialogue?.map((line: any) => ({\r\n            who: line.who as \"A\" | \"B\",\r\n            text: line.text\r\n          })) || parsedData.context || []\r\n          \r\n          const dc: DialogueCompletionQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'dialogue-completion',\r\n            context,\r\n            choices: parsedData.choices?.map((c: any) => ({\r\n              id: c.id,\r\n              text: c.text,\r\n            })) || [],\r\n            correctChoiceId: q.correct_choice_id?.toString() || '',\r\n            explanation: parsedData.explanation,\r\n          }\r\n          question = dc\r\n          break\r\n        }\r\n\r\n        case 'role-play': {\r\n          const rp: RolePlayQuestion = {\r\n            ...base as BaseQuestion,\r\n            type: 'role-play',\r\n            title: parsedData.context || '', // Use context instead of title\r\n            steps: parsedData.steps?.map((s: any) => ({\r\n              bot: s.bot || s.prompt,\r\n              choices: s.choices?.map((o: any) => ({ text: o.text })) || s.options?.map((o: any) => ({ text: o.text })) || [],\r\n              expected: s.expected || s.correctIndex || 0,\r\n              tips: s.tips || s.hint,\r\n            })) || [],\r\n          }\r\n          question = rp\r\n          break\r\n        }\r\n      }\r\n\r\n      return question\r\n    })\r\n    .filter((q: Question | null): q is Question => q !== null)\r\n\r\n  // Sort by sort_order if needed, but query already orders\r\n  return questions\r\n}\r\n\r\nexport async function getExerciseBySlugs(\r\n  topicSlug: string,\r\n  lessonSlug: string\r\n): Promise<Exercise | null> {\r\n  console.log('Fetching exercise for topicSlug:', topicSlug, 'lessonSlug:', lessonSlug)\r\n  \r\n  const ids = await getLessonIdsBySlugs(topicSlug, lessonSlug)\r\n  console.log('Lesson IDs result:', ids)\r\n  \r\n  if (!ids) {\r\n    console.warn('[getExerciseBySlugs] Could not resolve IDs for provided slugs', { topicSlug, lessonSlug })\r\n    return null\r\n  }\r\n\r\n  const setData = await getActivePracticeSet(ids.lesson_id)\r\n  console.log('Practice set result:', setData)\r\n  \r\n  if (!setData || !('id' in setData)) {\r\n    console.warn('[getExerciseBySlugs] No active practice set data', { ids })\r\n    return null\r\n  }\r\n\r\n  const questions = await getQuestionsForSet(setData.id!.toString(), topicSlug, lessonSlug)\r\n  console.log('Questions length:', questions.length)\r\n  \r\n  return {\r\n    ...setData,\r\n    id: setData.id!.toString(),\r\n    topicId: topicSlug,\r\n    chapterId: '',\r\n    lessonId: lessonSlug,\r\n    zoneId: ids.zone_id,\r\n    zoneLevel: ids.zone_level,\r\n    questions,\r\n  } as Exercise\r\n}\r\n\r\n/**\r\n * Check if the user should be allowed to access the exercise page\r\n * Returns true only if user has an active (in_progress) session\r\n * This blocks direct URL access - sessions must be created via button click first\r\n *\r\n * @param practiceSetId - The ID of the practice set\r\n * @param userId - The ID of the user\r\n * @returns boolean indicating if user has an active session\r\n */\r\nexport async function canAccessExercise(\r\n  practiceSetId: string,\r\n  userId: string\r\n): Promise<boolean> {\r\n  const supabase = await createClient()\r\n\r\n  // Check for active in_progress session\r\n  const { data: activeSession, error } = await supabase\r\n    .from('practice_results')\r\n    .select('id, status')\r\n    .eq('practice_set_id', practiceSetId)\r\n    .eq('user_id', userId)\r\n    .eq('status', 'in_progress')\r\n    .maybeSingle()\r\n\r\n  if (error) {\r\n    console.error('[canAccessExercise] Error checking for active session:', error)\r\n    return false // Block access on error to be safe\r\n  }\r\n\r\n  // Allow access only if there's an active in_progress session\r\n  const hasActiveSession = !!activeSession\r\n\r\n  if (!hasActiveSession) {\r\n    console.log('[canAccessExercise] No active session found for practice_set:', practiceSetId)\r\n  }\r\n\r\n  return hasActiveSession\r\n}"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7]}