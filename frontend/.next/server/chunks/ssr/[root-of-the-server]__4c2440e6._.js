module.exports=[78769,a=>{"use strict";function b(a,b,c){let d=c.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^\w\-_]/g,"").replace(/_+/g,"_").replace(/^_|_$/g,"");return`t${a}-l${b}-${d}`}function c(a){return/^t\d+-l\d+-[\w\-_]+$/.test(a)}a.s(["generateVocabKey",()=>b,"isValidVocabKey",()=>c])},193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},262212,a=>{a.n(a.i(866114))},810162,a=>{a.n(a.i(281745))},800710,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(211857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/features/flashcards/components/create/FlashcardsPageClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/features/flashcards/components/create/FlashcardsPageClient.tsx <module evaluation>","default")},107766,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(211857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/features/flashcards/components/create/FlashcardsPageClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/features/flashcards/components/create/FlashcardsPageClient.tsx","default")},196245,a=>{"use strict";a.i(800710);var b=a.i(107766);a.n(b)},389848,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(907997),c=a.i(800717);a.i(570396);var d=a.i(673727),e=a.i(142238),f=a.i(196245);async function g(){let a=await (0,e.createClient)(),{data:{user:g},error:h}=await a.auth.getUser();return(h||!g)&&(0,d.redirect)("/auth/login"),(0,b.jsx)(c.Suspense,{fallback:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-64 mb-2 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-96 animate-pulse"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-96 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded flex-1 animate-pulse"}),(0,b.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded flex-1 animate-pulse"})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-96 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),(0,b.jsx)("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]})]})]}),children:(0,b.jsx)(f.default,{userId:g.id})})}},503805,a=>{"use strict";a.s(["404db174e64fde8dc83f3aecc37e4914f00496bceb",()=>k,"406bf430709870b36d9a7ac85feffe60d998327396",()=>j,"40a12d3392f5f7e3fd35f464eebcfef7da83f3293b",()=>n.unsaveVocabularyFromLesson,"40b7874b5beee18e2e913212052e9efd3061f9459a",()=>m.saveVocabularyFromLesson,"40df7fcce92212cb097847765ff160f9fc458fc66f",()=>h,"601ee54aa3ae234bd73dda91171672730ddb48c914",()=>i],503805),a.s([],567248);var b=a.i(707685),c=a.i(420861),d=a.i(137936),e=a.i(142238),f=a.i(118558),g=a.i(713095);async function h(a){try{if(!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(d||!c)return{success:!1,error:"Not authenticated - please log in first"};let g={user_id:c.id,vietnamese_text:a.vietnamese_text.trim(),english_text:a.english_text.trim(),ipa_pronunciation:a.ipa_pronunciation?.trim()||null,image_url:a.image_url||null,topic:a.topic?.trim()||null,notes:a.notes||null,status:"ACTIVE",source_type:"user"},{data:h,error:i}=await b.from("custom_flashcards").insert(g).select("id, vietnamese_text, english_text").single();if(i)return console.error("❌ Database insert error:",i),{success:!1,error:i.message||"Failed to create flashcard"};if(!h)return{success:!1,error:"Failed to create flashcard - no data returned"};let j={UserID:c.id,flashcard_id:`custom_${h.id}`,flashcard_type:"CUSTOM",topic:a.topic?.trim()||null,is_favorite:!1,review_count:0,tags:[]},{error:k}=await b.from("saved_flashcards").insert(j);return k?console.error("⚠️ Failed to sync flashcard to saved_flashcards:",k):console.log("✅ Flashcard automatically synced to saved_flashcards"),(0,f.revalidatePath)("/flashcards/saved"),{success:!0,data:{id:h.id,vietnamese_text:h.vietnamese_text,english_text:h.english_text}}}catch(a){return console.error("❌ Error creating flashcard:",a),{success:!1,error:a instanceof Error?a.message:"Failed to create flashcard"}}}async function i(a,b){try{if(!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let c=await (0,e.createClient)(),{data:{user:d},error:f}=await c.auth.getUser();if(f||!d||d.id!==b)return{success:!1,error:"Not authenticated or user mismatch"};let g=await a.arrayBuffer(),h=Buffer.from(g),i=a.name.split(".").pop(),j=`flashcard_${b}_${Date.now()}.${i}`,k=`flashcards/${j}`,l=c.storage.from("images"),{error:m}=await l.upload(k,h,{cacheControl:"3600",upsert:!1,contentType:a.type});if(m)return console.error("❌ Image upload error:",m),{success:!1,error:m.message||"Failed to upload image"};return{success:!0,url:k}}catch(a){return console.error("❌ Error uploading image:",a),{success:!1,error:a instanceof Error?a.message:"Failed to upload image"}}}async function j(a){try{if(!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(d||!c)return{success:!1,error:"Not authenticated - please log in first"};let g={};void 0!==a.vietnamese_text&&(g.vietnamese_text=a.vietnamese_text.trim()),void 0!==a.english_text&&(g.english_text=a.english_text.trim()),void 0!==a.ipa_pronunciation&&(g.ipa_pronunciation=a.ipa_pronunciation?.trim()||null),void 0!==a.image_url&&(g.image_url=a.image_url||null),void 0!==a.topic&&(g.topic=a.topic?.trim()||null),void 0!==a.notes&&(g.notes=a.notes||null),g.updated_at=new Date().toISOString();let{error:h}=await b.from("custom_flashcards").update(g).eq("id",a.id).eq("user_id",c.id);if(h)return console.error("❌ Database update error:",h),{success:!1,error:h.message||"Failed to update flashcard"};return(0,f.revalidatePath)("/flashcards/saved"),(0,f.revalidatePath)("/flashcards/create"),{success:!0}}catch(a){return console.error("❌ Error updating flashcard:",a),{success:!1,error:a instanceof Error?a.message:"Failed to update flashcard"}}}async function k(a){try{if(!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(d||!c)return{success:!1,error:"Not authenticated - please log in first"};let{data:g}=await b.from("custom_flashcards").select("id, vocab_key").eq("id",a).eq("user_id",c.id).maybeSingle();if(!g)return{success:!1,error:"Flashcard not found or you do not have permission to delete it"};g.vocab_key&&await b.from("saved_flashcards").delete().eq("flashcard_id",g.vocab_key).eq("UserID",c.id),await b.from("saved_flashcards").delete().eq("flashcard_id",`custom_${a}`).eq("UserID",c.id);let{error:h}=await b.from("custom_flashcards").delete().eq("id",a).eq("user_id",c.id);if(h)return console.error("❌ Database delete error:",h),{success:!1,error:h.message||"Failed to delete flashcard"};return(0,f.revalidatePath)("/flashcards/saved"),(0,f.revalidatePath)("/flashcards/create"),{success:!0}}catch(a){return console.error("❌ Error deleting flashcard:",a),{success:!1,error:a instanceof Error?a.message:"Failed to delete flashcard"}}}async function l(a,b){try{if(!e.isSupabaseConfigured)return{success:!1,error:"Supabase is not configured"};let c=await (0,e.createClient)(),{data:{user:d},error:f}=await c.auth.getUser();if(f||!d||d.id!==b)return{success:!1,error:"Not authenticated or user mismatch"};let g=await a.arrayBuffer(),h=Buffer.from(g),i=a.name.split(".").pop(),j=`flashcard_${b}_${Date.now()}.${i}`,k=`flashcards/${j}`,l=c.storage.from("images"),{error:m}=await l.upload(k,h,{cacheControl:"3600",upsert:!1,contentType:a.type});if(m)return console.error("❌ Image upload error:",m),{success:!1,error:m.message||"Failed to upload image"};return{success:!0,url:k}}catch(a){return console.error("❌ Error uploading image:",a),{success:!1,error:a instanceof Error?a.message:"Failed to upload image"}}}(0,g.ensureServerEntryExports)([h,i]),(0,d.registerServerReference)(h,"40df7fcce92212cb097847765ff160f9fc458fc66f",null),(0,d.registerServerReference)(i,"601ee54aa3ae234bd73dda91171672730ddb48c914",null),(0,g.ensureServerEntryExports)([j,k,l]),(0,d.registerServerReference)(j,"406bf430709870b36d9a7ac85feffe60d998327396",null),(0,d.registerServerReference)(k,"404db174e64fde8dc83f3aecc37e4914f00496bceb",null),(0,d.registerServerReference)(l,"602b4ab4cc0cefd8e7f9c5cfad5509b1935cc72e85",null),a.i(567248);var m=b,n=c}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4c2440e6._.js.map