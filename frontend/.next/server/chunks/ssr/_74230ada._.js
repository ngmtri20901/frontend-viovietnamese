module.exports=[960262,314159,48988,371209,a=>{"use strict";a.s([],960262),a.i(489026),a.i(572131);var b=a.i(255895);a.s(["useTopicProgress",()=>h,"useZoneCompletion",()=>i],314159);var c=a.i(433217),d=a.i(439193);async function e(a,c){let d=(0,b.createClient)(),{data:e,error:f}=await d.from("user_lesson_progress").select("*").eq("user_id",a).eq("topic_id",c).order("lesson_id",{ascending:!0});return f||!e?[]:e}async function f(a){let{userId:c,zoneId:d}=a,e=(0,b.createClient)(),{data:f,error:g}=await e.from("topics").select("topic_id").eq("zone_id",d);if(g||!f)return{completed:0,total:0};let h=f.map(a=>a.topic_id),i=h.length;if(0===i)return{completed:0,total:0};let{data:j,error:k}=await e.from("lessons").select("id, topic_id").in("topic_id",h);if(k||!j)return{completed:0,total:i};let l=j.map(a=>a.id),{data:m,error:n}=await e.from("user_lesson_progress").select("lesson_id, topic_id, status").eq("user_id",c).in("lesson_id",l).eq("status","passed");if(n||!m)return{completed:0,total:i};let o=new Map;h.forEach(a=>{let b=j.filter(b=>b.topic_id===a);o.set(a,{total:b.length,passed:0})}),m.forEach(a=>{let b=o.get(a.topic_id);b&&(b.passed+=1)});let p=0;return o.forEach(a=>{a.total>0&&a.passed>=a.total&&(p+=1)}),{completed:p,total:i}}var g=a.i(718404);function h(a,b){let{user:f}=(0,d.useUserProfile)(),{data:h=[],isLoading:i}=(0,c.useQuery)({queryKey:g.queryKeys.lessonProgress.topic(f?.id??"",a),queryFn:async()=>f?.id?e(f.id,a):b??[],enabled:!!f?.id,initialData:b,staleTime:3e4,gcTime:3e5});return{topicProgress:h,isLoading:i}}function i(a){let{user:b}=(0,d.useUserProfile)(),{data:e,isLoading:h}=(0,c.useQuery)({queryKey:[...g.queryKeys.lessonProgress.zone(b?.id??"",a),"completion"],queryFn:async()=>b?.id?f({userId:b.id,zoneId:a}):{completed:0,total:0},enabled:!!b?.id&&a>0,staleTime:6e4,gcTime:6e5});return{completed:e?.completed??0,total:e?.total??0,isLoading:h}}function j(a){let{userTier:b,isAuthenticated:c,zoneLevel:d,lessonSortOrder:e,previousLessonProgress:f,completedTopicsInPreviousZone:g=0,totalTopicsInPreviousZone:h=0}=a;if(!c)return{isLocked:!0,reason:"login_required",requiredAction:"Please log in to access lessons"};if("UNLIMITED"===b)return{isLocked:!1};if("FREE"===b){if(1===d)return 1===e||f&&"passed"===f.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson in this topic first"};if(!(h>0&&g>=h)){var i;let a={1:"Beginner",2:"Elementary",3:"Intermediate",4:"Advanced",5:"Expert"}[i=d-1]||`Zone ${i}`;return{isLocked:!0,reason:"zone_locked",requiredAction:`Complete all topics in ${a} zone to unlock this zone (${g}/${h} topics completed)`,completedTopicsInPrevZone:g,totalTopicsInPrevZone:h}}return 1===e||f&&"passed"===f.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson in this topic first"}}return"PLUS"===b?1===e||f&&"passed"===f.status?{isLocked:!1}:{isLocked:!0,reason:"previous_incomplete",requiredAction:"Complete the previous lesson first"}:{isLocked:!0,reason:"tier_restriction",requiredAction:"Upgrade to access this lesson"}}function k(a,b){let{user:f}=(0,d.useUserProfile)(),{data:h=[],isLoading:i}=(0,c.useQuery)({queryKey:g.queryKeys.lessonProgress.topic(f?.id??"",a),queryFn:async()=>f?.id?e(f.id,a):b??[],enabled:!!f?.id,initialData:b,staleTime:3e4,gcTime:3e5});return{completedLessons:h.filter(a=>"passed"===a.status).length,isLoading:i}}a.s(["checkLessonUnlock",()=>j],48988),a.s(["useTopicProgressStats",()=>k],371209)},380629,a=>{"use strict";a.s(["default",()=>o],380629);var b=a.i(187924),c=a.i(238246),d=a.i(214549),e=a.i(557116),f=a.i(641710),g=a.i(93518),h=a.i(167453),i=a.i(943108),j=a.i(439193);a.i(960262);var k=a.i(314159);a.i(300247),a.i(894336),a.i(120073),a.i(874387),a.i(251232),a.i(124985),a.i(969596);var l=a.i(239111),m=a.i(371676);a.i(522776);var n=a.i(48988);function o({lessons:a,topicId:o,topicSlug:p,zoneId:q,zoneLevel:r,initialProgress:s}){let{profile:t,user:u}=(0,j.useUserProfile)(),{topicProgress:v}=(0,k.useTopicProgress)(o,s),{completed:w,total:x}=(0,k.useZoneCompletion)(q-1),y=t?.subscription_type??"FREE";return(0,b.jsx)("div",{className:"grid gap-4",children:a.map((j,k)=>{let o=v.find(a=>a.lesson_id===j.id),q=k>0?a[k-1]:null,s=q?v.find(a=>a.lesson_id===q.id):null,t=(0,n.checkLessonUnlock)({userTier:y,isAuthenticated:!!u,zoneLevel:r,lessonSortOrder:j.sort_order??k+1,previousLessonProgress:s??null,completedTopicsInPreviousZone:w,totalTopicsInPreviousZone:x}),z=t.isLocked;return(0,b.jsx)(m.LessonUnlockTooltip,{unlockStatus:t,children:(0,b.jsx)(e.Card,{className:`transition-all duration-300 hover:shadow-lg ${z?"opacity-60 cursor-not-allowed":"hover:scale-[1.02]"}`,children:(0,b.jsx)(e.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,b.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center border-2 ${o?.status==="passed"?"bg-green-500 border-green-500 text-white":z?"bg-gray-200 border-gray-300 text-gray-500":"bg-blue-50 border-[#067BC2] text-[#067BC2]"}`,children:o?.status==="passed"?(0,b.jsx)(h.CheckCircle2,{size:24}):z?(0,b.jsx)(i.Lock,{size:20}):(0,b.jsx)("span",{className:"font-bold",children:j.sort_order??k+1})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:j.lesson_name}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(f.Clock,{size:14}),"~",j.duration_minutes??15," min"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.Award,{size:14}),j.coins_reward??50," coins"]})]}),o&&(0,b.jsx)("div",{className:"mt-2 inline-block",children:(0,b.jsx)(l.LessonProgressBadge,{status:o.status,bestScore:o.best_score_percent,passThreshold:o.pass_threshold})})]})]}),(0,b.jsx)("div",{children:z?(0,b.jsxs)(d.Button,{disabled:!0,variant:"secondary",className:"px-6",children:[(0,b.jsx)(i.Lock,{size:16,className:"mr-2"}),"Locked"]}):(0,b.jsx)(d.Button,{asChild:!0,className:"px-6 bg-[#067BC2] hover:bg-[#055a9f]",children:(0,b.jsx)(c.default,{href:`/learn/${p}/${j.slug}`,children:o?.status==="passed"?"Review":"Start Lesson"})})})]})})})},j.slug)})})}},624778,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(187924),c=a.i(953722),d=a.i(167453),e=a.i(242641);a.i(960262);var f=a.i(371209);function g({topicId:a,totalLessons:g,initialProgress:h}){let{completedLessons:i,isLoading:j}=(0,f.useTopicProgressStats)(a,h),k=i>0?i:0,l=g>0?Math.round(k/g*100):0;return console.log("[TopicProgressStats] Debug:",{topicId:a,completedLessons:i,totalLessons:g,displayPercentage:l}),(0,b.jsxs)("div",{className:"mt-4 space-y-3 bg-black/30 backdrop-blur-sm p-3 rounded-lg border border-white/10",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 text-gray-200",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,b.jsx)(c.BookOpen,{size:16}),(0,b.jsxs)("span",{children:[g," lessons"]})]}),(0,b.jsxs)("span",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,b.jsx)(d.CheckCircle2,{size:16}),(0,b.jsxs)("span",{children:[k," completed"]})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-100",children:[(0,b.jsx)("span",{children:"Your Progress"}),(0,b.jsxs)("span",{children:[l,"%"]})]}),(0,b.jsx)(e.Progress,{value:l,className:"h-1.5 bg-white/20 [&>div]:bg-teal-400"})]})]})}}];

//# sourceMappingURL=_74230ada._.js.map