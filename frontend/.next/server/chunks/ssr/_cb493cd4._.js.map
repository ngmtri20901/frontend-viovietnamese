{"version":3,"sources":["turbopack:///[project]/node_modules/lucide-react/src/icons/arrow-left.ts","turbopack:///[project]/features/flashcards/components/core/flashcard-deck.tsx","turbopack:///[project]/features/flashcards/components/core/flashcard-skeleton.tsx","turbopack:///[project]/features/flashcards/hooks/useSavedFlashcards.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n","\"use client\"\n\nimport { Card } from \"@/shared/components/ui/card\"\nimport { Badge } from \"@/shared/components/ui/badge\"\nimport { Bookmark, BookmarkCheck, ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { Button } from \"@/shared/components/ui/button\"\nimport { useState, useRef, useEffect, useCallback } from \"react\"\nimport { FlashcardSkeleton } from \"./flashcard-skeleton\"\nimport type { FlashcardData } from \"@/features/flashcards/services/flashcardService\"\n\ninterface FlashcardDeckProps {\n  cards: FlashcardData[]\n  currentIndex?: number // C√≥ th·ªÉ kh√¥ng c·∫ßn thi·∫øt cho ch·∫ø ƒë·ªô row, ho·∫∑c d√πng ƒë·ªÉ highlight card hi·ªán t·∫°i n·∫øu c√≥\n  savedCards: Set<string>\n  onCardSelect: (indexOrId: string | number) => void // C√≥ th·ªÉ truy·ªÅn ID ho·∫∑c index\n  onSave: (id: string) => void\n  displayMode?: \"grid\" | \"row\" // Prop m·ªõi ƒë·ªÉ x√°c ƒë·ªãnh ch·∫ø ƒë·ªô hi·ªÉn th·ªã\n  title?: string // T√πy ch·ªçn ti√™u ƒë·ªÅ cho section (legacy, now handled externally)\n  subtitle?: string // T√πy ch·ªçn ph·ª• ƒë·ªÅ (legacy, now handled externally)\n  itemsPerRow?: number // S·ªë item m·ªói h√†ng cho ch·∫ø ƒë·ªô row\n  // New props for infinite scroll\n  hasMore?: boolean\n  isLoading?: boolean\n  onLoadMore?: () => void\n  total?: number\n}\n\nexport function FlashcardDeck({\n  cards,\n  currentIndex,\n  savedCards,\n  onCardSelect,\n  onSave,\n  displayMode = \"grid\", // M·∫∑c ƒë·ªãnh l√† grid\n  title, // Legacy prop, now handled externally\n  subtitle, // Legacy prop, now handled externally  \n  itemsPerRow = 5, // M·∫∑c ƒë·ªãnh 5 items m·ªói h√†ng cho ch·∫ø ƒë·ªô row\n  // New props for infinite scroll\n  hasMore = false,\n  isLoading = false,\n  onLoadMore,\n  total,\n}: FlashcardDeckProps) {\n  \n  // State for horizontal scrolling\n  const [isDragging, setIsDragging] = useState(false)\n  const [dragStart, setDragStart] = useState({ x: 0, scrollLeft: 0 })\n  const [momentum, setMomentum] = useState(0)\n  const containerRef = useRef<HTMLDivElement>(null)\n  const scrollContainerRef = useRef<HTMLDivElement>(null)\n\n  // Infinite scroll logic\n  const handleScroll = useCallback(() => {\n    if (!scrollContainerRef.current || !onLoadMore || isLoading || !hasMore) return\n\n    const { scrollTop, scrollHeight, clientHeight } = scrollContainerRef.current\n    if (scrollHeight - scrollTop <= clientHeight * 1.5) { // Trigger when 1.5 screen heights from bottom\n      onLoadMore()\n    }\n  }, [onLoadMore, isLoading, hasMore])\n\n  useEffect(() => {\n    const scrollContainer = scrollContainerRef.current\n    if (!scrollContainer || displayMode !== \"grid\") return\n\n    scrollContainer.addEventListener('scroll', handleScroll)\n    return () => scrollContainer.removeEventListener('scroll', handleScroll)\n  }, [handleScroll, displayMode])\n\n  // Handle mouse drag for horizontal scrolling\n  const handleMouseDown = (e: React.MouseEvent) => {\n    if (displayMode === \"row\" && scrollContainerRef.current) {\n      setIsDragging(true)\n      setDragStart({\n        x: e.pageX,\n        scrollLeft: scrollContainerRef.current.scrollLeft\n      })\n      setMomentum(0)\n      // Add global mouse move and up listeners\n      document.addEventListener('mousemove', handleGlobalMouseMove)\n      document.addEventListener('mouseup', handleGlobalMouseUp)\n    }\n  }\n\n  const handleGlobalMouseMove = (e: MouseEvent) => {\n    if (!isDragging || displayMode !== \"row\" || !scrollContainerRef.current) return\n    e.preventDefault()\n    \n    const x = e.pageX\n    const walk = (x - dragStart.x) * 1.5 // Slightly reduced scroll speed for better control\n    scrollContainerRef.current.scrollLeft = dragStart.scrollLeft - walk\n    setMomentum(walk)\n  }\n\n  const handleGlobalMouseUp = () => {\n    if (isDragging && displayMode === \"row\" && scrollContainerRef.current) {\n      setIsDragging(false)\n      \n      // Add momentum scrolling with improved physics\n      if (Math.abs(momentum) > 3) {\n        let currentMomentum = momentum\n        const momentumInterval = setInterval(() => {\n          if (scrollContainerRef.current && Math.abs(currentMomentum) > 0.5) {\n            scrollContainerRef.current.scrollLeft -= currentMomentum * 0.9\n            currentMomentum *= 0.9\n          } else {\n            clearInterval(momentumInterval)\n          }\n        }, 16)\n      }\n      \n      // Remove global listeners\n      document.removeEventListener('mousemove', handleGlobalMouseMove)\n      document.removeEventListener('mouseup', handleGlobalMouseUp)\n    }\n  }\n\n  // Handle mouse move (for internal use)\n  const handleMouseMove = (e: React.MouseEvent) => {\n    // This is handled by global listener now\n  }\n\n  const handleMouseUp = () => {\n    // This is handled by global listener now\n  }\n\n  // Handle touch events for mobile\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (displayMode === \"row\" && scrollContainerRef.current) {\n      setIsDragging(true)\n      setDragStart({\n        x: e.touches[0].pageX,\n        scrollLeft: scrollContainerRef.current.scrollLeft\n      })\n      setMomentum(0)\n    }\n  }\n\n  const handleTouchMove = (e: React.TouchEvent) => {\n    if (!isDragging || displayMode !== \"row\" || !scrollContainerRef.current) return\n    \n    const x = e.touches[0].pageX\n    const walk = (x - dragStart.x) * 1.5\n    scrollContainerRef.current.scrollLeft = dragStart.scrollLeft - walk\n    setMomentum(walk)\n  }\n\n  const handleTouchEnd = () => {\n    if (isDragging && displayMode === \"row\" && scrollContainerRef.current) {\n      setIsDragging(false)\n      \n      // Add momentum scrolling for touch\n      if (Math.abs(momentum) > 3) {\n        let currentMomentum = momentum\n        const momentumInterval = setInterval(() => {\n          if (scrollContainerRef.current && Math.abs(currentMomentum) > 0.5) {\n            scrollContainerRef.current.scrollLeft -= currentMomentum * 0.9\n            currentMomentum *= 0.9\n          } else {\n            clearInterval(momentumInterval)\n          }\n        }, 16)\n      }\n    }\n  }\n\n  // Handle card click\n  const handleCardClick = (card: FlashcardData) => {\n    if (isDragging) return // Prevent selection during drag\n    \n    const cardIndex = cards.findIndex(c => c.id === card.id)\n    if (cardIndex !== -1) {\n      onCardSelect(cardIndex)\n    }\n  }\n\n  // Scroll navigation buttons\n  const scrollLeft = () => {\n    if (scrollContainerRef.current) {\n      scrollContainerRef.current.scrollBy({ left: -300, behavior: 'smooth' })\n    }\n  }\n\n  const scrollRight = () => {\n    if (scrollContainerRef.current) {\n      scrollContainerRef.current.scrollBy({ left: 300, behavior: 'smooth' })\n    }\n  }\n\n  // Auto-scroll to keep current card visible\n  useEffect(() => {\n    if (displayMode === \"row\" && currentIndex !== undefined && scrollContainerRef.current) {\n      const cardWidth = 280 // Approximate card width + gap\n      const containerWidth = scrollContainerRef.current.clientWidth\n      const targetScrollLeft = (cardWidth * currentIndex) - (containerWidth / 2) + (cardWidth / 2)\n      \n      scrollContainerRef.current.scrollTo({\n        left: Math.max(0, targetScrollLeft),\n        behavior: 'smooth'\n      })\n    }\n  }, [currentIndex, displayMode])\n\n  // Cleanup global listeners on unmount\n  useEffect(() => {\n    return () => {\n      document.removeEventListener('mousemove', handleGlobalMouseMove)\n      document.removeEventListener('mouseup', handleGlobalMouseUp)\n    }\n  }, [])\n\n  // --- RENDER CHO CH·∫æ ƒê·ªò GRID (HI·ªÜN T·∫†I) ---\n  if (displayMode === \"grid\") {\n    return (\n      <div className=\"w-full max-w-4xl mx-auto mt-12 pt-8 border-t border-gray-200\">\n        <div className=\"mb-6\">\n          <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{title}</h3>\n          {subtitle && <p className=\"text-sm text-gray-600\">{subtitle}</p>}\n          {total && (\n            <p className=\"text-sm text-gray-500\">\n              Showing {cards.length} of {total} flashcards\n            </p>\n          )}\n        </div>\n\n        <div \n          ref={scrollContainerRef}\n          className=\"max-h-80 overflow-y-auto bg-gray-50 p-4 rounded-lg\"\n        >\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n            {cards.map((card, index) => (\n              <Card\n                key={card.id}\n                className={`p-3 cursor-pointer transition-all hover:shadow-md ${\n                  currentIndex !== undefined && index === currentIndex % cards.length\n                    ? \"ring-2 ring-blue-500 bg-blue-50\"\n                    : \"hover:bg-white bg-white\"\n                }`}\n                onClick={() => onCardSelect(index)} // Gi·∫£ s·ª≠ onCardSelect nh·∫≠n index cho grid\n              >\n                <div className=\"flex items-start justify-between mb-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {Array.isArray(card.type) ? card.type.join(\", \") : card.type}\n                  </Badge>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      onSave(card.id)\n                    }}\n                    className=\"p-1 h-auto\"\n                    aria-label={savedCards.has(card.id) ? \"B·ªè l∆∞u th·∫ª\" : \"L∆∞u th·∫ª\"}\n                  >\n                    {savedCards.has(card.id) ? (\n                      <BookmarkCheck className=\"h-3 w-3 text-blue-600\" />\n                    ) : (\n                      <Bookmark className=\"h-3 w-3 text-gray-400\" />\n                    )}\n                  </Button>\n                </div>\n\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <img\n                    src={card.image_url || `https://placehold.co/40x40/E2E8F0/4A5568?text=${encodeURIComponent(card.vietnamese[0])}`}\n                    alt={card.vietnamese}\n                    className=\"w-8 h-8 object-cover rounded border\"\n                    loading=\"lazy\"\n                    onError={(e) => {\n                      const target = e.target as HTMLImageElement;\n                      target.onerror = null;\n                      target.src = `https://placehold.co/40x40/E2E8F0/4A5568?text=${encodeURIComponent(card.vietnamese[0])}`;\n                    }}\n                  />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium text-sm text-gray-800 truncate\">{card.vietnamese}</p>\n                    <p className=\"text-xs text-gray-600 truncate\">{card.common_meaning}</p>\n                  </div>\n                </div>\n              </Card>\n            ))}\n\n            {/* Show loading skeleton when loading more data */}\n            {isLoading && (\n              <FlashcardSkeleton count={8} displayMode=\"grid\" />\n            )}\n          </div>\n\n          {/* Load more button (fallback for when infinite scroll doesn't work) */}\n          {!isLoading && hasMore && onLoadMore && (\n            <div className=\"flex justify-center mt-6\">\n              <Button \n                onClick={onLoadMore}\n                variant=\"outline\"\n                className=\"px-6\"\n              >\n                Load More Flashcards\n              </Button>\n            </div>\n          )}\n\n          {/* End of data message */}\n          {!hasMore && cards.length > 0 && (\n            <div className=\"text-center mt-6 text-gray-500 text-sm\">\n              You've reached the end of the flashcards\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  // --- RENDER CHO CH·∫æ ƒê·ªò ROW (TODAY'S FLASHCARDS) - HORIZONTAL SCROLLING ---\n  if (displayMode === \"row\") {\n    return (\n      <>\n        {/* Global CSS for scrollbar hiding */}\n        <style jsx global>{`\n          .flashcard-scroll-container {\n            scrollbar-width: none;\n            -ms-overflow-style: none;\n          }\n          .flashcard-scroll-container::-webkit-scrollbar {\n            display: none;\n          }\n        `}</style>\n        \n        <div ref={containerRef} className=\"w-full mx-auto relative group select-none\">\n          {/* Navigation Container */}\n          <div className=\"relative\">\n            {/* Left Navigation Button - Carousel style */}\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={scrollLeft}\n              className=\"absolute -left-12 top-1/2 -translate-y-1/2 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 h-8 w-8 rounded-full\"\n              aria-label=\"Scroll left\"\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </Button>\n\n            {/* Right Navigation Button - Carousel style */}\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={scrollRight}\n              className=\"absolute -right-12 top-1/2 -translate-y-1/2 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 h-8 w-8 rounded-full\"\n              aria-label=\"Scroll right\"\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </Button>\n\n            {/* Horizontal Scrolling Container */}\n            <div\n              ref={scrollContainerRef}\n              className=\"flashcard-scroll-container overflow-x-auto px-4 py-2\"\n              style={{ \n                cursor: isDragging ? 'grabbing' : 'grab',\n              }}\n              onMouseDown={handleMouseDown}\n              onTouchStart={handleTouchStart}\n              onTouchMove={handleTouchMove}\n              onTouchEnd={handleTouchEnd}\n            >\n              {/* Cards Container - Horizontal Layout */}\n              <div className=\"flex gap-4 pb-4\">\n                {cards.map((card, index) => {\n                  const isActive = currentIndex !== undefined && index === currentIndex\n                  \n                  return (\n                    <div\n                      key={card.id}\n                      className={`flex-shrink-0 transition-all duration-300 ${\n                        isActive ? 'scale-105' : 'hover:scale-[1.02]'\n                      }`}\n                      style={{ width: '260px' }}\n                    >\n                      <Card\n                        className={`p-4 cursor-pointer transition-all duration-300 hover:shadow-xl rounded-xl flex flex-col justify-between bg-white h-full ${\n                          isActive \n                            ? 'ring-4 ring-blue-500 ring-offset-2 shadow-2xl bg-gradient-to-br from-blue-50 via-white to-blue-50' \n                            : 'hover:shadow-lg border-2 border-transparent hover:border-blue-200 hover:bg-blue-50/30'\n                        }`}\n                        onClick={() => handleCardClick(card)}\n                      >\n                        <div>\n                          <div className=\"relative w-full h-32 mb-3 rounded-lg overflow-hidden border-2 border-gray-100\">\n                            <img\n                              src={card.image_url || `https://placehold.co/300x200/E2E8F0/4A5568?text=${encodeURIComponent(card.vietnamese)}`}\n                              alt={card.vietnamese}\n                              className=\"w-full h-full object-cover\"\n                              loading=\"lazy\"\n                              onError={(e) => {\n                                const target = e.target as HTMLImageElement;\n                                target.onerror = null;\n                                target.src = `https://placehold.co/300x200/E2E8F0/4A5568?text=${encodeURIComponent(card.vietnamese)}`;\n                              }}\n                            />\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                onSave(card.id);\n                              }}\n                              className=\"absolute top-2 right-2 p-1.5 h-auto bg-white/80 hover:bg-white rounded-full backdrop-blur-sm shadow-sm\"\n                              aria-label={savedCards.has(card.id) ? \"B·ªè l∆∞u th·∫ª\" : \"L∆∞u th·∫ª\"}\n                            >\n                              {savedCards.has(card.id) ? (\n                                <BookmarkCheck className=\"h-4 w-4 text-blue-600\" />\n                              ) : (\n                                <Bookmark className=\"h-4 w-4 text-gray-500\" />\n                              )}\n                            </Button>\n                          </div>\n\n                          <h4 className={`font-semibold text-sm mb-1 truncate transition-colors ${\n                            isActive ? 'text-blue-900' : 'text-gray-900'\n                          }`}>\n                            {card.vietnamese}\n                          </h4>\n                          <p className={`text-xs mb-2 truncate transition-colors ${\n                            isActive ? 'text-blue-700' : 'text-gray-600'\n                          }`}>\n                            {card.common_meaning}\n                          </p>\n                        </div>\n                        <Badge \n                          variant=\"secondary\" \n                          className={`text-xs self-start transition-all duration-300 ${\n                            isActive \n                              ? 'bg-blue-100 text-blue-800 border-blue-300 shadow-sm' \n                              : 'bg-blue-50 text-blue-700 border-blue-200'\n                          }`}\n                        >\n                          {Array.isArray(card.type) ? card.type.join(\", \") : card.type}\n                        </Badge>\n                      </Card>\n                    </div>\n                  )\n                })}\n              </div>\n            </div>\n\n            {/* Scroll Progress Indicator */}\n            <div className=\"flex justify-center mt-4\">\n              <div className=\"h-1.5 w-32 bg-gray-200 rounded-full overflow-hidden shadow-inner\">\n                <div \n                  className=\"h-full bg-gradient-to-r from-blue-500 to-blue-600 transition-all duration-300 rounded-full\"\n                  style={{\n                    width: `${Math.min(100, (currentIndex !== undefined ? (currentIndex + 1) / cards.length : 0) * 100)}%`\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  return null; // Tr∆∞·ªùng h·ª£p kh√¥ng c√≥ displayMode h·ª£p l·ªá\n}\n","import { Skeleton } from \"@/shared/components/ui/skeleton\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\n\r\ninterface FlashcardSkeletonProps {\r\n  count?: number\r\n  displayMode?: \"grid\" | \"row\"\r\n}\r\n\r\nexport function FlashcardSkeleton({ count = 3, displayMode = \"grid\" }: FlashcardSkeletonProps) {\r\n  if (displayMode === \"row\") {\r\n    return (\r\n      <div className=\"flex gap-4 pb-4\">\r\n        {Array.from({ length: count }, (_, i) => (\r\n          <div\r\n            key={i}\r\n            className=\"flex-shrink-0\"\r\n            style={{ width: '260px' }}\r\n          >\r\n            <Card className=\"p-4 h-full bg-white\">\r\n              <CardContent className=\"p-0\">\r\n                {/* Image skeleton */}\r\n                <Skeleton className=\"w-full h-32 mb-3 rounded-lg\" />\r\n                \r\n                {/* Title skeleton */}\r\n                <Skeleton className=\"h-4 w-3/4 mb-1\" />\r\n                \r\n                {/* Subtitle skeleton */}\r\n                <Skeleton className=\"h-3 w-1/2 mb-2\" />\r\n                \r\n                {/* Badge skeleton */}\r\n                <Skeleton className=\"h-5 w-16 rounded-full\" />\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Grid layout skeleton\r\n  return (\r\n    <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n      {Array.from({ length: count }, (_, i) => (\r\n        <Card key={i} className=\"p-3 bg-white\">\r\n          <CardContent className=\"p-0\">\r\n            {/* Header with badge and action */}\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <Skeleton className=\"h-4 w-12 rounded-full\" />\r\n              <Skeleton className=\"h-6 w-6 rounded\" />\r\n            </div>\r\n\r\n            {/* Image and content */}\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Skeleton className=\"w-8 h-8 rounded border\" />\r\n              <div className=\"flex-1 min-w-0\">\r\n                <Skeleton className=\"h-3 w-full mb-1\" />\r\n                <Skeleton className=\"h-3 w-2/3\" />\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function FlashcardListSkeleton({ count = 5 }: { count?: number }) {\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {Array.from({ length: count }, (_, i) => (\r\n        <Card key={i} className=\"p-4 bg-white\">\r\n          <CardContent className=\"p-0\">\r\n            <div className=\"flex items-center gap-4\">\r\n              {/* Image skeleton */}\r\n              <Skeleton className=\"w-16 h-16 rounded-lg flex-shrink-0\" />\r\n\r\n              {/* Content skeleton */}\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-3 mb-1\">\r\n                      <Skeleton className=\"h-5 w-32\" />\r\n                      <Skeleton className=\"h-4 w-4\" />\r\n                    </div>\r\n                    \r\n                    <Skeleton className=\"h-4 w-48 mb-2\" />\r\n\r\n                    <div className=\"flex items-center gap-2 flex-wrap\">\r\n                      <Skeleton className=\"h-5 w-16 rounded-full\" />\r\n                      <Skeleton className=\"h-5 w-12 rounded-full\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Actions skeleton */}\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"text-right text-sm mr-2\">\r\n                      <Skeleton className=\"h-3 w-16 mb-1\" />\r\n                      <Skeleton className=\"h-3 w-12\" />\r\n                    </div>\r\n\r\n                    <Skeleton className=\"h-8 w-8\" />\r\n                    <Skeleton className=\"h-8 w-20\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  )\r\n} ","'use client'\r\n\r\nimport { useState, useCallback, useEffect, useRef } from 'react'\r\nimport { createClient } from '@/shared/lib/supabase/client'\r\nimport { toast } from 'sonner'\r\n\r\n/**\r\n * Hook to manage saved flashcards\r\n * Tracks which flashcards are saved by the current user\r\n */\r\nexport function useSavedFlashcards() {\r\n  const [savedCards, setSavedCards] = useState<Set<string>>(new Set())\r\n  const [loading, setLoading] = useState(false)\r\n  // Use ref to track current savedCards for use in callbacks without stale closures\r\n  const savedCardsRef = useRef<Set<string>>(new Set())\r\n  \r\n  // Keep ref in sync with state\r\n  useEffect(() => {\r\n    savedCardsRef.current = savedCards\r\n  }, [savedCards])\r\n\r\n  // Load saved cards on mount\r\n  useEffect(() => {\r\n    const loadSavedCards = async () => {\r\n      try {\r\n        const supabase = createClient()\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        \r\n        if (!user) {\r\n          return\r\n        }\r\n\r\n        setLoading(true)\r\n        \r\n        // Fetch saved flashcards from Supabase\r\n        const { data: savedFlashcards, error } = await supabase\r\n          .from('saved_flashcards')\r\n          .select('flashcard_id')\r\n          .eq('UserID', user.id)  // Column name is UserID (capital U, capital ID)\r\n          .eq('flashcard_type', 'APP')\r\n\r\n        if (error) {\r\n          console.error('Failed to load saved cards:', error)\r\n          // Fallback to localStorage\r\n          const savedIds = localStorage.getItem(`saved_flashcards_${user.id}`)\r\n          if (savedIds) {\r\n            const ids = JSON.parse(savedIds) as string[]\r\n            const savedSet = new Set(ids)\r\n            setSavedCards(savedSet)\r\n            savedCardsRef.current = savedSet\r\n          }\r\n          return\r\n        }\r\n\r\n        // Extract flashcard IDs\r\n        const ids = savedFlashcards?.map(sf => sf.flashcard_id) || []\r\n        const savedSet = new Set(ids)\r\n        setSavedCards(savedSet)\r\n        savedCardsRef.current = savedSet\r\n        \r\n        // Sync to localStorage as backup\r\n        localStorage.setItem(`saved_flashcards_${user.id}`, JSON.stringify(ids))\r\n      } catch (error) {\r\n        console.error('Failed to load saved cards:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    loadSavedCards()\r\n  }, [])\r\n\r\n  const toggleSave = useCallback(async (flashcardId: string, topic?: string) => {\r\n    try {\r\n      const supabase = createClient()\r\n      const { data: { user } } = await supabase.auth.getUser()\r\n      \r\n      if (!user) {\r\n        toast.error('Please log in to save flashcards')\r\n        return false\r\n      }\r\n\r\n      setLoading(true)\r\n      \r\n      // Check current saved state using ref to avoid stale closure issues\r\n      const isSaved = savedCardsRef.current.has(flashcardId)\r\n      \r\n      console.log('üîÑ [useSavedFlashcards] Toggling save for flashcard:', flashcardId, 'isSaved:', isSaved)\r\n      \r\n      if (isSaved) {\r\n        // Remove from saved_flashcards table\r\n        console.log('üóëÔ∏è [useSavedFlashcards] Removing flashcard from saved_flashcards')\r\n        const { error: deleteError } = await supabase\r\n          .from('saved_flashcards')\r\n          .delete()\r\n          .eq('UserID', user.id)  // Column name is UserID\r\n          .eq('flashcard_id', flashcardId)\r\n          .eq('flashcard_type', 'APP')\r\n\r\n        if (deleteError) {\r\n          console.error('‚ùå [useSavedFlashcards] Failed to unsave flashcard:', deleteError)\r\n          toast.error('Failed to remove flashcard')\r\n          return false\r\n        }\r\n\r\n        // Update local state using functional update\r\n        setSavedCards(prev => {\r\n          const next = new Set(prev)\r\n          next.delete(flashcardId)\r\n          \r\n          // Update localStorage\r\n          const ids = Array.from(next)\r\n          localStorage.setItem(`saved_flashcards_${user.id}`, JSON.stringify(ids))\r\n          \r\n          return next\r\n        })\r\n        \r\n        console.log('‚úÖ [useSavedFlashcards] Flashcard removed successfully')\r\n        toast.success('Flashcard removed from your collection')\r\n        return true\r\n      } else {\r\n        // Add to saved_flashcards table\r\n        console.log('üíæ [useSavedFlashcards] Adding flashcard to saved_flashcards')\r\n        const { error: insertError } = await supabase\r\n          .from('saved_flashcards')\r\n          .insert({\r\n            UserID: user.id,  // Column name is UserID (capital U, capital ID)\r\n            flashcard_id: flashcardId,\r\n            flashcard_type: 'APP',\r\n            topic: topic || null,\r\n            saved_at: new Date().toISOString(),\r\n            is_favorite: false,\r\n            review_count: 0,\r\n            tags: []\r\n          })\r\n\r\n        if (insertError) {\r\n          // Check if it's a duplicate key error (already saved)\r\n          if (insertError.code === '23505') {\r\n            console.log('‚ÑπÔ∏è [useSavedFlashcards] Flashcard already saved (duplicate key)')\r\n            toast.info('Flashcard is already saved')\r\n            // Update local state to reflect this\r\n            setSavedCards(prev => {\r\n              const next = new Set(prev)\r\n              next.add(flashcardId)\r\n              \r\n              // Update localStorage\r\n              const ids = Array.from(next)\r\n              localStorage.setItem(`saved_flashcards_${user.id}`, JSON.stringify(ids))\r\n              \r\n              return next\r\n            })\r\n            return true\r\n          }\r\n          \r\n          console.error('‚ùå [useSavedFlashcards] Failed to save flashcard:', insertError)\r\n          console.error('‚ùå [useSavedFlashcards] Error details:', {\r\n            code: insertError.code,\r\n            message: insertError.message,\r\n            details: insertError.details,\r\n            hint: insertError.hint\r\n          })\r\n          toast.error(`Failed to save flashcard: ${insertError.message || 'Unknown error'}`)\r\n          return false\r\n        }\r\n\r\n        // Update local state using functional update\r\n        setSavedCards(prev => {\r\n          const next = new Set(prev)\r\n          next.add(flashcardId)\r\n          \r\n          // Update localStorage\r\n          const ids = Array.from(next)\r\n          localStorage.setItem(`saved_flashcards_${user.id}`, JSON.stringify(ids))\r\n          \r\n          return next\r\n        })\r\n        \r\n        console.log('‚úÖ [useSavedFlashcards] Flashcard saved successfully')\r\n        toast.success('Flashcard saved to your collection')\r\n        return true\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå [useSavedFlashcards] Unexpected error toggling save:', error)\r\n      const errorMessage = error instanceof Error ? error.message : 'An unknown error occurred'\r\n      toast.error(`An error occurred: ${errorMessage}`)\r\n      return false\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, []) // Remove savedCards from dependencies - use functional updates instead\r\n\r\n  const isFlashcardSaved = useCallback((flashcardId: string): boolean => {\r\n    return savedCards.has(flashcardId)\r\n  }, [savedCards])\r\n\r\n  return {\r\n    savedCards,\r\n    toggleSave,\r\n    isFlashcardSaved,\r\n    loading,\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"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","ignoreList":[0]}