{"version":3,"sources":["turbopack:///[project]/features/learn/components/exercises/MCQ/multiple-choice-question.tsx","turbopack:///[project]/features/learn/components/exercises/ChooseWords/choose-words.tsx","turbopack:///[project]/features/learn/components/exercises/SynonymsMatching/synonyms-matching.tsx","turbopack:///[project]/features/learn/components/exercises/WordsMatching/words-matching.tsx","turbopack:///[project]/features/learn/components/exercises/writing/ErrorCorrection.tsx","turbopack:///[project]/features/learn/components/exercises/dialogue/DialogueCompletion.tsx","turbopack:///[project]/features/learn/components/exercises/dialogue/RolePlay.tsx","turbopack:///[project]/features/learn/components/exercises/ExerciseContainer.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useMemo, useState, useEffect } from \"react\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\nimport { CheckCircle, XCircle } from \"lucide-react\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport Image from \"next/image\"\r\n\r\n// Default questions for image-question type\r\nconst defaultImageQuestions = [\r\n  \"What does this image show?\",\r\n  \"What is shown in the picture?\",\r\n  \"What is depicted in this image?\",\r\n  \"What is this an picture of?\",\r\n  \"What can you see in the picture?\",\r\n  \"Identify what's in the image.\",\r\n  \"Name what the image shows.\",\r\n  \"Choose the best description of the picture.\",\r\n  \"Which option best describes the image?\"\r\n]\r\n\r\n// Default questions for image-choices type\r\nconst defaultImageChoicesQuestions = [\r\n  \"Select the picture for\",\r\n  \"Choose the correct image for\",\r\n  \"Pick the image that matches\",\r\n  \"Which picture shows\",\r\n  \"Identify the image for\",\r\n  \"Click on the picture that represents\",\r\n  \"Find the correct image for the word\",\r\n  \"Select the image that best illustrates\",\r\n  \"Which image corresponds to\",\r\n  \"Point to the picture that matches the word\"\r\n]\r\n\r\n// Default questions for word-translation type\r\nconst defaultWordTranslationQuestions = [\r\n  \"What does\",\r\n  \"Select the correct meaning of\",\r\n  \"Choose the right translation for\",\r\n  \"Pick the correct meaning of the word\",\r\n  \"Which is the correct meaning of\",\r\n  \"Identify the correct translation of\",\r\n  \"Choose the option that correctly translates\",\r\n  \"Find the correct meaning of the word\",\r\n  \"Which option gives the right meaning of\"\r\n]\r\n\r\n// Types of multiple choice questions\r\nexport type QuestionType =\r\n  | \"text-only\" // Type 1: Passage + question + text choices\r\n  | \"image-question\" // Type 2: Image + question + text choices\r\n  | \"word-translation\" // Type 3: Word + translation choices\r\n  | \"image-choices\" // Type 4: Question + image choices\r\n\r\n// Choice structure\r\nexport interface Choice {\r\n  id: string\r\n  text: string\r\n  imageUrl?: string\r\n}\r\n\r\n// Props for the component\r\nexport interface MultipleChoiceQuestionProps {\r\n  type: QuestionType\r\n  questionText?: string\r\n  passage?: string\r\n  questionImage?: string\r\n  targetWord?: string\r\n  choices: Choice[]\r\n  correctChoiceId: string\r\n  explanation?: string\r\n  showCorrectAnswer?: boolean\r\n  lockAfterSubmit?: boolean\r\n  onComplete?: (isCorrect: boolean, selectedChoice?: Choice) => void\r\n  // Controlled mode for container-managed flow\r\n  controlled?: boolean\r\n  value?: string | null\r\n  onAnswerChange?: (choiceId: string | null) => void\r\n  disableInlineFeedback?: boolean\r\n  hideActions?: boolean\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function MultipleChoiceQuestion({\r\n  type,\r\n  questionText,\r\n  passage,\r\n  questionImage,\r\n  targetWord,\r\n  choices,\r\n  correctChoiceId,\r\n  explanation,\r\n  showCorrectAnswer = true,\r\n  lockAfterSubmit = false,\r\n  onComplete,\r\n  controlled = false,\r\n  value = null,\r\n  onAnswerChange,\r\n  disableInlineFeedback = false,\r\n  hideActions = false,\r\n  readOnly = false,\r\n}: MultipleChoiceQuestionProps) {\r\n  const [selectedChoiceId, setSelectedChoiceId] = useState<string | null>(value)\r\n  const [feedback, setFeedback] = useState<{\r\n    visible: boolean\r\n    isCorrect: boolean\r\n    message: string\r\n  }>({ visible: false, isCorrect: false, message: \"\" })\r\n  const [submitted, setSubmitted] = useState<boolean>(false)\r\n  const correctAnswerText = useMemo(\r\n    () => choices.find((opt) => opt.id === correctChoiceId)?.text,\r\n    [choices, correctChoiceId],\r\n  )\r\n\r\n  const isSelectionLocked = controlled ? !!readOnly : submitted && lockAfterSubmit\r\n\r\n  // Sync external value when controlled\r\n  useEffect(() => {\r\n    if (controlled) {\r\n      setSelectedChoiceId(value ?? null)\r\n    }\r\n  }, [controlled, value])\r\n\r\n  const handleChoiceSelect = (choiceId: string) => {\r\n    if (isSelectionLocked) return\r\n    if (controlled) {\r\n      onAnswerChange?.(choiceId)\r\n    } else {\r\n      setSelectedChoiceId(choiceId)\r\n      setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n    }\r\n  }\r\n\r\n  const handleCheck = () => {\r\n    if (!selectedChoiceId) return\r\n\r\n    const isCorrect = selectedChoiceId === correctChoiceId\r\n    const selectedChoice = choices.find((choice) => choice.id === selectedChoiceId)\r\n\r\n    if (!controlled) {\r\n      setFeedback({\r\n        visible: true,\r\n        isCorrect,\r\n        message: isCorrect ? \"Correct! Great job!\" : \"Not quite right. Try again!\",\r\n      })\r\n      setSubmitted(true)\r\n      if (onComplete && selectedChoice) {\r\n        onComplete(isCorrect, selectedChoice)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleReset = () => {\r\n    if (controlled) {\r\n      onAnswerChange?.(null)\r\n    } else {\r\n      setSelectedChoiceId(null)\r\n      setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n      setSubmitted(false)\r\n    }\r\n  }\r\n\r\n  // Render the question content based on type\r\n  const renderQuestionContent = () => {\r\n    // Helper function to get question text based on type - memoized per question\r\n    const getQuestionText = useMemo(() => {\r\n      if (questionText) return questionText\r\n\r\n      switch (type) {\r\n        case \"image-question\":\r\n          // Use questionImage as seed for consistent randomization per question\r\n          const seed = questionImage || type\r\n          const hash = seed.split('').reduce((a, b) => {\r\n            a = ((a << 5) - a) + b.charCodeAt(0)\r\n            return a & a\r\n          }, 0)\r\n          const index = Math.abs(hash) % defaultImageQuestions.length\r\n          return defaultImageQuestions[index]\r\n        case \"image-choices\":\r\n          // Use targetWord as seed for consistent randomization per question\r\n          const seedChoices = targetWord || type\r\n          const hashChoices = seedChoices.split('').reduce((a, b) => {\r\n            a = ((a << 5) - a) + b.charCodeAt(0)\r\n            return a & a\r\n          }, 0)\r\n          const indexChoices = Math.abs(hashChoices) % defaultImageChoicesQuestions.length\r\n          const questionPrefix = defaultImageChoicesQuestions[indexChoices]\r\n          return targetWord ? `${questionPrefix} \"${targetWord}\"` : \"Choose the appropriate image\"\r\n        case \"word-translation\":\r\n          // Use targetWord as seed for consistent randomization per question\r\n          const seedTranslation = targetWord || type\r\n          const hashTranslation = seedTranslation.split('').reduce((a, b) => {\r\n            a = ((a << 5) - a) + b.charCodeAt(0)\r\n            return a & a\r\n          }, 0)\r\n          const indexTranslation = Math.abs(hashTranslation) % defaultWordTranslationQuestions.length\r\n          const questionPrefixTranslation = defaultWordTranslationQuestions[indexTranslation]\r\n          return targetWord ? `${questionPrefixTranslation} ` : \"Choose the correct translation\"\r\n        default:\r\n          return \"Select the correct answer\"\r\n      }\r\n    }, [questionText, type, questionImage, targetWord])\r\n\r\n    switch (type) {\r\n      case \"text-only\":\r\n        return (\r\n          <div className=\"mb-6\">\r\n            {passage && (\r\n              <Card className=\"mb-4\">\r\n                <CardContent className=\"p-4\">\r\n                  <p className=\"text-gray-700\">{passage}</p>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n            <h3 className=\"text-xl font-medium mb-2\">{getQuestionText}</h3>\r\n          </div>\r\n        )\r\n\r\n      case \"image-question\":\r\n        console.log('[MCQ] Rendering image-question with questionImage:', questionImage)\r\n        return (\r\n          <div className=\"mb-6 flex flex-col md:flex-row gap-4\">\r\n            {questionImage && (\r\n              <div className=\"md:w-1/2\">\r\n                <div className=\"relative h-64 w-full rounded-lg overflow-hidden\">\r\n                  <Image src={questionImage || \"/placeholder.svg\"} alt=\"Question image\" fill className=\"object-cover\" />\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"md:w-1/2\">\r\n              <h3 className=\"text-xl font-medium mb-2\">{getQuestionText}</h3>\r\n            </div>\r\n          </div>\r\n        )\r\n\r\n      case \"word-translation\":\r\n        return (\r\n          <div className=\"mb-6 text-center\">\r\n            <h3 className=\"text-xl font-medium mb-2\">{getQuestionText}</h3>\r\n            {targetWord && <div className=\"text-3xl font-bold text-primary my-4\">{targetWord}</div>}\r\n          </div>\r\n        )\r\n\r\n      case \"image-choices\":\r\n        return (\r\n          <div className=\"mb-6\">\r\n            <h3 className=\"text-xl font-medium mb-2\">{getQuestionText}</h3>\r\n          </div>\r\n        )\r\n\r\n      default:\r\n        return (\r\n          <div className=\"mb-6\">\r\n            <h3 className=\"text-xl font-medium mb-2\">{getQuestionText}</h3>\r\n          </div>\r\n        )\r\n    }\r\n  }\r\n\r\n  // Render choices based on type\r\n  const renderChoices = () => {\r\n    switch (type) {\r\n      case \"image-choices\":\r\n        return (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            {choices.map((choice) => (\r\n              <Card\r\n                key={choice.id}\r\n                className={cn(\r\n                  \"cursor-pointer transition-all hover:border-primary\",\r\n                  selectedChoiceId === choice.id && \"ring-2 ring-primary border-primary\",\r\n                  feedback.visible &&\r\n                    selectedChoiceId === choice.id &&\r\n                    (feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\"),\r\n                )}\r\n                onClick={() => handleChoiceSelect(choice.id)}\r\n              >\r\n                <CardContent className=\"p-4 flex flex-col items-center\">\r\n                  {choice.imageUrl && (\r\n                    <div className=\"relative h-32 w-full mb-2 rounded overflow-hidden\">\r\n                      <Image\r\n                        src={choice.imageUrl || \"/placeholder.svg\"}\r\n                        alt={choice.text}\r\n                        fill\r\n                        className=\"object-cover\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <p className=\"text-center font-medium\">{choice.text}</p>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )\r\n\r\n      default:\r\n        return (\r\n          <div className=\"space-y-3\">\r\n            {choices.map((choice) => (\r\n              <Button\r\n                key={choice.id}\r\n                variant=\"outline\"\r\n                className={cn(\r\n                  \"w-full justify-start text-left h-auto py-3 px-4\",\r\n                  selectedChoiceId === choice.id && \"border-primary bg-primary/5\",\r\n                  feedback.visible &&\r\n                    selectedChoiceId === choice.id &&\r\n                    (feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\"),\r\n                )}\r\n                onClick={() => handleChoiceSelect(choice.id)}\r\n                disabled={isSelectionLocked}\r\n              >\r\n                <span>{choice.text}</span>\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        )\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto\">\r\n      {renderQuestionContent()}\r\n\r\n      <div className=\"mb-6\">{renderChoices()}</div>\r\n\r\n      {/* Feedback Alert (hidden when controlled/disabled) */}\r\n      {!controlled && !disableInlineFeedback && feedback.visible && (\r\n        <Alert className={cn(\"mb-6\", feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\")}>\r\n          <div className=\"flex items-center\">\r\n            {feedback.isCorrect ? (\r\n              <CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n            ) : (\r\n              <XCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            )}\r\n            <AlertDescription>{feedback.message}</AlertDescription>\r\n          </div>\r\n        </Alert>\r\n      )}\r\n\r\n      {!hideActions && (\r\n        <div className=\"flex justify-between\">\r\n          <Button variant=\"outline\" onClick={handleReset}>\r\n            Reset\r\n          </Button>\r\n          {!controlled && (\r\n            <Button onClick={handleCheck} disabled={!selectedChoiceId || isSelectionLocked}>\r\n              Check Answer\r\n            </Button>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {!controlled && submitted && (explanation || showCorrectAnswer) && (\r\n        <Card className=\"mt-6\">\r\n          <CardContent className=\"p-4\">\r\n            {explanation && (\r\n              <div className=\"mb-3\">\r\n                <div className=\"text-sm text-gray-600 mb-1\">Explanation:</div>\r\n                <div className=\"text-gray-800\">{explanation}</div>\r\n              </div>\r\n            )}\r\n            {showCorrectAnswer && !feedback.isCorrect && (\r\n              <div className=\"mt-1\">\r\n                <div className=\"text-sm text-gray-600 mb-1\">Correct answer:</div>\r\n                <div className=\"font-medium text-green-700\">\r\n                  {correctAnswerText}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState, useEffect, useRef, useMemo } from \"react\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card } from \"@/shared/components/ui/card\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\nimport { Volume2, CheckCircle, XCircle } from \"lucide-react\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport { normalizeForComparison } from \"@/shared/utils/vi-normalize\"\r\n\r\n// Types for our component\r\nexport type ExerciseType = \"translation\" | \"fill_in_blanks\" | \"sentence_scramble\"\r\n\r\nexport interface ChooseWordsProps {\r\n  question: string\r\n  sentence: string\r\n  words: string[]\r\n  type: ExerciseType\r\n  onComplete?: (isCorrect: boolean, answer?: string[]) => void\r\n  correctAnswer?: string[]\r\n  highlightedWords?: string[]\r\n  audioUrl?: string\r\n  characterImageUrl?: string\r\n  controlled?: boolean\r\n  value?: string[] | null\r\n  onAnswerChange?: (answer: string[]) => void\r\n  disableInlineFeedback?: boolean\r\n  hideActions?: boolean\r\n  readOnly?: boolean\r\n}\r\n\r\n// Word item with unique ID\r\ninterface WordItem {\r\n  id: string\r\n  content: string\r\n  position?: number // Position for fill-in-blanks\r\n}\r\n\r\n// Word component\r\ninterface WordProps {\r\n  word: WordItem\r\n  onClick: (word: WordItem) => void\r\n  isSelected?: boolean\r\n}\r\n\r\nconst Word = ({ word, onClick, isSelected }: WordProps) => {\r\n  return (\r\n    <Button\r\n      variant=\"outline\"\r\n      className={cn(\"m-1 transition-all\", isSelected && \"bg-primary/10 border-primary\")}\r\n      onClick={() => onClick(word)}\r\n    >\r\n      {word.position !== undefined && <span className=\"mr-1 text-primary font-medium\">({word.position})</span>}\r\n      {word.content}\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport function ChooseWords({\r\n  question,\r\n  sentence,\r\n  words,\r\n  type,\r\n  onComplete,\r\n  correctAnswer,\r\n  highlightedWords = [],\r\n  audioUrl,\r\n  characterImageUrl,\r\n  controlled = false,\r\n  value = null,\r\n  onAnswerChange,\r\n  disableInlineFeedback = false,\r\n  hideActions = false,\r\n  readOnly = false,\r\n}: ChooseWordsProps) {\r\n  // Create word items with unique IDs\r\n  const createWordItems = (wordList: string[]): WordItem[] => {\r\n    return wordList.map((word, index) => ({\r\n      id: `word-${word}-${index}`,\r\n      content: word,\r\n    }))\r\n  }\r\n\r\n  const [availableWords, setAvailableWords] = useState<WordItem[]>(createWordItems(words))\r\n  const [selectedWords, setSelectedWords] = useState<WordItem[]>([])\r\n  const [feedback, setFeedback] = useState<{\r\n    visible: boolean\r\n    isCorrect: boolean\r\n    message: string\r\n  }>({ visible: false, isCorrect: false, message: \"\" })\r\n  const [blankPositions, setBlankPositions] = useState<number[]>([])\r\n\r\n  function getSentenceScrambleTitles() {\r\n    return [\r\n      \"Can you make the correct sentence?\",\r\n      \"Can you put these words in the right order?\",\r\n      \"Can you build the correct sentence?\",\r\n      \"Can you arrange the words to form a sentence?\",\r\n      \"Can you unscramble these words into a sentence?\",\r\n      \"Can you create the correct sentence from these words?\",\r\n      \"Can you fix the word order to make a sentence?\",\r\n      \"Can you reorder the words correctly?\",\r\n      \"Can you piece the words together into a sentence?\",\r\n      \"Can you make sense of these words?\"\r\n    ];\r\n  }\r\n\r\n  const randomTitle = useMemo(() => {\r\n    const titles = getSentenceScrambleTitles();\r\n    return titles[Math.floor(Math.random() * titles.length)];\r\n  }, [])\r\n\r\n  // Find blank positions in the sentence for fill_in_blanks type\r\n  useEffect(() => {\r\n    if (type === \"fill_in_blanks\") {\r\n      const positions: number[] = []\r\n      const parts = sentence.split(\" \")\r\n      parts.forEach((part, index) => {\r\n        if (part === \"___\") {\r\n          positions.push(positions.length + 1)\r\n        }\r\n      })\r\n      setBlankPositions(positions)\r\n    }\r\n  }, [sentence, type])\r\n\r\n  // Reset exercise when incoming content actually changes (not just new array refs)\r\n  const resetKeyRef = useRef<string>(\"\")\r\n  useEffect(() => {\r\n    const key = `${question}|${sentence}|${words.join(\"||\")}`\r\n    if (resetKeyRef.current === key) return\r\n    resetKeyRef.current = key\r\n    setAvailableWords(createWordItems(words))\r\n    setSelectedWords([])\r\n    setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n  }, [words, sentence, question])\r\n\r\n  // Sync from parent in controlled mode so previously saved answers render\r\n  // and readOnly view shows the user's selection.\r\n  useEffect(() => {\r\n    if (!controlled) return\r\n    const incoming = Array.isArray(value) ? value : []\r\n    // Build items from current words and split into selected/available\r\n    const allItems = createWordItems(words)\r\n    const usedIndexes: number[] = []\r\n    const selected: WordItem[] = []\r\n\r\n    for (const token of incoming) {\r\n      const idx = allItems.findIndex((it, i) => it.content === token && !usedIndexes.includes(i))\r\n      if (idx >= 0) {\r\n        selected.push(allItems[idx])\r\n        usedIndexes.push(idx)\r\n      }\r\n    }\r\n\r\n    // For sentence scramble, shuffle available words to randomize order\r\n    const available = allItems.filter((_, i) => !usedIndexes.includes(i))\r\n    const shuffledAvailable = type === \"sentence_scramble\" ? \r\n      available.sort(() => Math.random() - 0.5) : available\r\n    \r\n    setSelectedWords(selected)\r\n    setAvailableWords(shuffledAvailable)\r\n  }, [controlled, value, words, type])\r\n\r\n  // Handle clicking on a word in the word bank\r\n  const handleWordBankClick = (word: WordItem) => {\r\n    if (controlled && readOnly) return\r\n    // For fill_in_blanks, assign the next available position\r\n    const updatedWord = { ...word }\r\n\r\n    if (type === \"fill_in_blanks\") {\r\n      const usedPositions = selectedWords.map((w) => w.position).filter((p) => p !== undefined) as number[]\r\n      const availablePositions = blankPositions.filter((p) => !usedPositions.includes(p))\r\n\r\n      if (availablePositions.length > 0) {\r\n        updatedWord.position = availablePositions[0]\r\n      }\r\n    }\r\n\r\n    // Move word from available to selected\r\n    setAvailableWords((prev) => prev.filter((w) => w.id !== word.id))\r\n    setSelectedWords((prev) => [...prev, updatedWord])\r\n\r\n    // Hide feedback when user makes changes\r\n    if (feedback.visible) {\r\n      setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n    }\r\n  }\r\n\r\n  // Handle clicking on a word in the answer area\r\n  const handleAnswerWordClick = (word: WordItem) => {\r\n    if (controlled && readOnly) return\r\n    // Move word from selected back to available\r\n    setSelectedWords((prev) => prev.filter((w) => w.id !== word.id))\r\n    // Add word to the end of available words instead of original position\r\n    setAvailableWords((prev) => [...prev, { ...word, position: undefined }])\r\n\r\n    // Hide feedback when user makes changes\r\n    if (feedback.visible) {\r\n      setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n    }\r\n  }\r\n\r\n  const handleCheck = () => {\r\n    if (correctAnswer) {\r\n      let isCorrect = false\r\n\r\n      if (type === \"fill_in_blanks\") {\r\n        // For fill_in_blanks, check if words are in the correct positions\r\n        const userAnswerByPosition = new Map<number, string>()\r\n        selectedWords.forEach((word) => {\r\n          if (word.position !== undefined) {\r\n            userAnswerByPosition.set(word.position, word.content)\r\n          }\r\n        })\r\n\r\n        // Check if all positions are filled and with correct words using Vietnamese normalization\r\n        isCorrect = correctAnswer.every((word, index) => {\r\n          const userWord = userAnswerByPosition.get(index + 1) || ''\r\n          return normalizeForComparison(userWord) === normalizeForComparison(word)\r\n        })\r\n      } else {\r\n        // For other types, check the sequence using Vietnamese normalization\r\n        const userAnswer = selectedWords.map((item) => item.content)\r\n        const userSentence = userAnswer.join(\" \")\r\n        const correctSentence = correctAnswer.join(\" \")\r\n\r\n        // Normalize both sentences for comparison\r\n        const normalizedUser = normalizeForComparison(userSentence)\r\n        const normalizedCorrect = normalizeForComparison(correctSentence)\r\n        isCorrect = normalizedUser === normalizedCorrect\r\n      }\r\n\r\n      if (!controlled) {\r\n        setFeedback({\r\n          visible: true,\r\n          isCorrect,\r\n          message: isCorrect ? \"Correct! Great job!\" : \"Not quite right. Try again!\",\r\n        })\r\n        if (onComplete) {\r\n          onComplete(\r\n            isCorrect,\r\n            selectedWords.map((w) => w.content),\r\n          )\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleReset = () => {\r\n    setAvailableWords(createWordItems(words))\r\n    setSelectedWords([])\r\n    setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n  }\r\n\r\n  // Use ref to track previous answer to prevent infinite loops\r\n  const prevAnswerRef = useRef<string[]>([])\r\n  \r\n  // Report answer changes upward only after render to avoid parent setState during child render\r\n  useEffect(() => {\r\n    if (controlled) {\r\n      const currentAnswer = selectedWords.map((w) => w.content)\r\n      const prevAnswer = prevAnswerRef.current\r\n      \r\n      // Only call onAnswerChange if the answer has actually changed\r\n      if (JSON.stringify(currentAnswer) !== JSON.stringify(prevAnswer)) {\r\n        prevAnswerRef.current = currentAnswer\r\n        onAnswerChange?.(currentAnswer)\r\n      }\r\n    }\r\n    // Intentionally omit onAnswerChange to avoid effect loop on changing callback identity\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [controlled, selectedWords])\r\n\r\n  // Render sentence with numbered blanks for fill_in_blanks type\r\n  const renderSentence = () => {\r\n    if (type === \"fill_in_blanks\") {\r\n      const parts = sentence.split(\" \")\r\n      let blankCount = 0\r\n\r\n      return parts.map((part, index) => {\r\n        if (part === \"___\") {\r\n          blankCount++\r\n          return (\r\n            <span key={index} className=\"mx-1\">\r\n              <span className=\"text-primary font-medium\">({blankCount})</span>\r\n              <span className=\"border-b-2 border-primary px-2\">___</span>\r\n            </span>\r\n          )\r\n        }\r\n        return (\r\n          <span key={index} className=\"mr-1\">\r\n            {part}\r\n          </span>\r\n        )\r\n      })\r\n    } else if (type === \"translation\" && sentence) {\r\n      // For translation, show the source sentence as reference\r\n      return (\r\n        <div className=\"space-y-2\">\r\n          <div className=\"text-sm text-gray-600\">English:</div>\r\n          <div className=\"text-lg font-medium\">{sentence}</div>\r\n          <div className=\"text-sm text-gray-600\">Vietnamese (arrange the words below):</div>\r\n        </div>\r\n      )\r\n    } else if (highlightedWords && highlightedWords.length > 0) {\r\n      const parts = sentence.split(\" \")\r\n      return parts.map((part, index) => {\r\n        const isHighlighted = highlightedWords.includes(part)\r\n        return (\r\n          <span key={index} className={cn(\"mr-1\", isHighlighted && \"text-primary font-medium underline\")}>\r\n            {part}\r\n          </span>\r\n        )\r\n      })\r\n    }\r\n    return sentence\r\n  }\r\n\r\n  // Sort selected words by position for fill_in_blanks\r\n  const sortedSelectedWords = () => {\r\n    if (type === \"fill_in_blanks\") {\r\n      return [...selectedWords].sort((a, b) => {\r\n        const posA = a.position || Number.MAX_SAFE_INTEGER\r\n        const posB = b.position || Number.MAX_SAFE_INTEGER\r\n        return posA - posB\r\n      })\r\n    }\r\n    return selectedWords\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto\">\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">\r\n          {type === \"sentence_scramble\" ? randomTitle : question}\r\n        </h2>\r\n\r\n        <div className=\"flex items-center mb-4\">\r\n          {characterImageUrl && (\r\n            <div className=\"mr-4\">\r\n              <img src={characterImageUrl || \"/placeholder.svg\"} alt=\"Character\" className=\"w-16 h-16 object-contain\" />\r\n            </div>\r\n          )}\r\n\r\n          <Card className=\"p-3 flex items-center\">\r\n            {audioUrl && (\r\n              <Button variant=\"ghost\" size=\"icon\" className=\"mr-2\" onClick={() => new Audio(audioUrl).play()}>\r\n                <Volume2 className=\"h-4 w-4\" />\r\n              </Button>\r\n            )}\r\n            <div className=\"text-lg\">{renderSentence()}</div>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Answer Area */}\r\n      <div\r\n        className={cn(\r\n          \"min-h-24 w-full border-2 border-dashed rounded-md p-4 mb-6 flex flex-wrap items-center\",\r\n          selectedWords.length > 0 ? \"border-primary bg-primary/5\" : \"border-gray-300 bg-gray-50\",\r\n        )}\r\n      >\r\n        {selectedWords.length > 0 ? (\r\n          sortedSelectedWords().map((word) => (\r\n            <Word key={word.id} word={word} onClick={handleAnswerWordClick} isSelected={true} />\r\n          ))\r\n        ) : (\r\n          <div className=\"w-full text-center text-gray-400\">\r\n            {type === \"translation\" && \"Click words below to form the Vietnamese translation\"}\r\n            {type === \"fill_in_blanks\" && \"Click words below to fill in the blanks\"}\r\n            {type === \"sentence_scramble\" && \"Click words below to unscramble the sentence\"}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Word Bank */}\r\n      <div className=\"p-4 border-2 border-gray-200 rounded-md mb-6\">\r\n        <div className=\"flex flex-wrap\">\r\n          {availableWords.map((word) => (\r\n            <Word key={word.id} word={word} onClick={handleWordBankClick} />\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Feedback Alert */}\r\n      {!controlled && !disableInlineFeedback && feedback.visible && (\r\n        <Alert className={cn(\"mb-6\", feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\")}>\r\n          <div className=\"flex items-center\">\r\n            {feedback.isCorrect ? (\r\n              <CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n            ) : (\r\n              <XCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            )}\r\n            <AlertDescription>{feedback.message}</AlertDescription>\r\n          </div>\r\n        </Alert>\r\n      )}\r\n\r\n      {!hideActions && (\r\n        <div className=\"flex justify-between\">\r\n          <Button variant=\"outline\" onClick={handleReset}>\r\n            Reset\r\n          </Button>\r\n          {!controlled && <Button onClick={handleCheck}>Check Answer</Button>}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState, useRef, useEffect, useMemo } from \"react\"\r\nimport { Card } from \"@/shared/components/ui/card\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\n\r\ninterface SynonymPair {\r\n  id: number\r\n  word1: string\r\n  word2: string\r\n  meaning?: string // Optional English meaning for reference\r\n}\r\n\r\ninterface SynonymsMatchingProps {\r\n  pairs: SynonymPair[]\r\n  onComplete?: (isCorrect: boolean) => void\r\n  // Controlled: report progress to container; container handles submit/finalize\r\n  controlled?: boolean\r\n  onAnswerChange?: (matchedPairIds: number[]) => void\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function SynonymsMatching({ pairs, onComplete, controlled = false, onAnswerChange, readOnly = false }: SynonymsMatchingProps) {\r\n  const [selectedWords, setSelectedWords] = useState<Set<number>>(new Set())\r\n  const [matchedPairs, setMatchedPairs] = useState<Set<number>>(new Set())\r\n  const [hoverWord, setHoverWord] = useState<number | null>(null)\r\n  const [lines, setLines] = useState<any[]>([])\r\n\r\n  const [incorrectPair, setIncorrectPair] = useState<{ first: number | null; second: number | null }>({\r\n    first: null,\r\n    second: null,\r\n  })\r\n  const [showStars, setShowStars] = useState(false)\r\n  const [lastSelectedIndex, setLastSelectedIndex] = useState<number | null>(null)\r\n\r\n  const wordRefs = useRef<(HTMLDivElement | null)[]>([])\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n\r\n  // Select random synonym pairs\r\n  const selectedPairs = useMemo(() => {\r\n    return pairs\r\n  }, [pairs])\r\n\r\n  // Create a flat array of all words from both columns\r\n  const allWords = useMemo(() => {\r\n    const words: { id: number; text: string; pairId: number }[] = []\r\n    selectedPairs.forEach((pair) => {\r\n      words.push({ id: words.length, text: pair.word1, pairId: pair.id })\r\n      words.push({ id: words.length, text: pair.word2, pairId: pair.id })\r\n    })\r\n    return words.sort(() => Math.random() - 0.5) // Shuffle the words\r\n  }, [selectedPairs])\r\n\r\n  // Get the correct pair ID for each word\r\n  const wordToPairId = useMemo(() => {\r\n    const map: Record<number, number> = {}\r\n    allWords.forEach((word) => {\r\n      map[word.id] = word.pairId\r\n    })\r\n    return map\r\n  }, [allWords])\r\n\r\n  function getSynonymMatchingTitles() {\r\n    const titles = {\r\n      h1: [\r\n        \"Find the Matching Synonyms\",\r\n        \"Pair the Words with Their Synonyms\",\r\n        \"Connect Each Word with Its Synonym\",\r\n        \"Synonym Matching Challenge\",\r\n        \"Match Words with the Same Meaning\"\r\n      ],\r\n      h2: [\r\n        \"Link words that share similar meanings\",\r\n        \"Test your synonym knowledge\",\r\n        \"Which words go together?\",\r\n        \"Check your vocabulary connections\",\r\n        \"Practice recognizing synonyms\"\r\n      ]\r\n    };\r\n  \r\n    return titles;\r\n  }\r\n\r\n  // Generate random titles once when component mounts\r\n  const randomTitles = useMemo(() => {\r\n    const titles = getSynonymMatchingTitles()\r\n    return {\r\n      h1: titles.h1[Math.floor(Math.random() * titles.h1.length)],\r\n      h2: titles.h2[Math.floor(Math.random() * titles.h2.length)]\r\n    }\r\n  }, [])\r\n\r\n  \r\n\r\n  // Report progress upward in controlled mode\r\n  useEffect(() => {\r\n    if (controlled && !readOnly) {\r\n      onAnswerChange?.(Array.from(matchedPairs))\r\n    }\r\n    // Intentionally omit onAnswerChange to avoid effect loops on new function identity\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [controlled, matchedPairs, readOnly])\r\n\r\n  const handleWordClick = (wordId: number) => {\r\n    if (readOnly) return\r\n    if (selectedWords.has(wordId)) {\r\n      // Deselect if already selected\r\n      const newSelectedWords = new Set(selectedWords)\r\n      newSelectedWords.delete(wordId)\r\n      setSelectedWords(newSelectedWords)\r\n      setLastSelectedIndex(null)\r\n      return\r\n    }\r\n\r\n    if (selectedWords.size === 0) {\r\n      // First word selected\r\n      setSelectedWords(new Set([wordId]))\r\n      setLastSelectedIndex(wordId)\r\n      return\r\n    }\r\n\r\n    // Second word selected - check if it's a match with the first word\r\n    const firstWordId = lastSelectedIndex\r\n    if (firstWordId !== null) {\r\n      const pairId1 = wordToPairId[firstWordId]\r\n      const pairId2 = wordToPairId[wordId]\r\n\r\n      if (pairId1 === pairId2) {\r\n        // Correct match\r\n        setMatchedPairs(new Set([...matchedPairs, pairId1]))\r\n        setSelectedWords(new Set())\r\n        setLastSelectedIndex(null)\r\n        setShowStars(true)\r\n        setTimeout(() => setShowStars(false), 1500)\r\n      } else {\r\n        // Incorrect match\r\n        setIncorrectPair({ first: firstWordId, second: wordId })\r\n        setTimeout(() => {\r\n          setIncorrectPair({ first: null, second: null })\r\n          setSelectedWords(new Set())\r\n          setLastSelectedIndex(null)\r\n        }, 1000)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check if a word is matched\r\n  const isWordMatched = (wordId: number) => {\r\n    const pairId = wordToPairId[wordId]\r\n    return matchedPairs.has(pairId)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <style jsx>{`\r\n        @keyframes star {\r\n          0% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          50% {\r\n            transform: scale(1.5) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n          100% {\r\n            transform: scale(0) rotate(360deg);\r\n            opacity: 0;\r\n          }\r\n        }\r\n        .animate-star {\r\n          animation: star 1.5s ease-out forwards;\r\n          font-size: 1.5rem;\r\n        }\r\n        @keyframes pulse-shadow {\r\n          0% {\r\n            box-shadow: 0 0 15px rgba(255, 165, 0, 0.5);\r\n          }\r\n          50% {\r\n            box-shadow: 0 0 20px rgba(255, 165, 0, 0.8);\r\n          }\r\n          100% {\r\n            box-shadow: 0 0 15px rgba(255, 165, 0, 0.5);\r\n          }\r\n        }\r\n        .pulse-highlight {\r\n          animation: pulse-shadow 1.5s infinite ease-in-out;\r\n        }\r\n      `}</style>\r\n      <div className=\"max-w-4xl mx-auto p-6 relative\" ref={containerRef}>\r\n        <h1 className=\"text-2xl font-bold mb-8\">{randomTitles.h1}</h1>\r\n        <h2 className=\"text-lg font-medium mb-8\">{randomTitles.h2}</h2> \r\n        \r\n        {/* Stars animation for correct matches \r\n        {showStars && (\r\n          <div className=\"absolute inset-0 pointer-events-none z-20 overflow-hidden\">\r\n            {Array.from({ length: 20 }).map((_, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"absolute animate-star text-yellow-400\"\r\n                style={{\r\n                  left: `${Math.random() * 100}%`,\r\n                  top: `${Math.random() * 100}%`,\r\n                  animationDelay: `${Math.random() * 0.5}s`,\r\n                  animationDuration: `${0.5 + Math.random() * 1}s`,\r\n                }}\r\n              >\r\n                âœ¦\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n          */}\r\n\r\n        <div className=\"grid grid-cols-2 gap-x-14 gap-y-5\">\r\n          {allWords.map((word, index) => (\r\n            <Card\r\n              key={word.id}\r\n              ref={(el) => (wordRefs.current[word.id] = el)}\r\n              className={cn(\r\n                \"p-4 cursor-pointer transition-all duration-300 relative\",\r\n                selectedWords.has(word.id) && \"bg-orange-100 border-orange-500\",\r\n                isWordMatched(word.id) ? \"bg-gray-100 border-gray-300 text-gray-500\" : \"\",\r\n                incorrectPair.first === word.id || incorrectPair.second === word.id ? \"border-2 border-red-500\" : \"\",\r\n                isWordMatched(word.id) && showStars && \"border-2 border-green-500\",\r\n                // Add highlight effect with animation for hovered word when a word is selected\r\n                hoverWord === word.id &&\r\n                  lastSelectedIndex !== null &&\r\n                  lastSelectedIndex !== word.id &&\r\n                  !isWordMatched(word.id) &&\r\n                  \"scale-105 bg-orange-50 border-orange-300 pulse-highlight\",\r\n              )}\r\n              onClick={() => !isWordMatched(word.id) && handleWordClick(word.id)}\r\n              onMouseEnter={() => setHoverWord(word.id)}\r\n              onMouseLeave={() => setHoverWord(null)}\r\n            >\r\n              <div className=\"flex items-center gap-4\">\r\n                <span\r\n                  className={cn(\r\n                    \"w-8 h-8 flex items-center justify-center rounded-full\",\r\n                    isWordMatched(word.id) ? \"bg-gray-200 text-gray-500\" : \"bg-gray-100\",\r\n                  )}\r\n                >\r\n                  {index + 1}\r\n                </span>\r\n                <span className=\"text-lg\">{word.text}</span>\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n        {/* No Play Again; container manages navigation */}\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\n","\"use client\"\r\n\r\nimport { useState, useRef, useEffect, useMemo } from \"react\"\r\nimport { Card } from \"@/shared/components/ui/card\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\n\r\ninterface WordPair {\r\n  id: number\r\n  english: string\r\n  vietnamese: string\r\n}\r\n\r\ninterface Position {\r\n  x: number\r\n  y: number\r\n}\r\n\r\ninterface WordsMatchingProps {\r\n  pairs: WordPair[]\r\n  onComplete?: (isCorrect: boolean) => void\r\n  controlled?: boolean\r\n  onAnswerChange?: (matchedPairIds: number[]) => void\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function WordsMatching({ pairs, onComplete, controlled = false, onAnswerChange, readOnly = false }: WordsMatchingProps) {\r\n  const [selectedLeft, setSelectedLeft] = useState<number | null>(null)\r\n  const [selectedRight, setSelectedRight] = useState<number | null>(null)\r\n  const [matchedPairs, setMatchedPairs] = useState<Set<number>>(new Set())\r\n  const [hoverRight, setHoverRight] = useState<number | null>(null)\r\n  const [line, setLine] = useState<{ start: Position; end: Position } | null>(null)\r\n  const [incorrectPair, setIncorrectPair] = useState<{ left: number | null; right: number | null }>({\r\n    left: null,\r\n    right: null,\r\n  })\r\n  const [showStars, setShowStars] = useState(false)\r\n  const [lines, setLines] = useState<any[]>([])\r\n\r\n  const leftRefs = useRef<(HTMLDivElement | null)[]>([])\r\n  const rightRefs = useRef<(HTMLDivElement | null)[]>([])\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n\r\n  // Shuffle the Vietnamese words once on mount, but keep the order fixed\r\n  const shuffledIndices = useMemo(() => {\r\n    return [...pairs.map((_, i) => i)].sort(() => Math.random() - 0.5)\r\n  }, [pairs])\r\n\r\n  // Get the shuffled Vietnamese words using the shuffled indices\r\n  const vietnameseWords = useMemo(() => {\r\n    return shuffledIndices.map((index) => pairs[index].vietnamese)\r\n  }, [shuffledIndices, pairs])\r\n\r\n  // Map from shuffled index to original word pair id\r\n  const shuffledIndexToWordPairId = useMemo(() => {\r\n    const map: Record<number, number> = {}\r\n    shuffledIndices.forEach((originalIndex, shuffledIndex) => {\r\n      map[shuffledIndex] = pairs[originalIndex].id\r\n    })\r\n    return map\r\n  }, [shuffledIndices, pairs])\r\n\r\n  // Map from word pair id to shuffled index\r\n  const wordPairIdToShuffledIndex = useMemo(() => {\r\n    const map: Record<number, number> = {}\r\n    shuffledIndices.forEach((originalIndex, shuffledIndex) => {\r\n      map[pairs[originalIndex].id] = shuffledIndex\r\n    })\r\n    return map\r\n  }, [shuffledIndices, pairs])\r\n\r\n  // Report progress upward in controlled mode\r\n  useEffect(() => {\r\n    if (controlled && !readOnly) {\r\n      onAnswerChange?.(Array.from(matchedPairs))\r\n    }\r\n    // Intentionally omit onAnswerChange to avoid loop\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [controlled, matchedPairs, readOnly])\r\n\r\n  const handleLeftClick = (id: number) => {\r\n    if (readOnly) return\r\n    if (matchedPairs.has(id)) return\r\n\r\n    // If right is already selected, check for match\r\n    if (selectedRight !== null) {\r\n      const correctShuffledIndex = wordPairIdToShuffledIndex[id]\r\n      const isMatch = selectedRight === correctShuffledIndex\r\n\r\n      if (isMatch) {\r\n        // Correct match\r\n        setMatchedPairs(new Set([...matchedPairs, id]))\r\n        setSelectedLeft(null)\r\n        setSelectedRight(null)\r\n        setLine(null)\r\n        setShowStars(true)\r\n        setTimeout(() => setShowStars(false), 1500)\r\n        return\r\n      } else {\r\n        // Incorrect match\r\n        setIncorrectPair({ left: id, right: selectedRight })\r\n        setTimeout(() => {\r\n          setIncorrectPair({ left: null, right: null })\r\n        }, 1000)\r\n      }\r\n    }\r\n\r\n    // Toggle selection\r\n    setSelectedLeft(selectedLeft === id ? null : id)\r\n    setSelectedRight(null)\r\n  }\r\n\r\n  const handleRightClick = (index: number) => {\r\n    if (readOnly) return\r\n    if (matchedRightIndices[index]) return\r\n\r\n    // If left is already selected, check for match\r\n    if (selectedLeft !== null) {\r\n      const correctWordPairId = shuffledIndexToWordPairId[index]\r\n      const isMatch = selectedLeft === correctWordPairId\r\n\r\n      if (isMatch) {\r\n        // Correct match\r\n        setMatchedPairs(new Set([...matchedPairs, selectedLeft]))\r\n        setSelectedLeft(null)\r\n        setSelectedRight(null)\r\n        setLine(null)\r\n        setShowStars(true)\r\n        setTimeout(() => setShowStars(false), 1500)\r\n        return\r\n      } else {\r\n        // Incorrect match\r\n        setIncorrectPair({ left: selectedLeft, right: index })\r\n        setTimeout(() => {\r\n          setIncorrectPair({ left: null, right: null })\r\n        }, 1000)\r\n      }\r\n    }\r\n\r\n    // Toggle selection\r\n    setSelectedRight(selectedRight === index ? null : index)\r\n    setSelectedLeft(null)\r\n  }\r\n\r\n  // Calculate line position when hovering over right items\r\n  useEffect(() => {\r\n    if (!containerRef.current || selectedLeft === null || hoverRight === null) {\r\n      setLine(null)\r\n      return\r\n    }\r\n\r\n    // Don't draw line if the left word is already matched\r\n    if (matchedPairs.has(selectedLeft)) {\r\n      setLine(null)\r\n      return\r\n    }\r\n\r\n    const leftElement = leftRefs.current[pairs.findIndex((p) => p.id === selectedLeft)]\r\n    const rightElement = rightRefs.current[hoverRight]\r\n\r\n    if (!leftElement || !rightElement) {\r\n      setLine(null)\r\n      return\r\n    }\r\n\r\n    const containerRect = containerRef.current.getBoundingClientRect()\r\n    const leftRect = leftElement.getBoundingClientRect()\r\n    const rightRect = rightElement.getBoundingClientRect()\r\n\r\n    // Start at the right edge of the left card\r\n    const start = {\r\n      x: leftRect.right - containerRect.left,\r\n      y: leftRect.top + leftRect.height / 2 - containerRect.top,\r\n    }\r\n\r\n    // End at the left edge of the right card\r\n    const end = {\r\n      x: rightRect.left - containerRect.left,\r\n      y: rightRect.top + rightRect.height / 2 - containerRect.top,\r\n    }\r\n\r\n    setLine({ start, end })\r\n  }, [selectedLeft, hoverRight, matchedPairs, pairs])\r\n\r\n  // Memoize the matched pair IDs for the right column\r\n  const matchedRightIndices = useMemo(() => {\r\n    const indices: Record<number, boolean> = {}\r\n\r\n    matchedPairs.forEach((id) => {\r\n      const index = wordPairIdToShuffledIndex[id]\r\n      if (index !== undefined) {\r\n        indices[index] = true\r\n      }\r\n    })\r\n\r\n    return indices\r\n  }, [matchedPairs, wordPairIdToShuffledIndex])\r\n\r\n  function getWordMatchingTitles() {\r\n    return [\r\n      \"Match the English words with their Vietnamese meanings\",\r\n      \"Find the correct pairs of words\",\r\n      \"Connect each word with its translation\",\r\n      \"Pair the words with their correct meanings\",\r\n      \"Link the English words to the right Vietnamese words\",\r\n      \"Make the correct matches\",\r\n      \"Which words go together?\",\r\n      \"Choose the pairs that match\"\r\n    ];\r\n  }\r\n  const randomTitle = useMemo(() => {\r\n    const titles = getWordMatchingTitles();\r\n    return titles[Math.floor(Math.random() * titles.length)];\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      className=\"max-w-2xl mx-auto p-6 relative\"\r\n      ref={containerRef}\r\n      onMouseLeave={() => {\r\n        setHoverRight(null)\r\n        if (!selectedLeft && !selectedRight) {\r\n          setLine(null)\r\n        }\r\n      }}\r\n    >\r\n      <h1 className=\"text-2xl font-bold mb-8\">{randomTitle}</h1>\r\n\r\n      {/* SVG for drawing lines */}\r\n      <svg className=\"absolute top-0 left-0 w-full h-full pointer-events-none z-10\">\r\n        {line && (\r\n          <line\r\n            x1={line.start.x}\r\n            y1={line.start.y}\r\n            x2={line.end.x}\r\n            y2={line.end.y}\r\n            stroke=\"orange\"\r\n            strokeWidth=\"2\"\r\n            strokeDasharray=\"5,5\"\r\n          />\r\n        )}\r\n        {lines.map((line, index) => (\r\n          <line\r\n            key={index}\r\n            x1={line.start.x}\r\n            y1={line.start.y}\r\n            x2={line.end.x}\r\n            y2={line.end.y}\r\n            stroke=\"green\"\r\n            strokeWidth=\"2\"\r\n          />\r\n        ))}\r\n      </svg>\r\n\r\n      <div className=\"grid grid-cols-2 gap-6\">\r\n        <div className=\"space-y-4\">\r\n          {pairs.map((pair, idx) => (\r\n            <Card\r\n              key={pair.id}\r\n              ref={(el) => (leftRefs.current[idx] = el)}\r\n              className={cn(\r\n                \"p-4 cursor-pointer transition-colors relative\",\r\n                selectedLeft === pair.id && \"bg-orange-100 border-orange-500\",\r\n                matchedPairs.has(pair.id) ? \"bg-gray-100 border-gray-300 text-gray-500\" : \"\",\r\n                incorrectPair.left === pair.id && \"border-2 border-red-500\",\r\n                matchedPairs.has(pair.id) && showStars && \"border-2 border-green-500\",\r\n              )}\r\n              onClick={() => handleLeftClick(pair.id)}\r\n            >\r\n              <div className=\"flex items-center gap-4\">\r\n                <span\r\n                  className={cn(\r\n                    \"w-8 h-8 flex items-center justify-center rounded-full\",\r\n                    matchedPairs.has(pair.id) ? \"bg-gray-200 text-gray-500\" : \"bg-gray-100\",\r\n                  )}\r\n                >\r\n                  {idx + 1}\r\n                </span>\r\n                <span className=\"text-lg\">{pair.english}</span>\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n        <div className=\"space-y-4\">\r\n          {vietnameseWords.map((word, index) => (\r\n            <Card\r\n              key={index}\r\n              ref={(el) => (rightRefs.current[index] = el)}\r\n              className={cn(\r\n                \"p-4 cursor-pointer transition-colors relative\",\r\n                selectedRight === index && \"bg-orange-100 border-orange-500\",\r\n                matchedRightIndices[index] ? \"bg-gray-100 border-gray-300 text-gray-500\" : \"\",\r\n                incorrectPair.right === index && \"border-2 border-red-500\",\r\n                matchedRightIndices[index] && showStars && \"border-2 border-green-500\",\r\n              )}\r\n              onClick={() => handleRightClick(index)}\r\n              onMouseEnter={() => {\r\n                if (selectedLeft !== null && !matchedRightIndices[index]) {\r\n                  setHoverRight(index)\r\n                }\r\n              }}\r\n              onMouseLeave={() => {\r\n                if (hoverRight === index) {\r\n                  setHoverRight(null)\r\n                }\r\n              }}\r\n            >\r\n              <div className=\"flex items-center gap-4\">\r\n                <span\r\n                  className={cn(\r\n                    \"w-8 h-8 flex items-center justify-center rounded-full\",\r\n                    matchedRightIndices[index] ? \"bg-gray-200 text-gray-500\" : \"bg-gray-100\",\r\n                  )}\r\n                >\r\n                  {index + 6}\r\n                </span>\r\n                <span className=\"text-lg\">{word}</span>\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {/* No Play Again in controlled flow */}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport { CheckCircle, XCircle } from \"lucide-react\"\r\nimport { normalizeForComparison } from \"@/shared/utils/vi-normalize\"\r\n\r\nexport interface ErrorCorrectionItem {\r\n  id: string\r\n  prompt: string\r\n  faultySentence: string\r\n  target: string\r\n  hint?: string\r\n}\r\n\r\ninterface ErrorCorrectionProps {\r\n  question: string\r\n  faultySentence: string\r\n  target: string\r\n  hint?: string\r\n  onComplete?: (isCorrect: boolean, answer?: string) => void\r\n  // Controlled mode for container\r\n  controlled?: boolean\r\n  value?: string | null\r\n  onAnswerChange?: (answer: string) => void\r\n  disableInlineFeedback?: boolean\r\n  hideActions?: boolean\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function ErrorCorrection({\r\n  question,\r\n  faultySentence,\r\n  target,\r\n  hint,\r\n  onComplete,\r\n  controlled = false,\r\n  value = null,\r\n  onAnswerChange,\r\n  disableInlineFeedback = false,\r\n  hideActions = false,\r\n  readOnly = false,\r\n}: ErrorCorrectionProps) {\r\n  const [input, setInput] = useState<string>(value ?? faultySentence)\r\n  const [submitted, setSubmitted] = useState<boolean>(false)\r\n  const [result, setResult] = useState<{\r\n    isCorrect: boolean\r\n    message: string\r\n  } | null>(null)\r\n\r\n  const diffWords = (a: string, b: string): Array<{ type: \"equal\" | \"add\" | \"del\"; text: string }> => {\r\n    const A = a.split(/\\s+/), B = b.split(/\\s+/)\r\n    const dp: number[][] = Array(A.length + 1)\r\n      .fill(null)\r\n      .map(() => Array(B.length + 1).fill(0))\r\n    for (let i = 1; i <= A.length; i++) {\r\n      for (let j = 1; j <= B.length; j++) {\r\n        dp[i][j] = A[i - 1] === B[j - 1] ? dp[i - 1][j - 1] + 1 : Math.max(dp[i - 1][j], dp[i][j - 1])\r\n      }\r\n    }\r\n    const res: Array<{ type: \"equal\" | \"add\" | \"del\"; text: string }> = []\r\n    let i = A.length, j = B.length\r\n    while (i > 0 && j > 0) {\r\n      if (A[i - 1] === B[j - 1]) {\r\n        res.unshift({ type: \"equal\", text: A[i - 1] })\r\n        i--; j--\r\n      } else if (dp[i - 1][j] >= dp[i][j - 1]) {\r\n        res.unshift({ type: \"del\", text: A[i - 1] })\r\n        i--\r\n      } else {\r\n        res.unshift({ type: \"add\", text: B[j - 1] })\r\n        j--\r\n      }\r\n    }\r\n    while (i > 0) { res.unshift({ type: \"del\", text: A[i - 1] }); i-- }\r\n    while (j > 0) { res.unshift({ type: \"add\", text: B[j - 1] }); j-- }\r\n    return res\r\n  }\r\n\r\n  const handleCheck = () => {\r\n    // Use Vietnamese normalization that handles diacritics and punctuation\r\n    const normalizedInput = normalizeForComparison(input)\r\n    const normalizedTarget = normalizeForComparison(target)\r\n    const isCorrect = normalizedInput === normalizedTarget\r\n    const message = isCorrect ? \"Correct! Great job!\" : \"Not quite right. Try again!\"\r\n\r\n    if (!controlled) {\r\n      setResult({ isCorrect, message })\r\n      setSubmitted(true)\r\n      if (onComplete) {\r\n        onComplete(isCorrect, input)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleReset = () => {\r\n    setInput(faultySentence)\r\n    setSubmitted(false)\r\n    setResult(null)\r\n  }\r\n\r\n  const fillCorrectAnswer = () => {\r\n    setInput(target)\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto space-y-6\">\r\n      <div className=\"text-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">{question}</h2>\r\n        <p className=\"text-gray-600\">Original sentence: <span className=\"font-medium\">{faultySentence}</span></p>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <textarea\r\n            className=\"w-full rounded-md border p-3 focus:outline-none focus:ring-2 focus:ring-primary resize-none\"\r\n            rows={4}\r\n            value={input}\r\n            onChange={(e) => {\r\n              setInput(e.target.value)\r\n              if (controlled) onAnswerChange?.(e.target.value)\r\n            }}\r\n            placeholder=\"Correct the sentence here...\"\r\n            disabled={readOnly}\r\n          />\r\n          {hint && (\r\n            <div className=\"mt-3 text-sm text-blue-600 bg-blue-50 p-3 rounded-md\">\r\n              ðŸ’¡ Hint: {hint}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {!hideActions && (\r\n        <div className=\"flex justify-center gap-3\">\r\n          <Button variant=\"outline\" onClick={handleReset}>\r\n            Reset\r\n          </Button>\r\n          {!controlled && (\r\n            <Button variant=\"outline\" onClick={fillCorrectAnswer}>\r\n              Show Correct Answer\r\n            </Button>\r\n          )}\r\n          {!controlled && (\r\n            <Button onClick={handleCheck} disabled={submitted}>\r\n              Check Answer\r\n            </Button>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {!controlled && submitted && result && (\r\n        <Alert className={cn(\"mb-6\", result.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\")}>\r\n          <div className=\"flex items-center\">\r\n            {result.isCorrect ? (\r\n              <CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n            ) : (\r\n              <XCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            )}\r\n            <AlertDescription>{result.message}</AlertDescription>\r\n          </div>\r\n        </Alert>\r\n      )}\r\n\r\n      {!controlled && submitted && result && !result.isCorrect && (\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"text-sm text-gray-600 mb-2\">Reference answer:</div>\r\n            <div className=\"bg-gray-50 p-3 rounded-md font-medium\">{target}</div>\r\n            <div className=\"mt-3 text-sm\">\r\n              <div className=\"text-gray-600 mb-2\">Differences:</div>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {diffWords(input, target).map((d, idx) => (\r\n                  <span\r\n                    key={idx}\r\n                    className={cn(\r\n                      \"rounded px-2 py-1 text-sm\",\r\n                      d.type === \"equal\" && \"bg-gray-100\",\r\n                      d.type === \"add\" && \"bg-green-100 text-green-800\",\r\n                      d.type === \"del\" && \"bg-red-100 text-red-800 line-through\"\r\n                    )}\r\n                  >\r\n                    {d.text}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState, useMemo, useEffect } from \"react\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport { CheckCircle, XCircle } from \"lucide-react\"\r\n\r\nexport interface DialogueLine {\r\n  who: \"A\" | \"B\" | string // Support both generic A/B and specific speaker names\r\n  text: string\r\n}\r\n\r\nexport interface DialogueChoice {\r\n  id: string\r\n  text: string\r\n}\r\n\r\n// Default questions for dialogue completion\r\nconst defaultDialogueQuestions = [\r\n  \"As the speaker, whatâ€™s your next line?\",\r\n  \"What is the appropriate next line in the dialogue?\",\r\n  \"Choose the best continuation of the conversation.\",\r\n  \"Which response completes the dialogue correctly?\",\r\n  \"Select the sentence that best continues the dialogue.\",\r\n  \"What should be said next in this conversation?\",\r\n  \"Pick the correct line to complete the dialogue.\",\r\n  \"Which option fits naturally as the next line?\",\r\n  \"Identify the correct response to continue the conversation.\",\r\n  \"Complete the dialogue by choosing the best line.\"\r\n]\r\n\r\ninterface DialogueCompletionProps {\r\n  context: DialogueLine[]\r\n  choices: DialogueChoice[]\r\n  correctChoiceId: string\r\n  explanation?: string\r\n  showCorrectAnswer?: boolean\r\n  lockAfterSubmit?: boolean\r\n  onComplete?: (isCorrect: boolean, selectedChoice?: DialogueChoice) => void\r\n  // Controlled mode for container-managed flow\r\n  controlled?: boolean\r\n  value?: string | null\r\n  onAnswerChange?: (choiceId: string | null) => void\r\n  disableInlineFeedback?: boolean\r\n  hideActions?: boolean\r\n  readOnly?: boolean\r\n}\r\n\r\nconst DialogueBubble: React.FC<{ \r\n  who: \"A\" | \"B\" | string; \r\n  text: string; \r\n  isFirstSpeaker: boolean \r\n}> = ({ who, text, isFirstSpeaker }) => {\r\n  // First speaker (like HÆ°Æ¡ng) appears on the left, second speaker (like Nam) on the right\r\n  const isLeftSide = isFirstSpeaker\r\n  \r\n  return (\r\n    <div className={cn(\"flex mb-3\", isLeftSide ? \"justify-start\" : \"justify-end\")}>\r\n      <div className={cn(\r\n        \"max-w-[85%] rounded-2xl px-4 py-3 text-sm relative\",\r\n        isLeftSide ? \"bg-gray-100 text-gray-800\" : \"bg-primary text-white\"\r\n      )}>\r\n        <div className=\"text-xs opacity-70 mb-1 font-medium\">{who}</div>\r\n        <div>{text}</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function DialogueCompletion({\r\n  context,\r\n  choices,\r\n  correctChoiceId,\r\n  explanation,\r\n  showCorrectAnswer = true,\r\n  lockAfterSubmit = false,\r\n  onComplete,\r\n  controlled = false,\r\n  value = null,\r\n  onAnswerChange,\r\n  disableInlineFeedback = false,\r\n  hideActions = false,\r\n  readOnly = false,\r\n}: DialogueCompletionProps) {\r\n  const [selectedChoiceId, setSelectedChoiceId] = useState<string | null>(null)\r\n  const [submitted, setSubmitted] = useState<boolean>(false)\r\n  const [feedback, setFeedback] = useState<{\r\n    visible: boolean\r\n    isCorrect: boolean\r\n    message: string\r\n  }>({ visible: false, isCorrect: false, message: \"\" })\r\n\r\n  const isSelectionLocked = controlled ? !!readOnly : submitted && lockAfterSubmit\r\n\r\n  // Sync external value when controlled\r\n  useEffect(() => {\r\n    if (controlled) {\r\n      setSelectedChoiceId(value ?? null)\r\n    }\r\n  }, [controlled, value])\r\n\r\n  // Generate random question based on context\r\n  const questionText = useMemo(() => {\r\n    // Ensure context is an array before calling map\r\n    const contextArray = Array.isArray(context) ? context : []\r\n    const seed = contextArray.map(line => line.text).join('') || 'dialogue'\r\n    const hash = seed.split('').reduce((a, b) => {\r\n      a = ((a << 5) - a) + b.charCodeAt(0)\r\n      return a & a\r\n    }, 0)\r\n    const index = Math.abs(hash) % defaultDialogueQuestions.length\r\n    return defaultDialogueQuestions[index]\r\n  }, [context])\r\n\r\n  const correctAnswerText = useMemo(\r\n    () => choices.find((choice) => choice.id === correctChoiceId)?.text,\r\n    [choices, correctChoiceId],\r\n  )\r\n\r\n  // Determine the first and second speakers based on the context\r\n  const speakers = useMemo(() => {\r\n    const uniqueSpeakers = Array.from(new Set(context.map(line => line.who)))\r\n    return {\r\n      firstSpeaker: uniqueSpeakers[0] || \"A\",\r\n      secondSpeaker: uniqueSpeakers[1] || \"B\"\r\n    }\r\n  }, [context])\r\n\r\n  const handleChoiceSelect = (choiceId: string) => {\r\n    if (isSelectionLocked) return\r\n    if (controlled) {\r\n      onAnswerChange?.(choiceId)\r\n    } else {\r\n      setSelectedChoiceId(choiceId)\r\n      setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n    }\r\n  }\r\n\r\n  const handleCheck = () => {\r\n    if (!selectedChoiceId) return\r\n\r\n    const isCorrect = selectedChoiceId === correctChoiceId\r\n    const selectedChoice = choices.find((choice) => choice.id === selectedChoiceId)\r\n\r\n    if (!controlled) {\r\n      setFeedback({\r\n        visible: true,\r\n        isCorrect,\r\n        message: isCorrect ? \"Great response!\" : \"Not quite right. Try again!\",\r\n      })\r\n      setSubmitted(true)\r\n      if (onComplete && selectedChoice) {\r\n        onComplete(isCorrect, selectedChoice)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleReset = () => {\r\n    setSelectedChoiceId(null)\r\n    setSubmitted(false)\r\n    setFeedback({ visible: false, isCorrect: false, message: \"\" })\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full max-w-6xl mx-auto space-y-6\">\r\n      <div className=\"text-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">{questionText}</h2>\r\n        <p className=\"text-gray-600\">Complete the dialogue by choosing the best response.</p>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Left side - Dialogue */}\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"text-sm text-gray-600 mb-4 font-medium\">Dialogue</div>\r\n            <div className=\"space-y-3\">\r\n              {Array.isArray(context) ? context.map((line, idx) => (\r\n                <DialogueBubble \r\n                  key={idx} \r\n                  who={line.who} \r\n                  text={line.text} \r\n                  isFirstSpeaker={line.who === speakers.firstSpeaker}\r\n                />\r\n              )) : (\r\n                <div className=\"text-sm text-gray-500 italic\">No dialogue context available</div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Right side - Choices */}\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"text-sm text-gray-600 mb-4 font-medium\">Choose a response</div>\r\n            <div className=\"space-y-3\">\r\n              {choices.map((choice) => (\r\n                <Button\r\n                  key={choice.id}\r\n                  variant=\"outline\"\r\n                  className={cn(\r\n                    \"w-full justify-start text-left h-auto py-3 px-4\",\r\n                    selectedChoiceId === choice.id && \"border-primary bg-primary/5\",\r\n                    submitted &&\r\n                      selectedChoiceId === choice.id &&\r\n                      (feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\"),\r\n                  )}\r\n                  onClick={() => handleChoiceSelect(choice.id)}\r\n                  disabled={isSelectionLocked}\r\n                >\r\n                  {choice.text}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {!hideActions && (\r\n        <div className=\"flex justify-center gap-3\">\r\n          <Button variant=\"outline\" onClick={handleReset}>\r\n            Reset\r\n          </Button>\r\n          {!controlled && (\r\n            <Button onClick={handleCheck} disabled={!selectedChoiceId || submitted}>\r\n              Check Answer\r\n            </Button>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {!controlled && !disableInlineFeedback && feedback.visible && (\r\n        <Alert className={cn(\"mb-6\", feedback.isCorrect ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\")}>\r\n          <div className=\"flex items-center\">\r\n            {feedback.isCorrect ? (\r\n              <CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n            ) : (\r\n              <XCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            )}\r\n            <AlertDescription>{feedback.message}</AlertDescription>\r\n          </div>\r\n        </Alert>\r\n      )}\r\n\r\n      {!controlled && submitted && (explanation || (showCorrectAnswer && !feedback.isCorrect)) && (\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            {explanation && (\r\n              <div className=\"mb-3\">\r\n                <div className=\"text-sm text-gray-600 mb-1\">Explanation:</div>\r\n                <div className=\"text-gray-800\">{explanation}</div>\r\n              </div>\r\n            )}\r\n            {showCorrectAnswer && !feedback.isCorrect && (\r\n              <div className=\"mt-1\">\r\n                <div className=\"text-sm text-gray-600 mb-1\">Correct answer:</div>\r\n                <div className=\"font-medium text-green-700\">\r\n                  {correctAnswerText}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\nimport { Progress } from \"@/shared/components/ui/progress\"\r\nimport { cn } from \"@/shared/utils/cn\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport { CheckCircle, XCircle } from \"lucide-react\"\r\n\r\nexport interface RoleplayChoice {\r\n  text: string\r\n}\r\n\r\nexport interface RoleplayStep {\r\n  bot: string\r\n  choices: RoleplayChoice[]\r\n  expected: number\r\n  tips?: string\r\n}\r\n\r\ninterface RolePlayProps {\r\n  title: string // This now contains the context from question_data\r\n  steps: RoleplayStep[]\r\n  onComplete?: (isCorrect: boolean, score?: number, selectedIndexes?: number[]) => void\r\n}\r\n\r\nconst DialogueBubble: React.FC<{ who: \"A\" | \"B\"; text: string; isCorrect?: boolean }> = ({ who, text, isCorrect }) => {\r\n  const isA = who === \"A\"\r\n  return (\r\n    <div className={cn(\"flex mb-3\", isA ? \"justify-start\" : \"justify-end\")}>\r\n      <div className={cn(\r\n        \"max-w-[80%] rounded-2xl px-4 py-3 text-sm relative\",\r\n        isA ? \"bg-gray-100 text-gray-800\" : isCorrect === true ? \"bg-green-100 text-green-800\" : isCorrect === false ? \"bg-red-100 text-red-800\" : \"bg-primary text-white\"\r\n      )}>\r\n        <div className=\"text-xs opacity-70 mb-1 font-medium\">{who}</div>\r\n        <div>{text}</div>\r\n        {isCorrect !== undefined && (\r\n          <div className=\"absolute -bottom-2 right-2 text-xs\">\r\n            {isCorrect ? \"âœ…\" : \"âŒ\"}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function RolePlay({\r\n  title,\r\n  steps,\r\n  onComplete,\r\n}: RolePlayProps) {\r\n  const [currentStep, setCurrentStep] = useState<number>(0)\r\n  const [selectedChoice, setSelectedChoice] = useState<number | null>(null)\r\n  const [history, setHistory] = useState<Array<{ bot: string; user: string; correct: boolean; index: number }>>([])\r\n  const [submitted, setSubmitted] = useState<boolean>(false)\r\n\r\n  const current = steps[currentStep]\r\n  const isLastStep = currentStep === steps.length - 1\r\n\r\n  const handleChoiceSelect = (choiceIndex: number) => {\r\n    if (submitted) return\r\n    setSelectedChoice(choiceIndex)\r\n  }\r\n\r\n  const handleNext = () => {\r\n    if (selectedChoice === null || submitted) return\r\n\r\n    const correct = selectedChoice === current.expected\r\n    const userText = current.choices[selectedChoice].text\r\n  const entry = { bot: current.bot, user: userText, correct, index: selectedChoice }\r\n\r\n    const newHistory = [...history, entry]\r\n    setHistory(newHistory)\r\n    setSubmitted(true)\r\n\r\n    // Auto-advance after a short delay\r\n    setTimeout(() => {\r\n      if (isLastStep) {\r\n        // Complete the role-play and call onComplete\r\n        const totalCorrect = newHistory.filter((h) => h.correct).length\r\n        const score = totalCorrect / steps.length\r\n        const isPerfect = score === 1\r\n\r\n        if (onComplete) {\r\n          const selectedIndexes = newHistory.map(h => h.index)\r\n          onComplete(isPerfect, score, selectedIndexes)\r\n        }\r\n      } else {\r\n        setCurrentStep(currentStep + 1)\r\n        setSelectedChoice(null)\r\n        setSubmitted(false)\r\n      }\r\n    }, 1500)\r\n  }\r\n\r\n  const totalCorrect = history.filter((h) => h.correct).length\r\n  const totalSteps = steps.length\r\n  const currentScore = totalCorrect / totalSteps\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto space-y-6\">\r\n      <div className=\"text-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Interactive Role-play</h2>\r\n        <p className=\"text-gray-600 mb-2\">{title}</p>\r\n        <div className=\"text-sm text-gray-500 mb-4\">\r\n          Step {currentStep + 1} of {totalSteps}\r\n        </div>\r\n        <Progress value={(currentStep + 1) / totalSteps * 100} className=\"w-full max-w-md mx-auto\" />\r\n      </div>\r\n\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"space-y-4\">\r\n            {/* History */}\r\n            {history.map((entry, idx) => (\r\n              <div key={idx} className=\"space-y-2\">\r\n                <DialogueBubble who=\"A\" text={entry.bot} />\r\n                <DialogueBubble who=\"B\" text={entry.user} isCorrect={entry.correct} />\r\n              </div>\r\n            ))}\r\n\r\n            {/* Current step */}\r\n            <div className=\"space-y-4\">\r\n              <DialogueBubble who=\"A\" text={current.bot} />\r\n\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"text-sm text-gray-600\">Choose your response:</div>\r\n                  {current.choices.map((choice, idx) => (\r\n                    <Button\r\n                      key={idx}\r\n                      variant=\"outline\"\r\n                      className={cn(\r\n                        \"w-full justify-start text-left h-auto py-3 px-4\",\r\n                        selectedChoice === idx && \"border-primary bg-primary/5\",\r\n                        submitted &&\r\n                          selectedChoice === idx &&\r\n                          (idx === current.expected ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\"),\r\n                      )}\r\n                      onClick={() => handleChoiceSelect(idx)}\r\n                      disabled={submitted}\r\n                    >\r\n                      {choice.text}\r\n                    </Button>\r\n                  ))}\r\n                </div>\r\n\r\n                {current.tips && (\r\n                  <div className=\"text-sm text-blue-600 bg-blue-50 p-3 rounded-md\">\r\n                    ðŸ’¡ Tip: {current.tips}\r\n                  </div>\r\n                )}\r\n\r\n                {submitted && (\r\n                  <Alert className={cn(\r\n                    selectedChoice === current.expected ? \"bg-green-50 border-green-200\" : \"bg-red-50 border-red-200\"\r\n                  )}>\r\n                    <div className=\"flex items-center\">\r\n                      {selectedChoice === current.expected ? (\r\n                        <CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n                      ) : (\r\n                        <XCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n                      )}\r\n                      <AlertDescription>\r\n                        {selectedChoice === current.expected ? \"Great response!\" : \"Not the best choice. The recommended response was shown above.\"}\r\n                      </AlertDescription>\r\n                    </div>\r\n                  </Alert>\r\n                )}\r\n              </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"flex justify-center\">\r\n        <Button onClick={handleNext} disabled={selectedChoice === null || submitted}>\r\n          {submitted ? \"Next\" : \"Say this\"}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { Suspense, useCallback, useEffect, useMemo, useState } from \"react\"\r\nimport { useRouter, useSearchParams, type ReadonlyURLSearchParams } from \"next/navigation\"\r\nimport { Button } from \"@/shared/components/ui/button\"\r\nimport { Card, CardContent } from \"@/shared/components/ui/card\"\r\nimport { Progress } from \"@/shared/components/ui/progress\"\r\nimport { Alert, AlertDescription } from \"@/shared/components/ui/alert\"\r\nimport { useExercise, ExerciseProvider } from \"@/features/learn/contexts/ExerciseContext\"\r\nimport type {\r\n  Exercise,\r\n  MultipleChoiceQuestion,\r\n  ChooseWordsQuestion,\r\n  ErrorCorrectionQuestion,\r\n  SynonymMatchingQuestion,\r\n  WordMatchingQuestion,\r\n  DialogueCompletionQuestion,\r\n  RolePlayQuestion,\r\n} from \"@/features/learn/types/practice\"\r\n\r\nimport { MultipleChoiceQuestion as MCQ } from \"./MCQ/multiple-choice-question\"\r\nimport { ChooseWords } from \"./ChooseWords/choose-words\"\r\nimport { SynonymsMatching } from \"./SynonymsMatching/synonyms-matching\"\r\nimport { WordsMatching } from \"./WordsMatching/words-matching\"\r\nimport { ErrorCorrection } from \"./writing/ErrorCorrection\"\r\nimport { DialogueCompletion } from \"./dialogue/DialogueCompletion\"\r\nimport { RolePlay } from \"./dialogue/RolePlay\"\r\nimport { useSidebar } from \"@/shared/components/ui/sidebar\"\r\nimport { calculateAccuracy, isExercisePassed } from \"@/features/learn/utils/exercise-utils\"\r\n\r\n// Stub implementation - returns null since we don't have lesson navigation data yet\r\n// This will cause the \"Next Lesson\" button to navigate back to the topic page\r\nconst getLessonBySlug = (topicSlug: string, lessonSlug: string) => {\r\n  // TODO: Implement actual lesson fetching logic to get next lesson in sequence\r\n  // For now, return null to prevent errors\r\n  return null\r\n}\r\n\r\ntype ContainerProps = {\r\n  exercise: Exercise\r\n  topicSlug: string\r\n  lessonSlug: string\r\n}\r\n\r\n// Helpers to parse and clamp `q`\r\nfunction parseQ(searchParams: ReadonlyURLSearchParams, total: number): number {\r\n  const raw = searchParams.get(\"q\")\r\n  const idx = Math.max(1, Math.min(total, raw ? parseInt(raw, 10) || 1 : 1))\r\n  return idx\r\n}\r\n\r\nfunction useUrlIndex(total: number) {\r\n  const router = useRouter()\r\n  const searchParams = useSearchParams()\r\n  const q = parseQ(searchParams, total)\r\n  const setIndex = useCallback(\r\n    (nextIdx: number) => {\r\n      const sp = new URLSearchParams(searchParams.toString())\r\n      sp.set(\"q\", String(Math.max(1, Math.min(total, nextIdx + 1))))\r\n      router.replace(`?${sp.toString()}`)\r\n    },\r\n    [router, searchParams, total]\r\n  )\r\n  return { urlIndex: q - 1, setIndex }\r\n}\r\n\r\nfunction Toolbar() {\r\n  const { nextQuestion, isAnswered, skipQuestion } = useExercise()\r\n\r\n  return (\r\n    <div className=\"sticky bottom-0 left-0 right-0 z-10 mt-8 border-t bg-background/90 backdrop-blur supports-[backdrop-filter]:bg-background/70\">\r\n      <div className=\"mx-auto max-w-4xl px-4 py-3 flex items-center justify-end gap-3\">\r\n        <SubmitButton />\r\n        <Button variant=\"outline\" onClick={skipQuestion} disabled={isAnswered}>\r\n          Skip\r\n        </Button>\r\n        <Button onClick={nextQuestion} disabled={!isAnswered}>\r\n          Next\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// New enhanced stage component with completion actions and layout tweaks\r\nfunction ExerciseStageEx({ topicSlug, lessonSlug }: { topicSlug: string; lessonSlug: string }) {\r\n  const { exercise, progress, resetExercise, gradeResult, currentQuestion, isAnswered } = useExercise()\r\n  const router = useRouter()\r\n\r\n  if (!exercise) return null\r\n\r\n  const totalQuestions = exercise.questions.length\r\n  const answeredCount = progress.correctAnswers + progress.incorrectAnswers\r\n\r\n  if (progress.completed) {\r\n    const total = exercise.questions.length\r\n    const correct = progress.correctAnswers\r\n    const accuracy = calculateAccuracy(progress)\r\n    const passed = isExercisePassed(accuracy, undefined, exercise.zoneLevel)\r\n    // Compute next lesson slug within the same topic (demo)\r\n    const info = getLessonBySlug(topicSlug, lessonSlug)\r\n    const nextLessonSlug = (() => {\r\n      if (!info) return undefined\r\n      const idx = info.chapter.lessons.findIndex(l => l.slug === info.lesson.slug)\r\n      const next = info.chapter.lessons[idx + 1]\r\n      return next?.slug\r\n    })()\r\n    return (\r\n      <Card className=\"mx-auto max-w-3xl\">\r\n        <CardContent className=\"p-8 text-center space-y-4\">\r\n          <div className=\"text-3xl font-semibold\">Exercise Complete</div>\r\n          <div className=\"text-muted-foreground\">Nice work staying focused.</div>\r\n          <div className=\"mt-2 flex items-center justify-center gap-6\">\r\n            <div className=\"rounded-lg border px-6 py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Score</div>\r\n              <div className=\"text-2xl font-bold\">{correct}/{total}</div>\r\n            </div>\r\n            <div className=\"rounded-lg border px-6 py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Accuracy</div>\r\n              <div className=\"text-2xl font-bold\">{accuracy}%</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6 flex flex-col sm:flex-row items-center justify-center gap-3\">\r\n            <Button variant=\"outline\" onClick={() => resetExercise()}>Retry</Button>\r\n            <Button\r\n              variant=\"secondary\"\r\n              className=\"w-full sm:w-auto\"\r\n              onClick={() => router.replace(`/learn/${topicSlug}/${lessonSlug}`)}\r\n            >\r\n              Back to Lesson\r\n            </Button>\r\n            {passed && (\r\n              <Button\r\n                className=\"w-full sm:w-auto\"\r\n                onClick={() => {\r\n                  if (nextLessonSlug) {\r\n                    router.replace(`/learn/${topicSlug}/${nextLessonSlug}`)\r\n                  } else {\r\n                    router.replace(`/learn/${topicSlug}`)\r\n                  }\r\n                }}\r\n              >\r\n                Next Lesson\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  const renderCorrectAnswer = () => {\r\n    if (!currentQuestion) return null\r\n    switch (currentQuestion.type) {\r\n      case \"multiple-choice\": {\r\n        const q = currentQuestion as MultipleChoiceQuestion\r\n        return q.choices.find(c => c.id === q.correctChoiceId)?.text\r\n      }\r\n      case \"choose-words\": {\r\n        const q = currentQuestion as ChooseWordsQuestion\r\n        const qd = (q as any).question_data\r\n        if (qd && qd.data) {\r\n          if (qd.subtype === \"fill_in_blanks\") {\r\n            return (qd.data?.blanks?.correct || []).join(\" \")\r\n          }\r\n          return qd.data?.canonical_sentence || (qd.data?.tokens || []).join(\" \")\r\n        }\r\n        // Legacy fallback\r\n        return (q as any).correctAnswer?.join(\" \")\r\n      }\r\n      case \"error-correction\": {\r\n        const q = currentQuestion as ErrorCorrectionQuestion\r\n        return q.target\r\n      }\r\n      case \"dialogue-completion\": {\r\n        const q = currentQuestion as DialogueCompletionQuestion\r\n        return q.choices.find(c => c.id === q.correctChoiceId)?.text\r\n      }\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"mx-auto max-w-4xl px-4 pb-24\">\r\n      <div className=\"mb-6\">\r\n        <Progress value={(answeredCount / totalQuestions) * 100} />\r\n        <div className=\"mt-2 text-sm text-right text-muted-foreground\">\r\n          {answeredCount}/{totalQuestions}\r\n        </div>\r\n      </div>\r\n\r\n      {isAnswered && gradeResult && (\r\n        <Alert variant={gradeResult.isCorrect ? \"default\" : \"destructive\"} className=\"mb-6\">\r\n          <AlertDescription>\r\n            {gradeResult.feedback}\r\n            {!gradeResult.isCorrect && renderCorrectAnswer() && (\r\n              <div className=\"mt-2 text-sm\">Correct answer: {renderCorrectAnswer()}</div>\r\n            )}\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <QuestionRenderer />\r\n      <Toolbar />\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SubmitButton() {\r\n  const { submitAnswer, isAnswered, userAnswer, currentQuestion } = useExercise()\r\n\r\n  const canSubmit = useMemo(() => {\r\n    if (!currentQuestion) return false\r\n    if (isAnswered) return false\r\n    switch (currentQuestion.type) {\r\n  case \"multiple-choice\":\r\n        return typeof userAnswer === \"string\" && !!userAnswer\r\n      case \"choose-words\":\r\n        return Array.isArray(userAnswer) && userAnswer.length > 0\r\n      case \"error-correction\":\r\n      case \"dialogue-completion\":\r\n        return typeof userAnswer === \"string\" && userAnswer.trim().length > 0\r\n      case \"synonyms-matching\":\r\n      case \"word-matching\":\r\n        return Array.isArray(userAnswer) && userAnswer.length > 0\r\n      case \"role-play\":\r\n        return Array.isArray(userAnswer) && userAnswer.length > 0\r\n      default:\r\n        return false\r\n    }\r\n  }, [currentQuestion, isAnswered, userAnswer])\r\n\r\n  return (\r\n    <Button onClick={submitAnswer} disabled={!canSubmit}>\r\n      Submit\r\n    </Button>\r\n  )\r\n}\r\n\r\nfunction QuestionRenderer() {\r\n  const { currentQuestion, userAnswer, setUserAnswer, isAnswered, submitAnswer } = useExercise()\r\n  const [, setMatchReady] = useState(false)\r\n\r\n  const handleMatchingAnswerChange = useCallback(\r\n    (ids: number[], length: number) => {\r\n      setUserAnswer(ids)\r\n      setMatchReady(ids.length === length)\r\n    },\r\n    [setUserAnswer, setMatchReady],\r\n  )\r\n\r\n  const handleChooseWordsAnswerChange = useCallback(\r\n    (answer: string[]) => {\r\n      setUserAnswer(answer)\r\n    },\r\n    [setUserAnswer],\r\n  )\r\n\r\n  if (!currentQuestion) return null\r\n\r\n  const commonControlled = {\r\n    controlled: true,\r\n    hideActions: true,\r\n    disableInlineFeedback: true,\r\n  }\r\n\r\n  switch (currentQuestion.type) {\r\n    case \"multiple-choice\": {\r\n      const q = currentQuestion as MultipleChoiceQuestion\r\n      console.log('[QuestionRenderer] MCQ question image:', q.questionImage)\r\n      return (\r\n        <MCQ\r\n          {...commonControlled}\r\n          readOnly={isAnswered}\r\n          type={q.questionType as any}\r\n          questionText={q.questionText}\r\n          passage={q.passage}\r\n          questionImage={q.questionImage}\r\n          targetWord={q.targetWord}\r\n          choices={q.choices}\r\n          correctChoiceId={q.correctChoiceId}\r\n          explanation={\"\"}\r\n          value={(userAnswer as string) ?? null}\r\n          onAnswerChange={(v) => setUserAnswer(v)}\r\n        />\r\n      )\r\n    }\r\n\r\n    case \"role-play\": {\r\n      const q = currentQuestion as RolePlayQuestion\r\n      return (\r\n        <RolePlay\r\n          title={q.title}\r\n          steps={q.steps}\r\n          onComplete={(_isPerfect, _score, selectedIndexes) => {\r\n            // Save the per-step selected choice indexes so gradeQuestion can compute score\r\n            if (Array.isArray(selectedIndexes)) {\r\n              setUserAnswer(selectedIndexes)\r\n            }\r\n            // Don't auto-submit, let user manually submit to see results\r\n          }}\r\n        />\r\n      )\r\n    }\r\n\r\n\r\n    case \"choose-words\": {\r\n      const q = currentQuestion as ChooseWordsQuestion\r\n      const qd = q.question_data\r\n      console.log('[QuestionRenderer] ChooseWords question audioUrl:', q.audioUrl)\r\n\r\n      // Map unified question_data to ChooseWords props\r\n      const shuffle = (arr: string[]): string[] => {\r\n        const a = [...arr]\r\n        for (let i = a.length - 1; i > 0; i--) {\r\n          const j = Math.floor(Math.random() * (i + 1))\r\n          ;[a[i], a[j]] = [a[j], a[i]]\r\n        }\r\n        return a\r\n      }\r\n\r\n      let questionText = \"\"\r\n      let sentenceText = \"\"\r\n      let words: string[] = []\r\n      let correctAnswer: string[] = []\r\n      let subtype: any = qd?.subtype\r\n      let highlighted: string[] | undefined = qd?.ui?.highlight_tokens\r\n\r\n      if (qd && qd.data) {\r\n        if (qd.subtype === \"translation\") {\r\n          questionText = \"Dá»‹ch sang tiáº¿ng Viá»‡t\"\r\n          sentenceText = qd.data.source_sentence || \"\"\r\n          // Shuffle tokens for user to arrange\r\n          words = shuffle(qd.data.tokens || [])\r\n          correctAnswer = qd.data.tokens || []\r\n        } else if (qd.subtype === \"fill_in_blanks\") {\r\n          questionText = \"Äiá»n vÃ o chá»— trá»‘ng\"\r\n          const tokens: string[] = qd.data.canonical_sentence?.split(\" \") || []\r\n          const blanks = qd.data.blanks\r\n          const blankIndices = blanks?.indices || []\r\n          sentenceText = tokens\r\n            .map((t: string, i: number) => (blankIndices.includes(i) ? \"___\" : t))\r\n            .join(\" \")\r\n          const bank = [\r\n            ...(blanks?.correct || []),\r\n            ...(blanks?.word_bank || []),\r\n          ]\r\n          // de-duplicate while preserving order\r\n          const seen = new Set<string>()\r\n          words = bank.filter(w => (seen.has(w) ? false : (seen.add(w), true)))\r\n          correctAnswer = blanks?.correct || []\r\n        } else if (qd.subtype === \"sentence_scramble\") {\r\n          // Use random title from ChooseWords component\r\n          questionText = \"Can you make the correct sentence?\" // Will be overridden by randomTitle in ChooseWords\r\n          sentenceText = \"\"\r\n          // Shuffle tokens for user to arrange - this ensures random order different from database\r\n          words = shuffle(qd.data.tokens || [])\r\n          correctAnswer = qd.data.tokens || []\r\n        } else {\r\n          // Legacy fallback\r\n          questionText = \"Sáº¯p xáº¿p thÃ nh cÃ¢u Ä‘Ãºng\"\r\n          sentenceText = \"\"\r\n          words = qd.data.tokens || []\r\n          correctAnswer = qd.data.tokens || []\r\n        }\r\n      } else {\r\n        // Legacy fallback\r\n        questionText = (q as any).question\r\n        sentenceText = (q as any).sentence\r\n        words = (q as any).words\r\n        correctAnswer = (q as any).correctAnswer\r\n        subtype = (q as any).exerciseType\r\n        highlighted = (q as any).highlightedWords\r\n      }\r\n\r\n      return (\r\n        <ChooseWords\r\n          {...commonControlled}\r\n          readOnly={isAnswered}\r\n          question={questionText}\r\n          sentence={sentenceText}\r\n          words={words}\r\n          type={subtype}\r\n          highlightedWords={highlighted}\r\n          audioUrl={q.audioUrl}\r\n          characterImageUrl={(q as any).characterImageUrl}\r\n          value={(userAnswer as string[]) ?? null}\r\n          onAnswerChange={handleChooseWordsAnswerChange}\r\n        />\r\n      )\r\n    }\r\n\r\n    case \"error-correction\": {\r\n      const q = currentQuestion as ErrorCorrectionQuestion\r\n      return (\r\n        <ErrorCorrection\r\n          {...commonControlled}\r\n          readOnly={isAnswered}\r\n          question={q.question}\r\n          faultySentence={q.faultySentence}\r\n          target={q.target}\r\n          hint={q.hint}\r\n          value={(userAnswer as string) ?? \"\"}\r\n          onAnswerChange={(ans) => setUserAnswer(ans)}\r\n        />\r\n      )\r\n    }\r\n\r\n    case \"dialogue-completion\": {\r\n      const q = currentQuestion as DialogueCompletionQuestion\r\n      return (\r\n        <DialogueCompletion\r\n          {...commonControlled}\r\n          readOnly={isAnswered}\r\n          context={q.context}\r\n          choices={q.choices}\r\n          correctChoiceId={q.correctChoiceId}\r\n          explanation={q.explanation}\r\n          value={(userAnswer as string) ?? null}\r\n          onAnswerChange={(ans) => setUserAnswer(ans ?? null)}\r\n        />\r\n      )\r\n    }\r\n\r\n    case \"synonyms-matching\": {\r\n      const q = currentQuestion as SynonymMatchingQuestion\r\n      return (\r\n        <SynonymsMatching\r\n          controlled\r\n          readOnly={isAnswered}\r\n          pairs={q.pairs as any}\r\n          onAnswerChange={(ids) => handleMatchingAnswerChange(ids, q.pairs.length)}\r\n        />\r\n      )\r\n    }\r\n\r\n    case \"word-matching\": {\r\n      const q = currentQuestion as WordMatchingQuestion\r\n      return (\r\n        <WordsMatching\r\n          controlled\r\n          readOnly={isAnswered}\r\n          pairs={q.pairs as any}\r\n          onAnswerChange={(ids) => handleMatchingAnswerChange(ids, q.pairs.length)}\r\n        />\r\n      )\r\n    }\r\n\r\n    default:\r\n      return <div>Unsupported question type: {(currentQuestion as any).type}</div>\r\n  }\r\n}\r\n\r\nfunction ExerciseStage() {\r\n  const { exercise, progress } = useExercise()\r\n\r\n  if (!exercise) return null\r\n\r\n  if (progress.completed) {\r\n    const total = exercise.questions.length\r\n    const correct = progress.correctAnswers\r\n    const accuracy = total ? Math.round((correct / total) * 100) : 0\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-6 text-center space-y-2\">\r\n          <div className=\"text-2xl font-semibold\">Exercise Complete</div>\r\n          <div>\r\n            Score: {correct}/{total} â€¢ Accuracy {accuracy}%\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <QuestionRenderer />\r\n      <Toolbar />\r\n    </>\r\n  )\r\n}\r\n\r\nexport function ExerciseContainer({ exercise, topicSlug, lessonSlug }: ContainerProps) {\r\n  const { urlIndex, setIndex } = useUrlIndex(exercise.questions.length)\r\n  const { setOpen, setOpenMobile } = useSidebar()\r\n  useEffect(() => {\r\n    try {\r\n      setOpen(false)\r\n      setOpenMobile(false)\r\n    } catch {}\r\n  }, [setOpen, setOpenMobile])\r\n\r\n  return (\r\n    <ExerciseProvider\r\n      exerciseData={exercise}\r\n      topicSlug={topicSlug}\r\n      lessonSlug={lessonSlug}\r\n      urlQuestionIndex={urlIndex}\r\n      onQuestionChange={setIndex}\r\n    >\r\n      <ExerciseStageEx topicSlug={topicSlug} lessonSlug={lessonSlug} />\r\n    </ExerciseProvider>\r\n  )\r\n}\r\n\r\n// SSR page wrapper helper\r\nexport function ExerciseContainerShell(props: ContainerProps) {\r\n  return (\r\n    <Suspense>\r\n      <ExerciseContainer {...props} />\r\n    </Suspense>\r\n  )\r\n}\r\n\r\n\r\n\r\n"],"names":[],"mappings":"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"}